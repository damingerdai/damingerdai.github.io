<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åœ¨ Spring WebFlux ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°</title>
      <link href="/2025/09/08/back-end/upload-file-into-local-in-spring-webflux/"/>
      <url>/2025/09/08/back-end/upload-file-into-local-in-spring-webflux/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨-Spring-WebFlux-ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°"><a href="#åœ¨-Spring-WebFlux-ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°" class="headerlink" title="åœ¨ Spring WebFlux ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°"></a>åœ¨ Spring WebFlux ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°</h1><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æœ¬æ–‡æ—¨åœ¨ä»‹ç»å¦‚ä½•åœ¨ Spring WebFlux æ¡†æ¶ä¸‹ï¼Œå®ç°å°†æ–‡ä»¶ä¸Šä¼ è‡³æœ¬åœ°æœåŠ¡å™¨çš„åŠŸèƒ½ã€‚è™½ç„¶ç›®å‰çš„ä»£ç ç¤ºä¾‹ä¾§é‡äºæœ¬åœ°å­˜å‚¨ï¼Œä½†å…¶è®¾è®¡æ€è·¯ä¹Ÿä¸ºæœªæ¥æ‰©å±•è‡³å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆå¦‚ MinIOï¼‰å¥ å®šäº†åŸºç¡€ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæ‚¨å°†æŒæ¡åœ¨å“åº”å¼ç¼–ç¨‹æ¨¡å‹ä¸‹å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„å…³é”®æŠ€æœ¯ã€‚</p><hr><h2 id="å…·ä½“å®ç°è¿‡ç¨‹"><a href="#å…·ä½“å®ç°è¿‡ç¨‹" class="headerlink" title="å…·ä½“å®ç°è¿‡ç¨‹"></a>å…·ä½“å®ç°è¿‡ç¨‹</h2><h2 id="1-é¡¹ç›®æ­å»ºä¸ä¾èµ–å¼•å…¥"><a href="#1-é¡¹ç›®æ­å»ºä¸ä¾èµ–å¼•å…¥" class="headerlink" title="1. é¡¹ç›®æ­å»ºä¸ä¾èµ–å¼•å…¥"></a>1. é¡¹ç›®æ­å»ºä¸ä¾èµ–å¼•å…¥</h2><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦ä¸€ä¸ªåŸºäº Spring Boot 3.5.0 çš„é¡¹ç›®ã€‚å¦‚æœæ‚¨ä½¿ç”¨ Gradle ä½œä¸ºæ„å»ºå·¥å…·ï¼Œå¯ä»¥åœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="comment">// ... å…¶ä»– Spring Boot ä¾èµ–</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-webflux&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;io.projectreactor:reactor-core&#x27;</span></span><br><span class="line">    <span class="comment">// Swagger UI ä¾èµ–</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springdoc:springdoc-openapi-starter-webfluxui:2.5.0&#x27;</span> <span class="comment">// è¯·æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>spring-boot-starter-webflux</code> æä¾›äº†æ„å»ºå“åº”å¼ Web åº”ç”¨æ‰€éœ€çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œè€Œ <code>reactor-core</code> åˆ™æ˜¯ Project Reactor çš„æ ¸å¿ƒåº“ï¼Œä¸ºå“åº”å¼ç¼–ç¨‹æä¾›æ”¯æŒã€‚<code>springdoc-openapi-starter-webfluxui</code> åˆ™æ˜¯é›†æˆ Swagger UI æ‰€éœ€çš„ä¾èµ–ã€‚</p><h2 id="2-ç¼–å†™-Controller"><a href="#2-ç¼–å†™-Controller" class="headerlink" title="2. ç¼–å†™ Controller"></a>2. ç¼–å†™ Controller</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç¼–å†™ <code>FileController</code> æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.core.io.buffer.DataBufferUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.codec.multipart.FilePart;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestPart;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.StandardOpenOption;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">uploadFile</span><span class="params">(<span class="meta">@RequestPart(&quot;file&quot;)</span> Mono&lt;FilePart&gt; filePartMono)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> filePartMono.flatMap(filePart -&gt; &#123;</span><br><span class="line">            <span class="comment">// è·å–ç”¨æˆ·ç›®å½•</span></span><br><span class="line">            <span class="type">var</span> <span class="variable">userDir</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">            <span class="comment">// æ„å»ºæ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œè¿™é‡Œå‡è®¾ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ nfs æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">            <span class="comment">// æ‚¨å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹è·¯å¾„</span></span><br><span class="line">            <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(userDir, <span class="string">&quot;nfs&quot;</span>, filePart.filename());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç¡®ä¿ nfs ç›®å½•å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                java.nio.file.Files.createDirectories(path.getParent());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">return</span> Mono.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Failed to create upload directory&quot;</span>, e));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä½¿ç”¨ transferTo å°†æ–‡ä»¶å†…å®¹å†™å…¥åˆ°æŒ‡å®šè·¯å¾„</span></span><br><span class="line">            <span class="comment">// transferTo æ–¹æ³•è¿”å›ä¸€ä¸ª Mono&lt;Void&gt;ï¼Œè¡¨ç¤ºæ“ä½œçš„å®Œæˆ</span></span><br><span class="line">            <span class="keyword">return</span> filePart.transferTo(path)</span><br><span class="line">                    <span class="comment">// then æ–¹æ³•ç”¨äºåœ¨å‰ä¸€ä¸ª Mono å®Œæˆåæ‰§è¡Œä¸‹ä¸€ä¸ªæ“ä½œ</span></span><br><span class="line">                    <span class="comment">// è¿™é‡Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªåŒ…å«æˆåŠŸæ¶ˆæ¯çš„ Mono&lt;String&gt;</span></span><br><span class="line">                    .then(Mono.just(<span class="string">&quot;File uploaded successfully: &quot;</span> + filePart.filename()));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹è§£æï¼š</strong></p><ul><li><strong><code>@RestController</code></strong>: è¿™æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç­‰åŒäº <code>@Controller</code> å’Œ <code>@ResponseBody</code>ï¼Œè¡¨æ˜æ­¤ç±»ä¸­çš„æ–¹æ³•å°†è¿”å›æ•°æ®è€Œä¸æ˜¯è§†å›¾åç§°ã€‚</li><li><strong><code>@PostMapping(&quot;/upload&quot;)</code></strong>: æŒ‡å®šè¯¥æ–¹æ³•å¤„ç† HTTP POST è¯·æ±‚åˆ° <code>/upload</code> è·¯å¾„ã€‚</li><li><strong><code>@RequestPart(&quot;file&quot;) Mono&lt;FilePart&gt; filePartMono</code></strong>:<ul><li><code>@RequestPart</code> æ³¨è§£ç”¨äºæ¥æ”¶ <code>multipart/form-data</code> è¯·æ±‚ä¸­çš„éƒ¨åˆ†ã€‚è¿™é‡Œçš„ <code>&quot;file&quot;</code> å¯¹åº” HTML form è¡¨å•ä¸­ <code>&lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</code> çš„ <code>name</code> å±æ€§ã€‚</li><li><code>Mono&lt;FilePart&gt;</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ã€æœ€å¤šåŒ…å«ä¸€ä¸ªå…ƒç´ çš„å‘å¸ƒè€…ï¼Œä»£è¡¨ä¸Šä¼ çš„æ–‡ä»¶ã€‚Spring WebFlux ä½¿ç”¨ Reactor åº“è¿›è¡Œå“åº”å¼ç¼–ç¨‹ï¼Œ<code>Mono</code> æ˜¯å…¶æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚</li></ul></li><li><strong><code>filePart.transferTo(path)</code></strong>:<ul><li>è¿™æ˜¯ Spring WebFlux æä¾›çš„ç”¨äºå°†ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ <strong>ç›´æ¥ä¼ è¾“</strong> åˆ°æŒ‡å®š <code>Path</code> çš„æ–¹æ³•ã€‚</li><li>å®ƒè¿”å›ä¸€ä¸ª <code>Mono&lt;Void&gt;</code>ï¼Œè¡¨ç¤ºæ–‡ä»¶ä¼ è¾“æ“ä½œçš„å®Œæˆï¼Œä½†ä¸ä¼šè¿”å›ä»»ä½•æ•°æ®ã€‚åœ¨å“åº”å¼æµä¸­ï¼Œ<code>Void</code> è¡¨ç¤ºä¸€ä¸ªæ“ä½œçš„å®Œæˆä¿¡å·ã€‚</li></ul></li><li><strong><code>.then(...)</code></strong>:<ul><li><code>then()</code> æ“ä½œç¬¦ç”¨äºåœ¨æº <code>Mono</code>ï¼ˆåœ¨è¿™é‡Œæ˜¯ <code>filePart.transferTo(path)</code>ï¼‰å®Œæˆï¼ˆå‘å‡ºå®Œæˆä¿¡å·ï¼‰åï¼Œæ‰§è¡Œå¦ä¸€ä¸ª <code>Mono</code>ã€‚</li><li><code>Mono.just(&quot;File uploaded successfully: &quot; + filePart.filename())</code> åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ <code>Mono</code>ï¼Œå®ƒä¼šå‘å‡ºä¸€ä¸ªåŒ…å«æˆåŠŸæ¶ˆæ¯çš„å­—ç¬¦ä¸²ã€‚</li><li>å› æ­¤ï¼Œ<code>.then(...)</code> ç¡®ä¿äº†æ–‡ä»¶ä¼ è¾“å®Œæˆåï¼Œå†å‘å‡ºæˆåŠŸä¸Šä¼ çš„æ¶ˆæ¯ã€‚</li></ul></li></ul><h2 id="3-ä½¿ç”¨-cURL-è°ƒç”¨"><a href="#3-ä½¿ç”¨-cURL-è°ƒç”¨" class="headerlink" title="3. ä½¿ç”¨ cURL è°ƒç”¨"></a>3. ä½¿ç”¨ cURL è°ƒç”¨</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>curl</code> å‘½ä»¤æ¥æµ‹è¯•è¿™ä¸ªä¸Šä¼ æ¥å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -F <span class="string">&quot;file=@/path/to/your/local/file.txt&quot;</span> http://localhost:8080/upload</span><br></pre></td></tr></table></figure><p>è¯·å°† <code>/path/to/your/local/file.txt</code> æ›¿æ¢ä¸ºæ‚¨æœ¬åœ°å®é™…æ–‡ä»¶çš„è·¯å¾„ã€‚</p><hr><h2 id="Swagger-UI-æ”¯æŒ"><a href="#Swagger-UI-æ”¯æŒ" class="headerlink" title="Swagger UI æ”¯æŒ"></a>Swagger UI æ”¯æŒ</h2><p>ä¸ºäº†æ–¹ä¾¿ API çš„å¯è§†åŒ–å’Œæµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå…¶æ·»åŠ  Swagger UI æ”¯æŒã€‚</p><h2 id="1-æ·»åŠ ä¾èµ–"><a href="#1-æ·»åŠ ä¾èµ–" class="headerlink" title="1. æ·»åŠ ä¾èµ–"></a>1. æ·»åŠ ä¾èµ–</h2><p>å¦‚å‰æ‰€è¿°ï¼Œåœ¨ <code>build.gradle</code> ä¸­æ·»åŠ  <code>springdoc-openapi-starter-webfluxui</code> ä¾èµ–ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springdoc:springdoc-openapi-starter-webfluxui:2.5.0&#x27;</span> <span class="comment">// è¯·æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-é…ç½®-Controller-æ³¨è§£"><a href="#2-é…ç½®-Controller-æ³¨è§£" class="headerlink" title="2. é…ç½® Controller æ³¨è§£"></a>2. é…ç½® Controller æ³¨è§£</h2><p><code>springdoc-openapi</code> åº“ä¼šè‡ªåŠ¨æ‰«æå¸¦æœ‰ Spring MVC æˆ– Spring WebFlux æ³¨è§£çš„ Controllerã€‚æ‚¨åªéœ€è¦ç¡®ä¿æ‚¨çš„ Controller å’Œæ–¹æ³•ä½¿ç”¨äº†æ ‡å‡†çš„ Spring WebFlux æ³¨è§£ï¼ˆå¦‚ <code>@RestController</code>, <code>@PostMapping</code>, <code>@RequestPart</code> ç­‰ï¼‰ï¼Œ<code>springdoc-openapi</code> å°±ä¼šè‡ªåŠ¨ä¸ºæ‚¨ç”Ÿæˆ OpenAPI æ–‡æ¡£ï¼Œå¹¶åœ¨å¯åŠ¨åé€šè¿‡è®¿é—® <code>/swagger-ui.html</code> ï¼ˆæˆ–å…¶ä»–é»˜è®¤è·¯å¾„ï¼Œå…·ä½“å–å†³äºç‰ˆæœ¬å’Œé…ç½®ï¼‰æ¥æŸ¥çœ‹ã€‚</p><p>åœ¨ä¸Šé¢çš„ <code>FileController</code> ç¤ºä¾‹ä¸­ï¼Œå·²ç»ä½¿ç”¨äº† <code>@RestController</code> å’Œ <code>@PostMapping</code> ç­‰æ³¨è§£ï¼Œå› æ­¤æ— éœ€é¢å¤–çš„é…ç½®å³å¯æ”¯æŒ Swagger UIã€‚</p><p>åœ¨é¡¹ç›®å¯åŠ¨åï¼Œè®¿é—® <code>http://localhost:8080/swagger-ui.html</code> ï¼ˆå‡è®¾æ‚¨çš„åº”ç”¨è¿è¡Œåœ¨ 8080 ç«¯å£ï¼‰ï¼Œæ‚¨å°±å¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸Šä¼ æ¥å£çš„ Swagger UI ç•Œé¢äº†ã€‚</p><hr><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±æˆåŠŸåœ°åœ¨ Spring WebFlux ä¸­å®ç°äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœ¬åœ°çš„åŠŸèƒ½ï¼Œå¹¶ä¸ºå…¶æ·»åŠ äº† Swagger UI æ”¯æŒã€‚æ‚¨å¯ä»¥åŸºäºæ­¤è¿›ä¸€æ­¥æ‰©å±•ï¼Œä¾‹å¦‚æ·»åŠ æ–‡ä»¶ç±»å‹æ ¡éªŒã€å¤§å°é™åˆ¶ï¼Œä»¥åŠå°†æ–‡ä»¶å­˜å‚¨ç›®æ ‡åˆ‡æ¢ä¸º MinIO ç­‰å¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
            <tag> spring boot </tag>
            
            <tag> spring webflux </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gradle å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ Spring Web JAR</title>
      <link href="/2025/09/01/back-end/gradle-force-specific-version-of-spring-web-jar/"/>
      <url>/2025/09/01/back-end/gradle-force-specific-version-of-spring-web-jar/</url>
      
        <content type="html"><![CDATA[<h1 id="Gradle-å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„-Spring-Web-JAR"><a href="#Gradle-å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„-Spring-Web-JAR" class="headerlink" title="Gradle å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ Spring Web JAR"></a>Gradle å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ Spring Web JAR</h1><h2 id="åœºæ™¯è¯´æ˜"><a href="#åœºæ™¯è¯´æ˜" class="headerlink" title="åœºæ™¯è¯´æ˜"></a>åœºæ™¯è¯´æ˜</h2><p>ç”±äºå…¬å¸Artifactoryå·²ç¦æ­¢ä¸‹è½½Spring Web 5.xç›¸å…³ä¾èµ–ï¼Œå¿…é¡»é€šè¿‡æœ¬åœ°JARåŒ…spring-web-5.3.31.jarï¼Œå¼ºåˆ¶è®©æ‰€æœ‰ä¾èµ–Spring Webçš„å…¶ä»–åº“ä½¿ç”¨è¿™ä¸ªæŒ‡å®šç‰ˆæœ¬ã€‚</p><h2 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¼ºåˆ¶ç‰ˆæœ¬è§£æ"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¼ºåˆ¶ç‰ˆæœ¬è§£æ" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¼ºåˆ¶ç‰ˆæœ¬è§£æ"></a>æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¼ºåˆ¶ç‰ˆæœ¬è§£æ</h2><p>è¿™ç§æ–¹æ³•é€šè¿‡ Gradle çš„å¼ºåˆ¶ç‰ˆæœ¬åŠŸèƒ½ï¼Œå¼ºåˆ¶æ‰€æœ‰ä¾èµ–ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ã€‚</p><h3 id="Gradle-é…ç½®"><a href="#Gradle-é…ç½®" class="headerlink" title="Gradle é…ç½®"></a>Gradle é…ç½®</h3><p>åœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">configurations.all &#123;</span><br><span class="line">    <span class="comment">// å¼ºåˆ¶æ‰€æœ‰ spring-web ä¾èµ–ä½¿ç”¨ 5.3.31 ç‰ˆæœ¬</span></span><br><span class="line">    resolutionStrategy &#123;</span><br><span class="line">        force <span class="string">&#x27;org.springframework:spring-web:5.3.31&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ æœ¬åœ° JAR æ–‡ä»¶</span></span><br><span class="line">    implementation files(<span class="string">&#x27;libs/spring-web-5.3.31.jar&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…¶ä»–ä¾èµ–...</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-web:2.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springframework.security:spring-security-web:5.7.1&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾èµ–è§£æè¿‡ç¨‹"><a href="#ä¾èµ–è§£æè¿‡ç¨‹" class="headerlink" title="ä¾èµ–è§£æè¿‡ç¨‹"></a>ä¾èµ–è§£æè¿‡ç¨‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring-boot-starter-web:2.7.0</span><br><span class="line">â””â”€â”€ spring-web:5.3.18 (åŸå§‹ä¾èµ–)</span><br><span class="line">â””â”€â”€ spring-web:5.3.31 (å¼ºåˆ¶ä½¿ç”¨)</span><br><span class="line"></span><br><span class="line">spring-security-web:5.7.1</span><br><span class="line">â””â”€â”€ spring-web:5.3.20 (åŸå§‹ä¾èµ–)</span><br><span class="line">â””â”€â”€ spring-web:5.3.31 (å¼ºåˆ¶ä½¿ç”¨)</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>é…ç½®ç®€å•ï¼Œä¸€è¡Œä»£ç è§£å†³é—®é¢˜</li><li>é€‚ç”¨äºæ‰€æœ‰é…ç½®ï¼ˆimplementation, testImplementationç­‰ï¼‰</li><li>Gradle è‡ªåŠ¨å¤„ç†ç‰ˆæœ¬å†²çª</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>å¦‚æœæœ¬åœ° JAR ä¸å¼ºåˆ¶ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯</li><li>éœ€è¦ç¡®ä¿æ‰€æœ‰ä¾èµ–ä¸å¼ºåˆ¶ç‰ˆæœ¬å…¼å®¹</li></ul><h2 id="æ–¹æ³•äºŒï¼šä½¿ç”¨ä¾èµ–æ›¿æ¢"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨ä¾èµ–æ›¿æ¢" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨ä¾èµ–æ›¿æ¢"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨ä¾èµ–æ›¿æ¢</h2><p>è¿™ç§æ–¹æ³•ä½¿ç”¨ Gradle çš„ä¾èµ–æ›¿æ¢åŠŸèƒ½ï¼Œå°†è¿œç¨‹ä¾èµ–æ›¿æ¢ä¸ºæœ¬åœ° JAR æ–‡ä»¶ã€‚</p><h3 id="Gradle-é…ç½®-1"><a href="#Gradle-é…ç½®-1" class="headerlink" title="Gradle é…ç½®"></a>Gradle é…ç½®</h3><p>åœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy.dependencySubstitution &#123;</span><br><span class="line">        <span class="comment">// å°†æ‰€æœ‰ spring-web ä¾èµ–æ›¿æ¢ä¸ºæœ¬åœ°æ–‡ä»¶</span></span><br><span class="line">        substitute module(<span class="string">&#x27;org.springframework:spring-web&#x27;</span>) </span><br><span class="line">            using files(<span class="string">&#x27;libs/spring-web-5.3.31.jar&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">// å…¶ä»–ä¾èµ–...</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-web:2.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;org.springframework.security:spring-security-web:5.7.1&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾èµ–è§£æè¿‡ç¨‹-1"><a href="#ä¾èµ–è§£æè¿‡ç¨‹-1" class="headerlink" title="ä¾èµ–è§£æè¿‡ç¨‹"></a>ä¾èµ–è§£æè¿‡ç¨‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring-boot-starter-web:2.7.0</span><br><span class="line">â””â”€â”€ spring-web:5.3.18 (åŸå§‹ä¾èµ–)</span><br><span class="line">â””â”€â”€ libs/spring-web-5.3.31.jar (æ›¿æ¢ä¸ºæœ¬åœ°æ–‡ä»¶)</span><br><span class="line"></span><br><span class="line">spring-security-web:5.7.1</span><br><span class="line">â””â”€â”€ spring-web:5.3.20 (åŸå§‹ä¾èµ–)</span><br><span class="line">â””â”€â”€ libs/spring-web-5.3.31.jar (æ›¿æ¢ä¸ºæœ¬åœ°æ–‡ä»¶)</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ç²¾ç¡®æ§åˆ¶ä¾èµ–æ¥æº</li><li>å¯ä»¥é’ˆå¯¹ç‰¹å®šä¾èµ–è¿›è¡Œæ›¿æ¢</li><li>é€‚ç”¨äºå¤æ‚çš„ä¾èµ–å…³ç³»</li></ul><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>é…ç½®ç›¸å¯¹å¤æ‚</li><li>éœ€è¦ç¡®ä¿æ›¿æ¢çš„ä¾èµ–æ¥å£å…¼å®¹</li></ul><h2 id="æ–¹æ³•ä¸‰ï¼šæ’é™¤å¹¶æ˜¾å¼å¼•å…¥"><a href="#æ–¹æ³•ä¸‰ï¼šæ’é™¤å¹¶æ˜¾å¼å¼•å…¥" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šæ’é™¤å¹¶æ˜¾å¼å¼•å…¥"></a>æ–¹æ³•ä¸‰ï¼šæ’é™¤å¹¶æ˜¾å¼å¼•å…¥</h2><p>è¿™ç§æ–¹æ³•ä»æ‰€æœ‰ä¾èµ–ä¸­æ’é™¤ Spring Webï¼Œç„¶åæ˜¾å¼å¼•å…¥æœ¬åœ° JAR æ–‡ä»¶ã€‚</p><h3 id="Gradle-é…ç½®-2"><a href="#Gradle-é…ç½®-2" class="headerlink" title="Gradle é…ç½®"></a>Gradle é…ç½®</h3><p>åœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">configurations.all &#123;</span><br><span class="line">    <span class="comment">// å…¨å±€æ’é™¤æ‰€æœ‰ spring-web ä¾èµ–</span></span><br><span class="line">    exclude <span class="attr">group:</span> <span class="string">&#x27;org.springframework&#x27;</span>, <span class="attr">module:</span> <span class="string">&#x27;spring-web&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ æœ¬åœ° JAR æ–‡ä»¶</span></span><br><span class="line">    implementation files(<span class="string">&#x27;libs/spring-web-5.3.31.jar&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…¶ä»–ä¾èµ–ï¼Œä½¿ç”¨ exclude ç¡®ä¿ä¸ä¼ é€’ spring-web</span></span><br><span class="line">    implementation (<span class="string">&#x27;org.springframework.boot:spring-boot-starter-web:2.7.0&#x27;</span>) &#123;</span><br><span class="line">        exclude <span class="attr">group:</span> <span class="string">&#x27;org.springframework&#x27;</span>, <span class="attr">module:</span> <span class="string">&#x27;spring-web&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    implementation (<span class="string">&#x27;org.springframework.security:spring-security-web:5.7.1&#x27;</span>) &#123;</span><br><span class="line">        exclude <span class="attr">group:</span> <span class="string">&#x27;org.springframework&#x27;</span>, <span class="attr">module:</span> <span class="string">&#x27;spring-web&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾èµ–è§£æè¿‡ç¨‹-2"><a href="#ä¾èµ–è§£æè¿‡ç¨‹-2" class="headerlink" title="ä¾èµ–è§£æè¿‡ç¨‹"></a>ä¾èµ–è§£æè¿‡ç¨‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring-boot-starter-web:2.7.0</span><br><span class="line">â””â”€â”€ spring-web:5.3.18 (å·²è¢«æ’é™¤)</span><br><span class="line"></span><br><span class="line">spring-security-web:5.7.1</span><br><span class="line">â””â”€â”€ spring-web:5.3.20 (å·²è¢«æ’é™¤)</span><br><span class="line"></span><br><span class="line">æœ¬åœ°å¼•å…¥: libs/spring-web-5.3.31.jar</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å®Œå…¨æ§åˆ¶ä¾èµ–æ ‘</li><li>ç¡®ä¿åªä½¿ç”¨æœ¬åœ° JAR</li><li>é¿å…ä»»ä½•ç‰ˆæœ¬å†²çª</li></ul><h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>é…ç½®æœ€å¤æ‚ï¼Œéœ€è¦ä¸ºæ¯ä¸ªä¾èµ–æ·»åŠ æ’é™¤è§„åˆ™</li><li>ç»´æŠ¤æˆæœ¬è¾ƒé«˜</li></ul><h2 id="æ¨èä½¿ç”¨æ–¹æ³•"><a href="#æ¨èä½¿ç”¨æ–¹æ³•" class="headerlink" title="æ¨èä½¿ç”¨æ–¹æ³•"></a>æ¨èä½¿ç”¨æ–¹æ³•</h2><p><strong>æ¨èä½¿ç”¨æ–¹æ³•ä¸€</strong>ï¼šå¼ºåˆ¶ç‰ˆæœ¬è§£ææ˜¯æœ€ç®€å•æœ‰æ•ˆçš„æ–¹æ³•ï¼Œé€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ã€‚åªéœ€ç¡®ä¿æ‚¨çš„æœ¬åœ° JAR æ–‡ä»¶ç¡®å®æ˜¯ 5.3.31 ç‰ˆæœ¬ã€‚</p><h2 id="éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ"><a href="#éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ" class="headerlink" title="éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ"></a>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</h2><p>æ·»åŠ ä»¥ä¸‹ä»»åŠ¡åˆ° <code>build.gradle</code> æ¥éªŒè¯ä¾èµ–è§£æç»“æœï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">task checkDependencies &#123;</span><br><span class="line">    doLast &#123;</span><br><span class="line">        configurations.compileClasspath.resolvedConfiguration.resolvedArtifacts.each &#123; artifact -&gt;</span><br><span class="line">            println <span class="string">&quot;ä¾èµ–: $&#123;artifact.moduleVersion.id&#125; -&gt; æ–‡ä»¶: $&#123;artifact.file.name&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç‰¹åˆ«æ£€æŸ¥ spring-web</span></span><br><span class="line">        <span class="keyword">def</span> springWebDeps = configurations.compileClasspath.incoming.dependencies</span><br><span class="line">            .findAll &#123; it.name == <span class="string">&#x27;spring-web&#x27;</span> &#125;</span><br><span class="line">        </span><br><span class="line">        println <span class="string">&quot;Spring Web ä¾èµ–:&quot;</span></span><br><span class="line">        springWebDeps.each &#123; dep -&gt;</span><br><span class="line">            println <span class="string">&quot;  - $&#123;dep.group&#125;:$&#123;dep.name&#125;:$&#123;dep.version&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ <code>./gradlew checkDependencies</code> æŸ¥çœ‹æ‰€æœ‰ä¾èµ–åŠå…¶è§£æç»“æœã€‚</p><h2 id="å…³é”®è¦ç‚¹"><a href="#å…³é”®è¦ç‚¹" class="headerlink" title="å…³é”®è¦ç‚¹"></a>å…³é”®è¦ç‚¹</h2><ul><li><strong>æ–¹æ³•ä¸€ï¼ˆå¼ºåˆ¶ç‰ˆæœ¬è§£æï¼‰</strong>æ˜¯æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•ï¼Œæ¨èå¤§å¤šæ•°åœºæ™¯ä½¿ç”¨</li><li><strong>æ–¹æ³•äºŒï¼ˆä¾èµ–æ›¿æ¢ï¼‰</strong>æä¾›äº†æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œé€‚ç”¨äºå¤æ‚åœºæ™¯</li><li><strong>æ–¹æ³•ä¸‰ï¼ˆæ’é™¤å¹¶æ˜¾å¼å¼•å…¥ï¼‰</strong>æ˜¯æœ€å½»åº•çš„æ–¹æ³•ï¼Œä½†é…ç½®å’Œç»´æŠ¤æˆæœ¬è¾ƒé«˜</li><li>æ— è®ºä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œéƒ½éœ€è¦ç¡®ä¿æœ¬åœ°JARä¸é¡¹ç›®å…¶ä»–ä¾èµ–å…¼å®¹</li></ul><hr><p><strong>é¡¹ç›®ç»“æ„å‚è€ƒ</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é¡¹ç›®ç›®å½•/</span><br><span class="line">â”œâ”€â”€ libs/</span><br><span class="line">â”‚   â”œâ”€â”€ spring-web-5.3.31.jar</span><br><span class="line">â”‚   â””â”€â”€ å…¶ä»–åº“æ–‡ä»¶.jar</span><br><span class="line">â”œâ”€â”€ build.gradle</span><br><span class="line">â”œâ”€â”€ settings.gradle</span><br><span class="line">â””â”€â”€ src/</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œæ‚¨å¯ä»¥ç¡®ä¿æ‰€æœ‰ä¾èµ– Spring Web çš„åº“éƒ½ä½¿ç”¨æ‚¨æŒ‡å®šçš„ 5.3.31 ç‰ˆæœ¬æœ¬åœ° JAR æ–‡ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨å†…ç½‘ Kubernetes é›†ç¾¤ä¸Šä½¿ç”¨ Helm å®‰è£… Rancher å¹¶æ”¯æŒåŸŸåè®¿é—®</title>
      <link href="/2025/08/17/software/deploying-rancher-via-helm-in-rrivate-kubernetes-with-custom-domain-configuration/"/>
      <url>/2025/08/17/software/deploying-rancher-via-helm-in-rrivate-kubernetes-with-custom-domain-configuration/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨ 192.168.31.222 çš„å†…ç½‘æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ Helm å®‰è£… Rancherï¼Œå¹¶é€šè¿‡åŸŸå rancher.damingerdaiinternal.com è®¿é—®ã€‚  </p><h2 id="1-å‰ææ¡ä»¶"><a href="#1-å‰ææ¡ä»¶" class="headerlink" title="1. å‰ææ¡ä»¶"></a>1. å‰ææ¡ä»¶</h2><p>âœ… å·²éƒ¨ç½² Kubernetes é›†ç¾¤ï¼ˆå•èŠ‚ç‚¹æˆ–å¤šèŠ‚ç‚¹å‡å¯ï¼‰<br>âœ… å·²å®‰è£… kubectl å’Œ Helm 3<br>âœ… å·²é…ç½® DNS æˆ– Hosts è§£æï¼ˆç¡®ä¿ rancher.damingerdaiinternal.com æŒ‡å‘ 192.168.31.222ï¼‰<br>âœ… æœåŠ¡å™¨å¼€æ”¾ 80 å’Œ 443 ç«¯å£  </p><h2 id="2-å®‰è£…-cert-managerï¼ˆç”¨äºè¯ä¹¦ç®¡ç†ï¼‰"><a href="#2-å®‰è£…-cert-managerï¼ˆç”¨äºè¯ä¹¦ç®¡ç†ï¼‰" class="headerlink" title="2. å®‰è£… cert-managerï¼ˆç”¨äºè¯ä¹¦ç®¡ç†ï¼‰"></a>2. å®‰è£… cert-managerï¼ˆç”¨äºè¯ä¹¦ç®¡ç†ï¼‰</h2><p>Rancher ä¾èµ– cert-manager ç®¡ç† TLS è¯ä¹¦ã€‚</p><h3 id="2-1-å®‰è£…-cert-manager-CRD"><a href="#2-1-å®‰è£…-cert-manager-CRD" class="headerlink" title="2.1 å®‰è£… cert-manager CRD"></a>2.1 å®‰è£… cert-manager CRD</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.crds.yaml</span><br></pre></td></tr></table></figure><h3 id="2-2-æ·»åŠ -Helm-ä»“åº“å¹¶å®‰è£…-cert-manager"><a href="#2-2-æ·»åŠ -Helm-ä»“åº“å¹¶å®‰è£…-cert-manager" class="headerlink" title="2.2 æ·»åŠ  Helm ä»“åº“å¹¶å®‰è£… cert-manager"></a>2.2 æ·»åŠ  Helm ä»“åº“å¹¶å®‰è£… cert-manager</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">helm repo add jetstack https://charts.jetstack.io</span><br><span class="line">helm repo update</span><br><span class="line">helm install cert-manager jetstack/cert-manager \</span><br><span class="line">  --namespace cert-manager \</span><br><span class="line">  --create-namespace \</span><br><span class="line">  --version v1.11.0</span><br></pre></td></tr></table></figure><h3 id="2-3-éªŒè¯-cert-manager-æ˜¯å¦è¿è¡Œ"><a href="#2-3-éªŒè¯-cert-manager-æ˜¯å¦è¿è¡Œ" class="headerlink" title="2.3 éªŒè¯ cert-manager æ˜¯å¦è¿è¡Œ"></a>2.3 éªŒè¯ cert-manager æ˜¯å¦è¿è¡Œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n cert-manager get pods</span><br><span class="line"></span><br><span class="line">é¢„æœŸè¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line">NAME                                       READY   STATUS    RESTARTS   AGE</span><br><span class="line">cert-manager-7dd5554b4-abc12               1/1     Running   0          1m</span><br><span class="line">cert-manager-cainjector-64dc9f6bff-xyz45   1/1     Running   0          1m</span><br><span class="line">cert-manager-webhook-5f4d8b7b8d-pqr78      1/1     Running   0          1m</span><br></pre></td></tr></table></figure><h2 id="3-ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆé€‚ç”¨äºå†…ç½‘ï¼‰"><a href="#3-ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆé€‚ç”¨äºå†…ç½‘ï¼‰" class="headerlink" title="3. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆé€‚ç”¨äºå†…ç½‘ï¼‰"></a>3. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆé€‚ç”¨äºå†…ç½‘ï¼‰</h2><p>ç”±äºæ˜¯å†…ç½‘ç¯å¢ƒï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ã€‚</p><h3 id="3-1-ç”Ÿæˆ-CA-æ ¹è¯ä¹¦"><a href="#3-1-ç”Ÿæˆ-CA-æ ¹è¯ä¹¦" class="headerlink" title="3.1 ç”Ÿæˆ CA æ ¹è¯ä¹¦"></a>3.1 ç”Ÿæˆ CA æ ¹è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -newkey rsa:4096 -sha256 -days 3650 -nodes \</span><br><span class="line">  -keyout ca.key -out ca.crt -subj <span class="string">&quot;/CN=damingerdaiinternal.com CA&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦"><a href="#3-2-ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦" class="headerlink" title="3.2 ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦"></a>3.2 ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl req -newkey rsa:4096 -sha256 -nodes \</span><br><span class="line">  -keyout tls.key -out tls.csr -subj <span class="string">&quot;/CN=rancher.damingerdaiinternal.com&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3-3-ä½¿ç”¨-CA-ç­¾åæœåŠ¡å™¨è¯ä¹¦"><a href="#3-3-ä½¿ç”¨-CA-ç­¾åæœåŠ¡å™¨è¯ä¹¦" class="headerlink" title="3.3 ä½¿ç”¨ CA ç­¾åæœåŠ¡å™¨è¯ä¹¦"></a>3.3 ä½¿ç”¨ CA ç­¾åæœåŠ¡å™¨è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -sha256 -days 3650 \</span><br><span class="line">  -<span class="keyword">in</span> tls.csr -CA ca.crt -CAkey ca.key -CAcreateserial \</span><br><span class="line">  -out tls.crt -extfile &lt;(<span class="built_in">echo</span> <span class="string">&quot;subjectAltName=DNS:rancher.damingerdaiinternal.com&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="4-å®‰è£…-Rancher"><a href="#4-å®‰è£…-Rancher" class="headerlink" title="4. å®‰è£… Rancher"></a>4. å®‰è£… Rancher</h2><h3 id="4-1-åˆ›å»ºå‘½åç©ºé—´"><a href="#4-1-åˆ›å»ºå‘½åç©ºé—´" class="headerlink" title="4.1 åˆ›å»ºå‘½åç©ºé—´"></a>4.1 åˆ›å»ºå‘½åç©ºé—´</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create namespace cattle-system</span><br></pre></td></tr></table></figure><h3 id="4-2-åˆ›å»º-Kubernetes-Secret-å­˜å‚¨è¯ä¹¦"><a href="#4-2-åˆ›å»º-Kubernetes-Secret-å­˜å‚¨è¯ä¹¦" class="headerlink" title="4.2 åˆ›å»º Kubernetes Secret å­˜å‚¨è¯ä¹¦"></a>4.2 åˆ›å»º Kubernetes Secret å­˜å‚¨è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n cattle-system create secret tls tls-rancher-ingress \</span><br><span class="line">  --cert=tls.crt --key=tls.key</span><br><span class="line">kubectl -n cattle-system create secret generic tls-ca \</span><br><span class="line">  --from-file=ca.crt</span><br></pre></td></tr></table></figure><h3 id="4-3-æ·»åŠ -Rancher-Helm-ä»“åº“"><a href="#4-3-æ·»åŠ -Rancher-Helm-ä»“åº“" class="headerlink" title="4.3 æ·»åŠ  Rancher Helm ä»“åº“"></a>4.3 æ·»åŠ  Rancher Helm ä»“åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">helm repo add rancher-stable https://releases.rancher.com/server-charts/stable</span><br><span class="line">helm repo update</span><br></pre></td></tr></table></figure><h3 id="4-4-ä½¿ç”¨-Helm-å®‰è£…-Rancher"><a href="#4-4-ä½¿ç”¨-Helm-å®‰è£…-Rancher" class="headerlink" title="4.4 ä½¿ç”¨ Helm å®‰è£… Rancher"></a>4.4 ä½¿ç”¨ Helm å®‰è£… Rancher</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">helm install rancher rancher-stable/rancher \</span><br><span class="line">  --namespace cattle-system \</span><br><span class="line">  --<span class="built_in">set</span> hostname=rancher.damingerdaiinternal.com \</span><br><span class="line">  --<span class="built_in">set</span> bootstrapPassword=admin \</span><br><span class="line">  --<span class="built_in">set</span> ingress.tls.source=secret \</span><br><span class="line">  --<span class="built_in">set</span> privateCA=<span class="literal">true</span> \</span><br><span class="line">  --<span class="built_in">set</span> replicas=1</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">NAME: rancher</span><br><span class="line">LAST DEPLOYED: Sun Aug 17 14:37:32 2025</span><br><span class="line">NAMESPACE: cattle-system</span><br><span class="line">STATUS: deployed</span><br><span class="line">REVISION: 1</span><br><span class="line">TEST SUITE: None</span><br><span class="line">NOTES:</span><br><span class="line">Rancher Server has been installed.</span><br><span class="line"></span><br><span class="line">NOTE: Rancher may take several minutes to fully initialize. Please standby <span class="keyword">while</span> Certificates are being issued, Containers are started and the Ingress rule comes up.</span><br><span class="line"></span><br><span class="line">Check out our docs at https://rancher.com/docs/</span><br><span class="line"></span><br><span class="line">If you provided your own bootstrap password during installation, browse to https://rancher.damingerdaiinternal.com to get started.</span><br><span class="line"></span><br><span class="line">If this is the first time you installed Rancher, get started by running this <span class="built_in">command</span> and clicking the URL it generates:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="built_in">echo</span> https://rancher.damingerdaiinternal.com/dashboard/?setup=$(kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=<span class="string">&#x27;&#123;&#123;.data.bootstrapPassword|base64decode&#125;&#125;&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">To get just the bootstrap password on its own, run:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=<span class="string">&#x27;&#123;&#123;.data.bootstrapPassword|base64decode&#125;&#125;&#123;&#123; &quot;\n&quot; &#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="5-é…ç½®-DNS-Hosts-è§£æ"><a href="#5-é…ç½®-DNS-Hosts-è§£æ" class="headerlink" title="5. é…ç½® DNS &#x2F; Hosts è§£æ"></a>5. é…ç½® DNS &#x2F; Hosts è§£æ</h2><h3 id="5-1-æ–¹æ¡ˆ-Aï¼šå†…ç½‘-DNS-æœåŠ¡å™¨"><a href="#5-1-æ–¹æ¡ˆ-Aï¼šå†…ç½‘-DNS-æœåŠ¡å™¨" class="headerlink" title="5.1 æ–¹æ¡ˆ Aï¼šå†…ç½‘ DNS æœåŠ¡å™¨"></a>5.1 æ–¹æ¡ˆ Aï¼šå†…ç½‘ DNS æœåŠ¡å™¨</h3><p>åœ¨ DNS æœåŠ¡å™¨ï¼ˆå¦‚ Bindã€Windows DNSï¼‰ä¸­æ·»åŠ ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rancher.damingerdaiinternal.com. IN A 192.168.31.222</span><br></pre></td></tr></table></figure><h3 id="5-2-æ–¹æ¡ˆ-Bï¼šå®¢æˆ·ç«¯-Hosts-æ–‡ä»¶"><a href="#5-2-æ–¹æ¡ˆ-Bï¼šå®¢æˆ·ç«¯-Hosts-æ–‡ä»¶" class="headerlink" title="5.2 æ–¹æ¡ˆ Bï¼šå®¢æˆ·ç«¯ Hosts æ–‡ä»¶"></a>5.2 æ–¹æ¡ˆ Bï¼šå®¢æˆ·ç«¯ Hosts æ–‡ä»¶</h3><p>åœ¨éœ€è¦è®¿é—®çš„ç”µè„‘ä¸Šä¿®æ”¹ &#x2F;etc&#x2F;hostsï¼ˆLinux&#x2F;macOSï¼‰æˆ– C:\Windows\System32\drivers\etc\hostsï¼ˆWindowsï¼‰ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.31.222 rancher.damingerdaiinternal.com</span><br></pre></td></tr></table></figure><h2 id="6-éªŒè¯å®‰è£…"><a href="#6-éªŒè¯å®‰è£…" class="headerlink" title="6. éªŒè¯å®‰è£…"></a>6. éªŒè¯å®‰è£…</h2><h3 id="6-1-æ£€æŸ¥-Rancher-Pod-çŠ¶æ€"><a href="#6-1-æ£€æŸ¥-Rancher-Pod-çŠ¶æ€" class="headerlink" title="6.1 æ£€æŸ¥ Rancher Pod çŠ¶æ€"></a>6.1 æ£€æŸ¥ Rancher Pod çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n cattle-system get pods -l app=rancher</span><br><span class="line"></span><br><span class="line">é¢„æœŸè¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line">NAME                      READY   STATUS    RESTARTS   AGE</span><br><span class="line">rancher-5d8f6c9b8-abc12   1/1     Running   0          2m</span><br></pre></td></tr></table></figure><h3 id="6-2-æŸ¥çœ‹-Ingress-é…ç½®"><a href="#6-2-æŸ¥çœ‹-Ingress-é…ç½®" class="headerlink" title="6.2 æŸ¥çœ‹ Ingress é…ç½®"></a>6.2 æŸ¥çœ‹ Ingress é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n cattle-system get ingress</span><br><span class="line"></span><br><span class="line">é¢„æœŸè¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line">NAME      HOSTS                              ADDRESS        PORTS</span><br><span class="line">rancher   rancher.damingerdaiinternal.com    192.168.31.222 80, 443</span><br></pre></td></tr></table></figure><h3 id="6-3-è®¿é—®-Rancher-UI"><a href="#6-3-è®¿é—®-Rancher-UI" class="headerlink" title="6.3 è®¿é—® Rancher UI"></a>6.3 è®¿é—® Rancher UI</h3><p>åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š</p><p><a href="https://rancher.damingerdaiinternal.com/">https://rancher.damingerdaiinternal.com</a></p><p>â€¢ é¦–æ¬¡ç™»å½•ï¼šç”¨æˆ·å adminï¼Œå¯†ç  admin  </p><p>â€¢ è¯ä¹¦è­¦å‘Šï¼šç”±äºæ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œæµè§ˆå™¨ä¼šæç¤ºä¸å®‰å…¨ï¼Œæ‰‹åŠ¨ä¿¡ä»»å³å¯  </p><h2 id="7-å¸è½½-Rancher"><a href="#7-å¸è½½-Rancher" class="headerlink" title="7. å¸è½½ Rancher"></a>7. å¸è½½ Rancher</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">helm uninstall rancher -n cattle-system</span><br><span class="line">kubectl delete namespace cattle-system</span><br><span class="line">kubectl delete -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.crds.yaml</span><br></pre></td></tr></table></figure><h2 id="8-å¸¸è§é—®é¢˜"><a href="#8-å¸¸è§é—®é¢˜" class="headerlink" title="8. å¸¸è§é—®é¢˜"></a>8. å¸¸è§é—®é¢˜</h2><h3 id="Q1-è®¿é—®æ—¶æç¤º-â€œè¯ä¹¦ä¸å—ä¿¡ä»»â€"><a href="#Q1-è®¿é—®æ—¶æç¤º-â€œè¯ä¹¦ä¸å—ä¿¡ä»»â€" class="headerlink" title="Q1: è®¿é—®æ—¶æç¤º â€œè¯ä¹¦ä¸å—ä¿¡ä»»â€"></a>Q1: è®¿é—®æ—¶æç¤º â€œè¯ä¹¦ä¸å—ä¿¡ä»»â€</h3><p>âœ… è§£å†³æ–¹æ¡ˆï¼š<br>â€¢ Windowsï¼šåŒå‡» ca.crt å¹¶å®‰è£…åˆ° â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€  </p><p>â€¢ Linux&#x2F;macOSï¼š<br>  sudo cp ca.crt &#x2F;usr&#x2F;local&#x2F;share&#x2F;ca-certificates&#x2F;<br>  sudo update-ca-certificates</p><h3 id="Q2-Rancher-Pod-æ— æ³•å¯åŠ¨"><a href="#Q2-Rancher-Pod-æ— æ³•å¯åŠ¨" class="headerlink" title="Q2: Rancher Pod æ— æ³•å¯åŠ¨"></a>Q2: Rancher Pod æ— æ³•å¯åŠ¨</h3><p>âœ… æ£€æŸ¥æ—¥å¿—ï¼š<br>kubectl -n cattle-system logs -f deployment&#x2F;rancher</p><p>âœ… æ£€æŸ¥èµ„æºæ˜¯å¦è¶³å¤Ÿï¼ˆRancher è‡³å°‘éœ€è¦ 2GB å†…å­˜ï¼‰ï¼š<br>kubectl describe nodes</p><h3 id="Q3-å¤–ç½‘æ— æ³•è®¿é—®"><a href="#Q3-å¤–ç½‘æ— æ³•è®¿é—®" class="headerlink" title="Q3: å¤–ç½‘æ— æ³•è®¿é—®"></a>Q3: å¤–ç½‘æ— æ³•è®¿é—®</h3><p>âœ… æ£€æŸ¥é˜²ç«å¢™ï¼š<br>sudo ufw allow 80&#x2F;tcp<br>sudo ufw allow 443&#x2F;tcp</p><p>âœ… å¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼Œæ£€æŸ¥å®‰å…¨ç»„è§„åˆ™  </p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>âœ… å·²å®Œæˆï¼š<br>â€¢ ä½¿ç”¨ Helm å®‰è£… Rancher  </p><p>â€¢ é…ç½®è‡ªç­¾åè¯ä¹¦  </p><p>â€¢ æ”¯æŒåŸŸå rancher.damingerdaiinternal.com è®¿é—®  </p><p>â€¢ éªŒè¯ HTTPS å®‰å…¨æ€§  </p><p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ <a href="https://rancher.damingerdaiinternal.com/">https://rancher.damingerdaiinternal.com</a> è®¿é—® Rancher ç®¡ç† Kubernetes é›†ç¾¤ï¼ ğŸ‰</p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> Helm </tag>
            
            <tag> Rancher </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ä¸­å›½æ‰‹æœºå·ç éªŒè¯mailgunè´¦å·</title>
      <link href="/2025/08/13/software/how-register-mailgun-with-china-mobile-number/"/>
      <url>/2025/08/13/software/how-register-mailgun-with-china-mobile-number/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Mailgun æ˜¯ä¸€ä¸ªä¸“ä¸ºå¼€å‘è€…è®¾è®¡çš„é‚®ä»¶å‘é€å¹³å°ï¼Œæ”¯æŒé€šè¿‡ API é«˜æ•ˆã€ç¨³å®šåœ°å‘é€å’Œæ¥æ”¶é‚®ä»¶ã€‚å®ƒå¹¿æ³›ç”¨äºç”¨æˆ·é€šçŸ¥ã€è¥é”€é‚®ä»¶ã€è‡ªåŠ¨åŒ–å¼€å‘ä¿¡ç­‰åœºæ™¯ã€‚æ¯ä¸ªæœˆå¯å…è´¹å‘é€10000å°é‚®ä»¶ï¼Œå¯ä»¥æ·»åŠ 1000ä¸ªåŸŸåï¼Œæ¯å°é‚®ä»¶éƒ½æœ‰è·Ÿè¸ªæ—¥å¿—ï¼Œç®€å•æ˜äº†çš„ç®¡ç†ç•Œé¢ã€‚</p><h1 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h1><p>ç‚¹ mailgun.com å³ä¸Šè§’çš„â€œstart for freeâ€œè¿›å»æ˜¯ä¸ä¼šç»™å…è´¹ç‰ˆé€‰é¡¹çš„ï¼Œåªæœ‰ free trialï¼Œè€Œ <a href="https://www.mailgun.com/pricing/">https://www.mailgun.com/pricing/</a> é¡µé¢åˆ™æœ‰å…è´¹ planï¼Œå¸¸è§„æ³¨å†Œå³å¯ï¼Œæ— éœ€å¡«å†™ä¿¡ç”¨å¡.</p><h1 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h1><p>mailgunä¼šå‘é€é‚®ä»¶è¦æ±‚éªŒè¯å·ç ã€‚åœ¨éªŒè¯é¡µé¢ä¼šè¦æ±‚ç”¨æˆ·æä¾›æ‰‹æœºå·éªŒè¯ã€‚ä½†æ˜¯å¯¹ä¸­å›½æ‰‹æœºå·ç æ¥è¯´ï¼Œå¯èƒ½å­˜åœ¨æ”¶ä¸åˆ°éªŒè¯ç çš„å¯èƒ½ã€‚</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/mailgun-validate-error.png" alt="mailgunéªŒè¯ç å¤±è´¥"></p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>åœ¨mailgunåå°ï¼Œç‚¹å‡»å³ä¸Šè§’çš„é—®å·â“ï¼Œç‚¹å‡»â€œSupportâ€æŒ‰é’®ã€‚æäº¤ä¸€ä¸ªå·¥å•ï¼Œç‚¹å‡»å·¦ä¸‹æ–¹â€œOpen a ticketâ€çš„å¼€å·¥å•æŒ‰é’®ã€‚åœ¨å¼€å·¥å•é¡µé¢ä¸‹æ‹‰é€‰æ‹©â€œAccount Managementâ€ç±»åˆ«ï¼Œç„¶åè¾“å…¥é—®é¢˜æ ‡é¢˜å’Œå…·ä½“å†…å®¹ã€‚</p><p>è¿™æ˜¯æˆ‘æ€»ç»“çš„æ¨¡ç‰ˆï¼š</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Subject: Unable to Verify Email Due to Excessive Verification</span><br><span class="line"></span><br><span class="line">Content:</span><br><span class="line">I am unable to complete email verification because I encountered an issue after entering my mobile phone number (+86 xxxxxxxxxxx) and requesting a verification code. The system notified me that I have exceeded the allowed number of attempts, along with other unspecified reminders.</span><br></pre></td></tr></table></figure><p>ç„¶åå¤§æ¦‚åœ¨24å°æ—¶å†…å°±èƒ½è§£å†³ã€‚(æˆ‘æ˜¯40åˆ†é’Ÿå°±è§£å†³äº†)ã€‚</p><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><p>åˆ«ç›¸ä¿¡å’¸é±¼ä¸Šé‚£å¸®æ‰€è°“æä¾›æµ·å¤–æ‰‹æœºå·ç éªŒè¯æœåŠ¡çš„é‚£å¸®åƒåœ¾ã€‚</p><h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h1><ol><li><a href="https://www.jiadingqiang.com/31941.html">Mailgunè´¦å·æ³¨å†Œã€åŸŸåé…ç½®ã€APIå¼€é€šæ•™ç¨‹</a></li><li><a href="https://mailgun-china.com/">Mailgun China</a></li><li><a href="https://zhuanlan.zhihu.com/p/685968877">å›½å¤–Mailguné‚®ä»¶æœåŠ¡è´¦å·éªŒè¯ä¸æˆåŠŸæ€ä¹ˆåŠ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mailgun </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>podmanç™»å½•éhttpsçš„ç§æœ‰ä»“åº“</title>
      <link href="/2025/08/11/back-end/podman-login-nohttps-private-registery/"/>
      <url>/2025/08/11/back-end/podman-login-nohttps-private-registery/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³podmanç™»é™†éhttpsçš„ç§æœ‰ä»“åº“ã€‚<br>è¿™é‡Œä½¿ç”¨192.168.31.220:5000å¨åŠ›</p><h1 id="æ–¹æ¡ˆ1ï¼šç¦ç”¨-TLS-éªŒè¯ï¼ˆä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰"><a href="#æ–¹æ¡ˆ1ï¼šç¦ç”¨-TLS-éªŒè¯ï¼ˆä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰" class="headerlink" title="æ–¹æ¡ˆ1ï¼šç¦ç”¨ TLS éªŒè¯ï¼ˆä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰"></a>æ–¹æ¡ˆ1ï¼šç¦ç”¨ TLS éªŒè¯ï¼ˆä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰</h1><p>å¯¹äºæµ‹è¯•ç¯å¢ƒæˆ–å†…éƒ¨ä¿¡ä»»çš„ç½‘ç»œï¼Œå¯ä»¥ä¸´æ—¶ç¦ç”¨ TLS éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">podman login --tls-verify=<span class="literal">false</span> 192.168.31.220:5000</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ç¦ç”¨ TLS éªŒè¯ï¼Œè¿™ä¼šé™ä½å®‰å…¨æ€§ã€‚</p></blockquote><h1 id="æ–¹æ¡ˆ2-é…ç½®ä»“åº“ä¸ºä¸å®‰å…¨ä»“åº“"><a href="#æ–¹æ¡ˆ2-é…ç½®ä»“åº“ä¸ºä¸å®‰å…¨ä»“åº“" class="headerlink" title="æ–¹æ¡ˆ2: é…ç½®ä»“åº“ä¸ºä¸å®‰å…¨ä»“åº“"></a>æ–¹æ¡ˆ2: é…ç½®ä»“åº“ä¸ºä¸å®‰å…¨ä»“åº“</h1><p>ç¼–è¾‘ &#x2F;etc&#x2F;containers&#x2F;registries.confæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[registry]]</span><br><span class="line">location = <span class="string">&quot;192.168.31.220:5000&quot;</span></span><br><span class="line">insecure = <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1 id="æ–¹æ¡ˆ3ï¼šæ­£ç¡®é…ç½®-HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰"><a href="#æ–¹æ¡ˆ3ï¼šæ­£ç¡®é…ç½®-HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰" class="headerlink" title="æ–¹æ¡ˆ3ï¼šæ­£ç¡®é…ç½® HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰"></a>æ–¹æ¡ˆ3ï¼šæ­£ç¡®é…ç½® HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</h1><p>å¦‚æœè¿™æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®ä¸ºæ‚¨çš„ç§æœ‰ä»“åº“é…ç½®æ­£ç¡®çš„ HTTPSã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> podman </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨systemdéƒ¨ç½²podmançš„å®¹å™¨</title>
      <link href="/2025/07/20/back-end/use-systemd-to-deploy-podman-build-by-podman/"/>
      <url>/2025/07/20/back-end/use-systemd-to-deploy-podman-build-by-podman/</url>
      
        <content type="html"><![CDATA[<h1 id="podmançš„é—®é¢˜"><a href="#podmançš„é—®é¢˜" class="headerlink" title="podmançš„é—®é¢˜"></a>podmançš„é—®é¢˜</h1><p>podmanæ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒï¼Œæä¾›ä¸ Docker éå¸¸ç›¸ä¼¼çš„åŠŸèƒ½å¹¶ä¸éœ€è¦åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œä»»ä½•å®ˆæŠ¤è¿›ç¨‹ã€‚æ²¡æœ‰å®ˆæŠ¤è¿›ç¨‹å°±æ„å‘³ç€å¦‚æœä½ æƒ³ä½¿ç”¨podmanéƒ¨ç½²å®¹å™¨ï¼Œæ˜¯æ²¡æœ‰åŠæ³•ä½¿ç”¨ç±»ä¼¼dockerçš„æ–¹å¼å»å®ç°è‡ªåŠ¨é‡å¯åŠŸèƒ½ã€‚å¦‚æœä½¿ç”¨k8séƒ¨ç½²å®¹å™¨é‚£é—®é¢˜ä¸å¤§ï¼Œå¦‚æœå°±çº¯å®¹å™¨éƒ¨ç½²ï¼Œå¯ä»¥ä½¿ç”¨podmanç»™å‡ºçš„æ–¹æ¡ˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">podman generate systemd --<span class="built_in">help</span></span><br><span class="line">[DEPRECATED] Generate systemd units</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  Generate systemd units <span class="keyword">for</span> a pod or container.</span><br><span class="line">  The generated units can later be controlled via systemctl(1).</span><br><span class="line"></span><br><span class="line">DEPRECATED <span class="built_in">command</span>:</span><br><span class="line">It is recommended to use Quadlets <span class="keyword">for</span> running containers and pods under systemd.</span><br><span class="line"></span><br><span class="line">Please refer to podman-systemd.unit(5) <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  podman generate systemd [options] &#123;CONTAINER|POD&#125;</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">  podman generate systemd CTR</span><br><span class="line">  podman generate systemd --new --time 10 CTR</span><br><span class="line">  podman generate systemd --files --name POD</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --after stringArray         Add dependencies order to the generated unit file</span><br><span class="line">      --container-prefix string   Systemd unit name prefix <span class="keyword">for</span> containers (default <span class="string">&quot;container&quot;</span>)</span><br><span class="line">  -e, --<span class="built_in">env</span> stringArray           Set environment variables to the systemd unit files</span><br><span class="line">  -f, --files                     Generate .service files instead of printing to stdout</span><br><span class="line">      --format string             Print the created units <span class="keyword">in</span> specified format (json)</span><br><span class="line">  -n, --name                      Use container/pod names instead of IDs</span><br><span class="line">      --new                       Create a new container or pod instead of starting an existing one</span><br><span class="line">      --no-header                 Skip header generation</span><br><span class="line">      --pod-prefix string         Systemd unit name prefix <span class="keyword">for</span> pods (default <span class="string">&quot;pod&quot;</span>)</span><br><span class="line">      --requires stringArray      Similar to wants, but declares stronger requirement dependencies</span><br><span class="line">      --restart-policy string     Systemd restart-policy (default <span class="string">&quot;on-failure&quot;</span>)</span><br><span class="line">      --restart-sec uint          Systemd restart-sec</span><br><span class="line">      --separator string          Systemd unit name separator between name/id and prefix (default <span class="string">&quot;-&quot;</span>)</span><br><span class="line">      --start-timeout uint        Start <span class="built_in">timeout</span> override</span><br><span class="line">      --stop-timeout uint         Stop <span class="built_in">timeout</span> override (default 10)</span><br><span class="line">      --template                  Make it a template file and use %i and %I specifiers. Working only <span class="keyword">for</span> containers</span><br><span class="line">      --wants stringArray         Add (weak) requirement dependencies to the generated unit file</span><br></pre></td></tr></table></figure><h1 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h1><p>systemdæ˜¯Linuxç³»ç»Ÿçš„ä¸€å¥—åŸºæœ¬æ„å»ºæ¨¡å—ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ï¼Œä½œä¸ºPID 1è¿è¡Œå¹¶å¯åŠ¨ç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†ã€‚systemdæ˜¯åœ¨å¼•å¯¼æœŸé—´å¯åŠ¨çš„ç¬¬ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œä¹Ÿæ˜¯åœ¨å…³é—­æœŸé—´ç»ˆæ­¢çš„æœ€åä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨systemdå»ç›‘æ§å®¹å™¨çš„è¿è¡ŒçŠ¶æ€</p><h1 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h1><p>è¿™é‡Œä½¿ç”¨<a href="https://github.com/damingerdai/health-master">health-master</a>ä½œä¸ºä¾‹å­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–åä¸º health-master çš„å®¹å™¨ ID</span></span><br><span class="line">CONTAINER_ID=$(podman ps -a --filter <span class="string">&quot;name=health-master&quot;</span> --format <span class="string">&quot;&#123;&#123;.ID&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$CONTAINER_ID</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;æœªæ‰¾åˆ°åä¸º health-master çš„å®¹å™¨ã€‚&quot;</span> &gt;&amp;2</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰¾åˆ°å®¹å™¨ health-masterï¼ŒID ä¸º <span class="variable">$CONTAINER_ID</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æœåŠ¡æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">SERVICE_FILE_PATH=<span class="string">&quot;<span class="variable">$HOME</span>/.config/systemd/user&quot;</span></span><br><span class="line"></span><br><span class="line">SERVICE_NAME=<span class="string">&quot;podman-health-master&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ podman generate systemd åˆ›å»ºæœåŠ¡æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ­£åœ¨ç”Ÿæˆ systemd æœåŠ¡æ–‡ä»¶...&quot;</span></span><br><span class="line">podman generate systemd --name --restart-policy=on-failure -t 10 <span class="string">&quot;<span class="variable">$CONTAINER_ID</span>&quot;</span> &gt;<span class="string">&quot;<span class="variable">$SERVICE_FILE_PATH</span>/<span class="variable">$SERVICE_NAME</span>.service&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯: æ— æ³•ç”Ÿæˆ <span class="variable">$SERVICE_NAME</span> æœåŠ¡ã€‚&quot;</span> &gt;&amp;2</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®å¤ SELinux ä¸Šä¸‹æ–‡ï¼ˆå¦‚å¯ç”¨ SELinuxï¼‰</span></span><br><span class="line">restorecon -RvF <span class="string">&quot;<span class="variable">$SERVICE_FILE_PATH</span>/<span class="variable">$SERVICE_NAME</span>.service&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨ç”¨æˆ·çº§ systemd æ”¯æŒï¼ˆé¦–æ¬¡éœ€è¿è¡Œï¼‰</span></span><br><span class="line">loginctl enable-linger <span class="string">&quot;<span class="variable">$USER</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°åŠ è½½ systemd é…ç½®</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;é‡æ–°åŠ è½½ systemd é…ç½®...&quot;</span></span><br><span class="line">systemctl --user daemon-reload</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯: æ— æ³•é‡æ–°åŠ è½½ systemd é…ç½®ã€‚&quot;</span> &gt;&amp;2</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨æœåŠ¡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å¯ç”¨æœåŠ¡ <span class="variable">$SERVICE_NAME</span>...&quot;</span></span><br><span class="line">systemctl --user <span class="built_in">enable</span> --now <span class="string">&quot;<span class="variable">$SERVICE_NAME</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯: æ— æ³•å¯ç”¨æœåŠ¡ <span class="variable">$SERVICE_NAME</span>ã€‚&quot;</span> &gt;&amp;2</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å¯åŠ¨æœåŠ¡ <span class="variable">$SERVICE_NAME</span>...&quot;</span></span><br><span class="line">systemctl --user start <span class="string">&quot;<span class="variable">$SERVICE_NAME</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯: æ— æ³•å¯åŠ¨æœåŠ¡ <span class="variable">$SERVICE_NAME</span>ã€‚&quot;</span> &gt;&amp;2</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æœåŠ¡ <span class="variable">$SERVICE_NAME</span> å·²æˆåŠŸåˆ›å»ºå¹¶å¯åŠ¨ã€‚&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç®¡ç†æœåŠ¡:&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;  systemctl --user status <span class="variable">$SERVICE_NAME</span>  # æŸ¥çœ‹æœåŠ¡çŠ¶æ€&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;  systemctl --user stop <span class="variable">$SERVICE_NAME</span>    # åœæ­¢æœåŠ¡&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;  systemctl --user restart <span class="variable">$SERVICE_NAME</span> # é‡å¯æœåŠ¡&quot;</span></span><br></pre></td></tr></table></figure><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>podman generate systemdåœ¨podman 4.4çš„æ—¶å€™å°±å·²ç»å¼ƒç”¨äº†ï¼Œç›®å‰æ¨èä½¿ç”¨<a href="https://docs.podman.io/en/latest/markdown/podman-systemd.unit.5.html">Quadlet</a></p><h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h1><ol><li><a href="https://zhuanlan.zhihu.com/p/47706426">ä½¿ç”¨ Podman ä»¥é root ç”¨æˆ·èº«ä»½è¿è¡Œ Linux å®¹å™¨</a></li><li><a href="https://systemd.io/">System and Service Manager</a></li><li><a href="https://segmentfault.com/a/1190000044854265">Linux SystemdåŸºç¡€æ•™ç¨‹</a></li><li><a href="https://github.com/containers/podman/discussions/20218">How to replace the â€œpodman generate systemdâ€ command since its deprecated</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> podman </tag>
            
            <tag> å®¹å™¨ </tag>
            
            <tag> systemd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨springä¸­ä½¿ç”¨gmailå‘é€é‚®ä»¶</title>
      <link href="/2025/06/22/back-end/send-mail-with-gmail-and-spring/"/>
      <url>/2025/06/22/back-end/send-mail-with-gmail-and-spring/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”³è¯·gmailçš„åº”ç”¨ä¸“ç”¨å¯†ç "><a href="#ç”³è¯·gmailçš„åº”ç”¨ä¸“ç”¨å¯†ç " class="headerlink" title="ç”³è¯·gmailçš„åº”ç”¨ä¸“ç”¨å¯†ç "></a>ç”³è¯·gmailçš„åº”ç”¨ä¸“ç”¨å¯†ç </h1><p>é¦–å…ˆä½ éœ€è¦ä¸€ä¸ªgmailè´¦å·ï¼Œç„¶åæ‰èƒ½ç”³è¯·gmailçš„åº”ç”¨ä¸“ç”¨å¯†ç ã€‚</p><p>æƒ³è¦ç”³è¯·åº”ç”¨ä¸“ç”¨å¯†ç å¿…é¡»å¼€å¯ä¸¤æ­¥éªŒè¯ï¼š</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/back-end/gmail-two-step-vertify.png" alt="å¼€å¯ä¸¤æ­¥éªŒè¯é¡µé¢"></p><p>googleä¼¼ä¹é»˜è®¤å¹¶ä¸æƒ³è®©ç”¨æˆ·ç›´æ¥åˆ›å»ºåº”ç”¨ä¸“ç”¨å¯†ç ï¼Œéœ€è¦é€šè¿‡å³ä¸Šè§’æœç´¢æ¡†è¾“å…¥â€œåº”ç”¨ä¸“ç”¨å¯†ç â€æ‰èƒ½è¿›å…¥ç›¸å…³é¡µé¢ã€‚å¦‚æœä½¿ç”¨è‹±æ–‡é¡µé¢åˆ™æœç´¢â€œApp Passwordâ€ã€‚</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/back-end/search-app-password-gmail.png" alt="æœç´¢åº”ç”¨ä¸“ç”¨å¯†ç "></p><p>ç„¶åä½ å°±å¯ä»¥åˆ›å»ºâ€œåº”ç”¨ä¸“ç”¨å¯†ç â€</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/back-end/create-app-password-in-gmail.png" alt="åˆ›å»ºâ€œåº”ç”¨ä¸“ç”¨å¯†ç â€"></p><p>ä¿å­˜å¯†ç ï¼Œgmailä»…ä»…ä¼šæ˜¾ç¤ºè¿™ä¸€æ¬¡ã€‚</p><h1 id="ä½¿ç”¨springå‘é€é‚®ä»¶"><a href="#ä½¿ç”¨springå‘é€é‚®ä»¶" class="headerlink" title="ä½¿ç”¨springå‘é€é‚®ä»¶"></a>ä½¿ç”¨springå‘é€é‚®ä»¶</h1><p>è¿™é‡Œå®é™…ä½¿ç”¨çš„æ˜¯spring bootã€‚</p><p>å¯¼å…¥<em>spring-boot-starter-mail</em>:</p><p>å¯¹äºmavenç”¨æˆ·ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-boot-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹äºgradleç”¨æˆ·ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-mail:$&#123;spring-boot-version&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">smtp.gmail.com</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">587</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">pollardsmithal899@gmail.com</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">&#x27;your app password&#x27;</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">mail:</span></span><br><span class="line">        <span class="attr">smtp:</span></span><br><span class="line">          <span class="attr">auth:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">starttls:</span></span><br><span class="line">            <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æœ€åå¯ä»¥ä½¿ç”¨JavaMailSenderImplå‘é€é‚®ä»¶äº†ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="type">dvar</span> <span class="variable">message</span> <span class="operator">=</span> javaMailSender.createMimeMessage();</span><br><span class="line"><span class="type">var</span> <span class="variable">helper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(message, <span class="literal">true</span>);</span><br><span class="line">helper.setTo(<span class="string">&quot;mingguobin@live.com&quot;</span>);</span><br><span class="line">helper.setSubject(<span class="string">&quot;batcher support&quot;</span>);</span><br><span class="line">helper.setText(<span class="string">&quot;hello, this is batcher&quot;</span>);</span><br><span class="line">javaMailSender.send(message);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol><li><a href="https://support.google.com/accounts/answer/185833">ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ç™»å½•</a></li><li><a href="https://shallowsky.com/blog/tech/email/gmail-app-passwds.html">Gmail with an App Password</a></li><li><a href="https://www.baeldung.com/spring-email">Guide to Spring Email</a></li><li><a href="https://medium.com/tuanhdotnet/tips-for-sending-mail-from-a-spring-boot-application-using-google-as-mail-server-fcf5ab042594">ä½¿ç”¨ Google ä½œä¸ºé‚®ä»¶æœåŠ¡å™¨ä» Spring Boot åº”ç”¨ç¨‹åºå‘é€é‚®ä»¶çš„æŠ€å·§</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>noice.nvimåœ¨cmdlineä¸­çš„å…‰æ ‡è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€å‰é¢çš„bug</title>
      <link href="/2025/05/22/software/noice-nvim-cmdline-cursor-auto-scroll-to-front-bug/"/>
      <url>/2025/05/22/software/noice-nvim-cmdline-cursor-auto-scroll-to-front-bug/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€æ–°æŠŠ neovim å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬<a href="https://github.com/neovim/neovim/releases/tag/v0.11.1">0.11.1</a>,lazyvim å‡çº§åˆ°<a href="https://www.lazyvim.org/news#14x">14.x</a>ã€‚ç„¶åä¸å‡ºæ„å¤–å°±æŒ‚äº†å¥½å‡ ä¸ª pluginã€‚å…¶ä¸­ noice.nvim æ˜¯å½±å“æ¯”è¾ƒå°çš„ä½†æ¯”è¾ƒè†ˆåº”äººçš„ã€‚</p><h1 id="bug"><a href="#bug" class="headerlink" title="bug"></a>bug</h1><h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><video src="https://private-user-images.githubusercontent.com/16384908/443705864-b981f9d2-17c7-452b-8fae-916b5a2dfbf2.mov?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDc5MjM0MzEsIm5iZiI6MTc0NzkyMzEzMSwicGF0aCI6Ii8xNjM4NDkwOC80NDM3MDU4NjQtYjk4MWY5ZDItMTdjNy00NTJiLThmYWUtOTE2YjVhMmRmYmYyLm1vdj9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTA1MjIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwNTIyVDE0MTIxMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQwZTk2YmRmOTY4MDRhYjk0MDNmMzgyMzI3YjliZGNkMTQ1NmUwYWE0NDc0YTBjODA0MzMwY2ZlYjRjNWNjYTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.lhQ_rFTJKjP7UErvMKu2B4vLRQpXY7j3hYhzJ6AjWfw" data-canonical-src="https://private-user-images.githubusercontent.com/16384908/443705864-b981f9d2-17c7-452b-8fae-916b5a2dfbf2.mov?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDc5MjM0MzEsIm5iZiI6MTc0NzkyMzEzMSwicGF0aCI6Ii8xNjM4NDkwOC80NDM3MDU4NjQtYjk4MWY5ZDItMTdjNy00NTJiLThmYWUtOTE2YjVhMmRmYmYyLm1vdj9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTA1MjIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwNTIyVDE0MTIxMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQwZTk2YmRmOTY4MDRhYjk0MDNmMzgyMzI3YjliZGNkMTQ1NmUwYWE0NDc0YTBjODA0MzMwY2ZlYjRjNWNjYTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.lhQ_rFTJKjP7UErvMKu2B4vLRQpXY7j3hYhzJ6AjWfw" controls="controls" muted="muted" class="d-block rounded-bottom-2 border-top width-fit" style="max-height:640px; min-height: 200px"></video><p>å½“åœ¨cmdlineæ¨¡å¼è¾“å…¥å‘½ä»¤çš„æ—¶å€™å…‰æ ‡æ€»æ˜¯ä¼šè«åå…¶å¦™çš„æ»šåŠ¨åˆ°æœ€å‰é¢ã€‚æˆ‘æœ¬æ¥ä»¥ä¸ºæ˜¯noice.nvimçš„é—®é¢˜ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œå‘ç°åªæœ‰åœ¨itermn2çš„éå…¨å±æ¨¡å¼ä¸‹æ‰ä¼šå‡ºç°ï¼Œå…¨å±æ¨¡å¼æˆ–è€…å…¶ä»–ç»ˆç«¯æ¨¡æ‹Ÿå™¨åˆ™ä¸ä¼šå‡ºç°ç±»ä¼¼çš„é—®é¢˜ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>å¥½åœ¨<a href="https://github.com/folke/noice.nvim/issues/923#issuecomment-2898259739">bug: Cursor jumps in cmdline - 4.5.0</a>ä¸­æœ‰å°å“¥ä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ï¼Œä»–åœ¨iTerm2ä¸­ç¦ç”¨â€ç”±ä¼šè¯è§¦å‘çš„çª—å£è°ƒæ•´å¤§å°â€åŠŸèƒ½è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ˆè®¾ç½®è·¯å¾„ï¼šSettings &gt; Profiles &gt; [æˆ‘çš„é…ç½®æ–‡ä»¶] &gt; Terminal &gt; å‹¾é€‰â€Disable session-initiated window resizingâ€ï¼‰ï¼Œç„¶åå°±å¥½äº†ã€‚</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>åœ¨<a href="https://superuser.com/questions/113944/how-to-prevent-screen-from-resizing-my-terminal-in-mac-os-x">https://superuser.com/questions/113944/how-to-prevent-screen-from-resizing-my-terminal-in-mac-os-x</a>, çœ‹ä¸Šå»iterm2çš„è¿™ä¸ªbugå­˜åœ¨æŒºä¹…çš„äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> neovim </tag>
            
            <tag> iterm2 </tag>
            
            <tag> nocie.nvim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨windowsç³»ç»Ÿä¸­å¦‚ä½•ç»™rustå¦‚ä½•é…ç½®å­—èŠ‚æº</title>
      <link href="/2025/04/30/back-end/rust-bytedance-mirror-windows/"/>
      <url>/2025/04/30/back-end/rust-bytedance-mirror-windows/</url>
      
        <content type="html"><![CDATA[<h1 id="rustä¸­å¦‚ä½•é…ç½®å­—èŠ‚æº"><a href="#rustä¸­å¦‚ä½•é…ç½®å­—èŠ‚æº" class="headerlink" title="rustä¸­å¦‚ä½•é…ç½®å­—èŠ‚æº"></a>rustä¸­å¦‚ä½•é…ç½®å­—èŠ‚æº</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡çš„ç›®çš„æ˜¯åœ¨windowsä¸Šå®‰è£…æˆ–æ›´æ–°rustçš„æ—¶å€™é€šè¿‡é…ç½®å­—èŠ‚çš„å›½å†…æºæ¥æé«˜å®‰è£…&#x2F;æ›´æ–°é€Ÿåº¦ã€‚éwindowsç³»ç»Ÿå°±å¯ä»¥ç›´æ¥å‚è€ƒ<a href="https://rsproxy.cn/">rsproxy</a></p><h2 id="é…ç½®è¯´æ˜"><a href="#é…ç½®è¯´æ˜" class="headerlink" title="é…ç½®è¯´æ˜"></a>é…ç½®è¯´æ˜</h2><p>åœ¨powershellä¸­è®¾ç½® Rustup é•œåƒ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ENV:RUSTUP_DIST_SERVER</span>=<span class="string">&#x27;https://rsproxy.cn&#x27;</span></span><br><span class="line"><span class="variable">$ENV:RUSTUP_UPDATE_ROOT</span>=<span class="string">&#x27;https://rsproxy.cn/rustup&#x27;</span></span><br></pre></td></tr></table></figure><p>å®‰è£…æˆ–è€…æ›´æ–°Rust</p><p>å¦‚æœæ˜¯å®‰è£…rustï¼Œç›´æ¥ç‚¹å‡»<code>rust-init.exe</code></p><p>å¦‚æœæ˜¯æ›´æ–°rustï¼Œç›´æ¥è¿è¡Œrustup updateå‘½ä»¤</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rustup update</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®-crates-io-é•œåƒ"><a href="#è®¾ç½®-crates-io-é•œåƒ" class="headerlink" title="è®¾ç½® crates.io é•œåƒ"></a>è®¾ç½® crates.io é•œåƒ</h2><p>åœ¨å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆä»¥æˆ‘æœ¬åœ°ä¸ºä¾‹ï¼šD:\Users\damingï¼‰ä¸‹çš„<code>.cargo</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code>config</code>æ–‡ä»¶ã€‚</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[source.crates-io]</span></span><br><span class="line"><span class="attr">replace-with</span> = <span class="string">&#x27;rsproxy-sparse&#x27;</span></span><br><span class="line"><span class="section">[source.rsproxy]</span></span><br><span class="line"><span class="attr">registry</span> = <span class="string">&quot;https://rsproxy.cn/crates.io-index&quot;</span></span><br><span class="line"><span class="section">[source.rsproxy-sparse]</span></span><br><span class="line"><span class="attr">registry</span> = <span class="string">&quot;sparse+https://rsproxy.cn/index/&quot;</span></span><br><span class="line"><span class="section">[registries.rsproxy]</span></span><br><span class="line"><span class="attr">index</span> = <span class="string">&quot;https://rsproxy.cn/crates.io-index&quot;</span></span><br><span class="line"><span class="section">[net]</span></span><br><span class="line"><span class="attr">git-fetch-with-cli</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://rsproxy.cn/">rsproxy</a></li><li><a href="https://www.sunzhongwei.com/windows-11-install-rust-with-china-mirror">Windows 11 ä¸Šé€šè¿‡å›½å†…æºå®‰è£… Rust</a></li><li><a href="https://www.cnblogs.com/manqing321/p/17026725.html">rustup-init.exe å®‰è£…å¤±è´¥åŠå…¶è§£å†³æ–¹æ¡ˆ</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨apache commons-csvè¯»å†™csvæ–‡ä»¶</title>
      <link href="/2025/04/07/back-end/use-apache-commons-csv-read-write-files/"/>
      <url>/2025/04/07/back-end/use-apache-commons-csv-read-write-files/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨apache-commons-csvè¯»å†™csvæ–‡ä»¶"><a href="#ä½¿ç”¨apache-commons-csvè¯»å†™csvæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨apache commons-csvè¯»å†™csvæ–‡ä»¶"></a>ä½¿ç”¨apache commons-csvè¯»å†™csvæ–‡ä»¶</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡çš„ç›®çš„æ˜¯ä½¿ç”¨<a href="https://commons.apache.org/proper/commons-csv/">apache commons-csv</a>è¯»å†™csvæ–‡ä»¶ã€‚</p><h2 id="å®šä¹‰å®ä½“"><a href="#å®šä¹‰å®ä½“" class="headerlink" title="å®šä¹‰å®ä½“"></a>å®šä¹‰å®ä½“</h2><p>Workeræ˜¯é€šè¿‡aiéšæœºå®šä¹‰çš„ä¸€ä¸ªjavaç±»å‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String employeeNumber;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> version;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String department;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String position;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDate hireDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String phoneNumber;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡<a href="https://github.com/DiUS/java-faker">faker</a>éšæœºç”ŸæˆWorkerç±»å‹çš„å¯¹è±¡ã€‚å…·ä½“å®ç°å¯ä»¥æŸ¥çœ‹ä¸‹æ–‡ã€‚</p><h2 id="Apache-Commons-CSV"><a href="#Apache-Commons-CSV" class="headerlink" title="Apache Commons CSV"></a>Apache Commons CSV</h2><p>Commons CSV èƒ½å¤Ÿè¯»å†™å¤šç§å˜ä½“çš„é€—å·åˆ†éš”å€¼ï¼ˆCSVï¼‰æ ¼å¼æ–‡ä»¶ï¼Œç”±Apacheè´Ÿè´£å¼€å‘ã€‚</p><p>ä½¿ç”¨mavenå¼•å…¥ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-csv<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.14.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨groovy gradleå¼•å…¥ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.apache.commons:commons-csv:1.14.0&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨kotlinï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">&quot;org.apache.commons:commons-csv:1.14.0&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="å†™csvæ–‡ä»¶"><a href="#å†™csvæ–‡ä»¶" class="headerlink" title="å†™csvæ–‡ä»¶"></a>å†™csvæ–‡ä»¶</h3><p>å…ˆåˆ›å»ºå¥½æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">path</span> <span class="operator">=</span> nfsRootPath + File.separator + <span class="string">&quot;workers_&quot;</span> + DateUtils.getYearMonthDay() + <span class="string">&quot;.csv&quot;</span>;</span><br><span class="line"><span class="type">var</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line"><span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">    file.createNewFile();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nfsRootPathä¸º<code>$&#123;user.dir&#125;/nfs-root</code>ï¼Œ DateUtils.getYearMonthDay()è¡¨ç¤ºè·å–å½“å‰å¹´æœˆæ—¥ï¼ˆyyyy-MM-ddï¼‰ã€‚</p><p>CSVFormatæ˜¯<code>apache commons csv</code>ä¸­ç”¨äºæŒ‡å®šCSVæ–‡ä»¶è§£æåŠå†™å…¥çš„æ ¼å¼è§„èŒƒã€‚</p><p><code>commons csv</code>å†…ç½®äº†12ç§æ ¼å¼çš„æ”¯æŒï¼š</p><ol><li>DEFAULT: æ ‡å‡†é€—å·åˆ†éš”å€¼ï¼ˆCSVï¼‰æ ¼å¼ï¼Œéµå¾ª<a href="https://commons.apache.org/proper/commons-csv/apidocs/org/apache/commons/csv/CSVFormat.html#RFC4180">RFC4180è§„èŒƒ</a>ï¼Œä½†å…è®¸ç©ºè¡Œå­˜åœ¨</li><li>EXCEL: <a href="https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba">å¾®è½¯Excelæ–‡ä»¶æ ¼å¼</a>ï¼ˆä½¿ç”¨é€—å·ä½œä¸ºå€¼åˆ†éš”ç¬¦ï¼‰</li><li>INFORMIX_UNLOAD: <a href="https://www.ibm.com/docs/en/informix-servers/14.10.0?topic=statements-unload-statement">Informix é»˜è®¤ CSV å¯¼å‡ºæ ¼å¼</a>ï¼ˆé€šè¿‡ UNLOAD TO file_name æ“ä½œç”Ÿæˆï¼‰</li><li>INFORMIX_UNLOAD_CSV: <a href="https://www.ibm.com/docs/en/informix-servers/14.10?topic=statements-unload-statement">Informix é»˜è®¤ CSV å¯¼å‡ºæ ¼å¼</a>ï¼ˆé€šè¿‡ UNLOAD TO file_name æ“ä½œç”Ÿæˆï¼Œç¦ç”¨è½¬ä¹‰åŠŸèƒ½ï¼‰</li><li>MONGODB_CSV: MongoDB é»˜è®¤ CSV æ ¼å¼ï¼ˆé€šè¿‡ mongoexport å‘½ä»¤å¯¼å‡ºä½¿ç”¨ï¼‰</li><li>MONGODB_TSV: MongoDB é»˜è®¤ TSV æ ¼å¼ï¼ˆé€šè¿‡ mongoexport å‘½ä»¤å¯¼å‡ºä½¿ç”¨ï¼‰</li><li>MYSQL:<a href="https://dev.mysql.com/doc/refman/8.0/en/mysqldump-delimited-text.html">MySQL</a> é»˜è®¤æ•°æ®æ ¼å¼ï¼ˆé€šè¿‡ SELECT INTO OUTFILE å’Œ LOAD DATA INFILE å‘½ä»¤ä½¿ç”¨ï¼‰</li><li>ORACLE: <a href="https://docs.oracle.com/en/database/oracle/oracle-database/23/sutil/oracle-sql-loader-control-file-contents.html#GUID-D1762699-8154-40F6-90DE-EFB8EB6A9AB0">Oracle</a> é»˜è®¤æ•°æ®æ ¼å¼ï¼ˆé€šè¿‡ SQL*Loader å·¥å…·ä½¿ç”¨ï¼‰</li><li>POSTGRESQL_CSV: <a href="https://www.postgresql.org/docs/current/static/sql-copy.html">PostgreSQLé»˜è®¤ CSV æ ¼å¼</a>ï¼ˆé€šè¿‡ COPY å‘½ä»¤æ“ä½œä½¿ç”¨ï¼‰</li><li>POSTGRESQL_TEXT: <a href="https://www.postgresql.org/docs/current/static/sql-copy.html">PostgreSQLé»˜è®¤æ–‡æœ¬æ ¼å¼</a>ï¼ˆé€šè¿‡ COPY å‘½ä»¤ä½¿ç”¨ï¼‰</li><li>RFC4180: <a href="https://tools.ietf.org/html/rfc4180">RFC 4180</a> æ ‡å‡†å®šä¹‰çš„é€—å·åˆ†éš”å€¼ï¼ˆCSVï¼‰æ ¼å¼</li><li>TDF: <a href="https://en.wikipedia.org/wiki/Tab-separated_values">åˆ¶è¡¨ç¬¦åˆ†éš”æ ¼å¼</a>ï¼ˆTDFï¼‰</li></ol><p>è¿™é‡Œä½¿ç”¨DEFAULTçš„csv formatï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;</span><br><span class="line">    <span class="string">&quot;employee_number&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>,</span><br><span class="line">    <span class="string">&quot;last_name&quot;</span>,</span><br><span class="line">    <span class="string">&quot;first_name&quot;</span>,</span><br><span class="line">    <span class="string">&quot;gender&quot;</span>,</span><br><span class="line">    <span class="string">&quot;department&quot;</span>,</span><br><span class="line">    <span class="string">&quot;position&quot;</span>,</span><br><span class="line">    <span class="string">&quot;hire_date&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone_number&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">var</span> <span class="variable">csvFormat</span> <span class="operator">=</span> CSVFormat.DEFAULT.builder().setHeader(headers).get();</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨BufferedWriterå’ŒCSVPrinterå°†Workerå¯¹è±¡å†™å…¥csvæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">var</span> <span class="variable">fw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileWriter</span>(path); <span class="type">var</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(fw)) &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">csvPrinter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CSVPrinter</span>(bw, csvFormat);</span><br><span class="line">    <span class="type">var</span> <span class="variable">format</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">    <span class="type">var</span> <span class="variable">workers</span> <span class="operator">=</span> WorkerMockFactory.createWorkers(<span class="number">100</span>);</span><br><span class="line">    workers.forEach(worker -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            csvPrinter.printRecord(</span><br><span class="line">                worker.getEmployeeNumber(),</span><br><span class="line">                worker.getVersion(),</span><br><span class="line">                worker.getLastName(),</span><br><span class="line">                worker.getFirstName(),</span><br><span class="line">                worker.getGender(),</span><br><span class="line">                worker.getDepartment(),</span><br><span class="line">                worker.getPosition(),</span><br><span class="line">                worker.getHireDate().format(format),</span><br><span class="line">                worker.getEmail(),</span><br><span class="line">                worker.getPhoneNumber(),</span><br><span class="line">                worker.getStatus()</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    <span class="keyword">throw</span> e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¯»csvæ–‡ä»¶"><a href="#è¯»csvæ–‡ä»¶" class="headerlink" title="è¯»csvæ–‡ä»¶"></a>è¯»csvæ–‡ä»¶</h3><p>CSVFormaté™¤äº†å¯ä»¥ç”¨äºå†™csvæ–‡ä»¶ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨äºè¯»csvæ–‡ä»¶ã€‚</p><p>å…ˆè·å–æ–‡ä»¶è·¯å¾„å¹¶åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="type">var</span> <span class="variable">path</span> <span class="operator">=</span> nfsRootPath + File.separator + <span class="string">&quot;workers_20250406.csv&quot;</span>;</span><br><span class="line"><span class="type">var</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line"><span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>CSVFormatæä¾›parseæ–¹æ³•è¯»å–å®ç°ä»»æ„å®ç°Readeræ¥å£çš„å¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨FileReaderã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">var</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(path)) &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">records</span> <span class="operator">=</span> csvFormat.parse(in);</span><br><span class="line">    <span class="type">var</span> <span class="variable">format</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">    <span class="type">var</span> <span class="variable">workers</span> <span class="operator">=</span> records.stream().map(record -&gt; &#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Worker</span>();</span><br><span class="line">        worker.setEmployeeNumber(record.get(<span class="string">&quot;employee_number&quot;</span>));</span><br><span class="line">        <span class="type">var</span> <span class="variable">version</span> <span class="operator">=</span> record.get(<span class="string">&quot;version&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            worker.setVersion(Integer.parseInt(version));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NumberFormatException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        worker.setLastName(record.get(<span class="string">&quot;last_name&quot;</span>));</span><br><span class="line">        worker.setFirstName(record.get(<span class="string">&quot;first_name&quot;</span>));</span><br><span class="line">        worker.setGender(record.get(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">        worker.setDepartment(record.get(<span class="string">&quot;department&quot;</span>));</span><br><span class="line">        worker.setPosition(record.get(<span class="string">&quot;position&quot;</span>));</span><br><span class="line">        <span class="type">var</span> <span class="variable">hiredDate</span> <span class="operator">=</span> record.get(<span class="string">&quot;hire_date&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(hiredDate) &amp;&amp; StringUtils.isNoneBlank(hiredDate)) &#123;</span><br><span class="line">            worker.setHireDate(LocalDate.parse(hiredDate, format));</span><br><span class="line">        &#125;</span><br><span class="line">        worker.setEmail(record.get(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">        worker.setPhoneNumber(record.get(<span class="string">&quot;phone_number&quot;</span>));</span><br><span class="line">        worker.setStatus(record.get(<span class="string">&quot;status&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> worker;</span><br><span class="line">    &#125;).toList();</span><br><span class="line">    System.out.println(<span class="string">&quot;workers sum: &quot;</span> + workers.size());</span><br><span class="line">    workers.forEach(System.out::println);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨åˆ†è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">com.github.damingerdai.batcher.pojo.Worker@7b7b1448[id=&lt;null&gt;,employeeNumber=WK4745-87688,version=1,lastName=Schroeder,firstName=Anisha,gender=female,department=DevOps,position=Architect,hireDate=2021-06-30,email=anisha.schroeder@prohaska.net,phoneNumber=18878513958,status=probation]</span><br><span class="line">com.github.damingerdai.batcher.pojo.Worker@14624acc[id=&lt;null&gt;,employeeNumber=WK0980-74595,version=3,lastName=Schmidt,firstName=Isaias,gender=female,department=R&amp;D,position=Junior Developer,hireDate=2021-10-19,email=isaias.schmidt@gottlieb.biz,phoneNumber=14535433286,status=resigned]</span><br></pre></td></tr></table></figure><h2 id="Faker"><a href="#Faker" class="headerlink" title="Faker"></a>Faker</h2><p>fakerç§»æ¤è‡ªRubyçš„faker gemï¼ˆä»¥åŠPerlçš„Data::Fakeræ¨¡å—ï¼‰ï¼Œèƒ½å¤Ÿç”Ÿæˆä»¿çœŸæ•°æ®ã€‚</p><p>é’ˆå¯¹ä¸­å›½æ ¼å¼çš„æ‰‹æœºå·ç ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç éšæœºç”Ÿæˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChinaPhoneNumberGenerator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸­å›½è¿è¥å•†å·æ®µï¼ˆ2023å¹´æœ€æ–°ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; PREFIXES = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;130&quot;</span>, <span class="string">&quot;131&quot;</span>, <span class="string">&quot;132&quot;</span>, <span class="string">&quot;133&quot;</span>, <span class="string">&quot;134&quot;</span>, <span class="string">&quot;135&quot;</span>, <span class="string">&quot;136&quot;</span>, <span class="string">&quot;137&quot;</span>, <span class="string">&quot;138&quot;</span>, <span class="string">&quot;139&quot;</span>,</span><br><span class="line">            <span class="string">&quot;145&quot;</span>, <span class="string">&quot;146&quot;</span>, <span class="string">&quot;147&quot;</span>, <span class="string">&quot;148&quot;</span>, <span class="string">&quot;149&quot;</span>,</span><br><span class="line">            <span class="string">&quot;150&quot;</span>, <span class="string">&quot;151&quot;</span>, <span class="string">&quot;152&quot;</span>, <span class="string">&quot;153&quot;</span>, <span class="string">&quot;155&quot;</span>, <span class="string">&quot;156&quot;</span>, <span class="string">&quot;157&quot;</span>, <span class="string">&quot;158&quot;</span>, <span class="string">&quot;159&quot;</span>,</span><br><span class="line">            <span class="string">&quot;165&quot;</span>, <span class="string">&quot;166&quot;</span>, <span class="string">&quot;167&quot;</span>, <span class="string">&quot;168&quot;</span>, <span class="string">&quot;169&quot;</span>,</span><br><span class="line">            <span class="string">&quot;170&quot;</span>, <span class="string">&quot;171&quot;</span>, <span class="string">&quot;172&quot;</span>, <span class="string">&quot;173&quot;</span>, <span class="string">&quot;174&quot;</span>, <span class="string">&quot;175&quot;</span>, <span class="string">&quot;176&quot;</span>, <span class="string">&quot;177&quot;</span>, <span class="string">&quot;178&quot;</span>, <span class="string">&quot;179&quot;</span>,</span><br><span class="line">            <span class="string">&quot;180&quot;</span>, <span class="string">&quot;181&quot;</span>, <span class="string">&quot;182&quot;</span>, <span class="string">&quot;183&quot;</span>, <span class="string">&quot;184&quot;</span>, <span class="string">&quot;185&quot;</span>, <span class="string">&quot;186&quot;</span>, <span class="string">&quot;187&quot;</span>, <span class="string">&quot;188&quot;</span>, <span class="string">&quot;189&quot;</span>,</span><br><span class="line">            <span class="string">&quot;190&quot;</span>, <span class="string">&quot;191&quot;</span>, <span class="string">&quot;192&quot;</span>, <span class="string">&quot;193&quot;</span>, <span class="string">&quot;194&quot;</span>, <span class="string">&quot;195&quot;</span>, <span class="string">&quot;196&quot;</span>, <span class="string">&quot;197&quot;</span>, <span class="string">&quot;198&quot;</span>, <span class="string">&quot;199&quot;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸¸è§æ˜¾ç¤ºæ ¼å¼ï¼ˆéšæœºé€‰æ‹©ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; FORMATS = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;%s%s%s&quot;</span>          <span class="comment">// 13800138000</span></span><br><span class="line">            <span class="string">&quot;%s-%s-%s&quot;</span>,        <span class="comment">// 138-0013-8000</span></span><br><span class="line">            <span class="string">&quot;%s %s %s&quot;</span>,        <span class="comment">// 138 0013 8000</span></span><br><span class="line">            <span class="string">&quot;+86 %s%s%s&quot;</span>,      <span class="comment">// +86 13800138000</span></span><br><span class="line">            <span class="string">&quot;+86-%s-%s-%s&quot;</span>,    <span class="comment">// +86-138-0013-8000</span></span><br><span class="line">            <span class="string">&quot;0086 %s%s%s&quot;</span>      <span class="comment">// 0086 13800138000</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Faker</span> <span class="variable">faker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Faker</span>(Locale.CHINA);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”ŸæˆåŸºç¡€å·ç éƒ¨åˆ†</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> PREFIXES.get(faker.random().nextInt(PREFIXES.size()));</span><br><span class="line">        <span class="type">String</span> <span class="variable">middle</span> <span class="operator">=</span> String.format(<span class="string">&quot;%04d&quot;</span>, faker.number().numberBetween(<span class="number">0</span>, <span class="number">9999</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">tail</span> <span class="operator">=</span> String.format(<span class="string">&quot;%04d&quot;</span>, faker.number().numberBetween(<span class="number">0</span>, <span class="number">9999</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éšæœºé€‰æ‹©æ˜¾ç¤ºæ ¼å¼</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">format</span> <span class="operator">=</span> FORMATS.get(faker.random().nextInt(FORMATS.size()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆæœ€ç»ˆå·ç </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> String.format(format, prefix, middle, tail);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// äºŒæ¬¡éªŒè¯ç¡®ä¿æœ‰æ•ˆæ€§</span></span><br><span class="line">        <span class="keyword">return</span> validate(phone) ? phone : generate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸¥æ ¼éªŒè¯æ‰‹æœºå·é€»è¾‘</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">validate</span><span class="params">(String phone)</span> &#123;</span><br><span class="line">        <span class="comment">// ç»Ÿä¸€å»é™¤æ ¼å¼ç¬¦å·</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">cleanNumber</span> <span class="operator">=</span> phone.replaceAll(<span class="string">&quot;[+\\- ()]&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éªŒè¯é•¿åº¦å’Œå¼€å¤´</span></span><br><span class="line">        <span class="keyword">if</span> (cleanNumber.startsWith(<span class="string">&quot;86&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> cleanNumber.length() == <span class="number">13</span> &amp;&amp; cleanNumber.matches(<span class="string">&quot;^861[3-9]\\d&#123;9&#125;$&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cleanNumber.startsWith(<span class="string">&quot;0086&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> cleanNumber.length() == <span class="number">14</span> &amp;&amp; cleanNumber.matches(<span class="string">&quot;^00861[3-9]\\d&#123;9&#125;$&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cleanNumber.length() == <span class="number">11</span> &amp;&amp; cleanNumber.matches(<span class="string">&quot;^1[3-9]\\d&#123;9&#125;$&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšæœºç”ŸæˆWorkerçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkerMockFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Faker</span> <span class="variable">faker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Faker</span>(Locale.ENGLISH);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">FakeValuesService</span> <span class="variable">fakeValues</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FakeValuesService</span>(</span><br><span class="line">            Locale.of(<span class="string">&quot;en-US&quot;</span>), <span class="keyword">new</span> <span class="title class_">RandomService</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¢„å®šä¹‰æšä¸¾é€‰é¡¹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; GENDERS = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;male&quot;</span>, <span class="string">&quot;female&quot;</span>, <span class="string">&quot;other&quot;</span>, <span class="string">&quot;not_specified&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; STATUSES = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;active&quot;</span>, <span class="string">&quot;resigned&quot;</span>, <span class="string">&quot;on_leave&quot;</span>, <span class="string">&quot;probation&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éƒ¨é—¨ä¸èŒä½æ˜ å°„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; TECH_DEPTS = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;Engineering&quot;</span>, <span class="string">&quot;R&amp;D&quot;</span>, <span class="string">&quot;DevOps&quot;</span>, <span class="string">&quot;QA&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; TECH_POSITIONS = Arrays.asList(</span><br><span class="line">            <span class="string">&quot;Junior Developer&quot;</span>, <span class="string">&quot;Senior Developer&quot;</span>, <span class="string">&quot;Tech Lead&quot;</span>, <span class="string">&quot;Architect&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Worker <span class="title function_">createWorker</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Worker</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Worker</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆç¬¦åˆä¸šåŠ¡è§„åˆ™çš„å·¥å· (ç¤ºä¾‹: WK2024-00123)</span></span><br><span class="line">        worker.setEmployeeNumber(fakeValues.bothify(<span class="string">&quot;WK####-#####&quot;</span>).replaceAll(<span class="string">&quot;#&quot;</span>, <span class="string">&quot;0&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ„å»ºè€…æ¨¡å¼è®¾ç½®å­—æ®µ</span></span><br><span class="line">        worker.setVersion(faker.random().nextInt(<span class="number">1</span>, <span class="number">5</span>)); <span class="comment">// æ¨¡æ‹Ÿå†å²ç‰ˆæœ¬</span></span><br><span class="line">        worker.setLastName(faker.name().lastName());</span><br><span class="line">        worker.setFirstName(faker.name().firstName());</span><br><span class="line">        worker.setGender(GENDERS.get(faker.random().nextInt(GENDERS.size())));</span><br><span class="line">        worker.setDepartment(faker.options().nextElement(TECH_DEPTS));</span><br><span class="line">        worker.setPosition(faker.options().nextElement(TECH_POSITIONS));</span><br><span class="line">        worker.setHireDate(generateHireDate());</span><br><span class="line">        worker.setEmail(generateCorporateEmail(worker));</span><br><span class="line">        worker.setPhoneNumber(ChinaPhoneNumberGenerator.generate()); <span class="comment">// ç»Ÿä¸€å·ç æ ¼å¼</span></span><br><span class="line">        worker.setStatus(faker.options().nextElement(STATUSES));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> worker;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LocalDate <span class="title function_">generateHireDate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> faker.date().past(<span class="number">365</span> * <span class="number">5</span>, TimeUnit.DAYS)</span><br><span class="line">                .toInstant().atZone(ZoneId.systemDefault())</span><br><span class="line">                .toLocalDate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">generateCorporateEmail</span><span class="params">(Worker worker)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;%s.%s@%s&quot;</span>,</span><br><span class="line">                worker.getFirstName().toLowerCase().replaceAll(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">                worker.getLastName().toLowerCase().replaceAll(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">                faker.internet().domainName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">validate</span><span class="params">(Worker worker)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> worker.getEmail().matches(<span class="string">&quot;^[a-z.]+@[a-z]+\\.[a-z]&#123;2,&#125;$&quot;</span>)</span><br><span class="line">                &amp;&amp; worker.getEmployeeNumber().startsWith(<span class="string">&quot;WK&quot;</span>)</span><br><span class="line">                &amp;&amp; worker.getHireDate().isAfter(LocalDate.of(<span class="number">2010</span>, <span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰¹é‡ç”Ÿæˆæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Worker&gt; <span class="title function_">createWorkers</span><span class="params">(<span class="type">int</span> count)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> IntStream.range(<span class="number">0</span>, count)</span><br><span class="line">                .mapToObj(i -&gt; createWorker())</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤§é‡æ•°æ®ï¼ˆè¶…è¿‡10ä¸‡ï¼‰æ‰¹é‡ç”Ÿæˆæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Worker&gt; <span class="title function_">createWorkersParallel</span><span class="params">(<span class="type">int</span> count)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> IntStream.range(<span class="number">0</span>, count)</span><br><span class="line">                .parallel()</span><br><span class="line">                .mapToObj(i -&gt; createWorker())</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h2><ol><li><a href="https://github.com/DiUS/java-faker">faker repo</a></li><li><a href="https://commons.apache.org/proper/commons-csv/">apache commons csv</a></li><li><a href="https://mvnrepository.com/artifact/org.apache.commons/commons-csv">commons-csv mvaen repository.</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> commons-csv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨k3sä¸­é…ç½®ç§æœ‰é•œåƒä»“åº“</title>
      <link href="/2025/03/06/software/connect-to-private-docker-registry-in-k3s/"/>
      <url>/2025/03/06/software/connect-to-private-docker-registry-in-k3s/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡çš„ç›®çš„æ˜¯å®ç°åœ¨k3sä¸­å¯ä»¥è®¿é—®ä½¿ç”¨dockeréƒ¨ç½²<a href="https://hub.docker.com/_/registry">registry</a>ã€‚</p><h1 id="éƒ¨ç½²registry"><a href="#éƒ¨ç½²registry" class="headerlink" title="éƒ¨ç½²registry"></a>éƒ¨ç½²registry</h1><p>å¯åŠ¨ä¸€ä¸ªä¸€æ¬¡æ€§å®¹å™¨ç”¨äºåˆ›å»ºè´¦å·å¯†ç .å¯†ç æ–‡ä»¶è·¯å¾„ä»¥&#x2F;root&#x2F;registry&#x2F;htpasswdä¸ºä¾‹,è´¦å·å¯†ç ä»¥adminå’Œ12345678ä¸ºä¾‹.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> --entrypoint \</span><br><span class="line">    htpasswd httpd:2 -Bbn \</span><br><span class="line">    admin 12345678 &gt; ./registry/htpasswd</span><br></pre></td></tr></table></figure><p>ç¼–å†™docker composeçš„yamlæ–‡ä»¶ç”¨äºå¯åŠ¨registryã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry:2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">registry</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="comment"># - ./config.yml:/etc/docker/registry/config.yml</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./htpasswd:/auth/htpasswd</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./registry:/var/lib/registry</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5000</span><span class="string">:5000</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_AUTH=htpasswd</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_AUTH_HTPASSWD_REALM=Registry</span> <span class="string">Realm</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_STORAGE_DELETE_ENABLED=true</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">registry-network</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">host.docker.internal:host-gateway</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">registry-network:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>resistryé»˜è®¤æä¾›web uiä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="https://hub.docker.com/r/joxit/docker-registry-ui">docker-registry-ui</a>éƒ¨ç½²ä¸€ä¸ªweb uiã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">registry-ui:</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">joxit/docker-registry-ui:main</span></span><br><span class="line"><span class="attr">container_name:</span> <span class="string">registry-ui</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">5001</span><span class="string">:80</span></span><br><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SINGLE_REGISTRY=true</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">REGISTRY_TITLE=Docker</span> <span class="string">Registry</span> <span class="string">UI</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">DELETE_IMAGES=true</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SHOW_CONTENT_DIGEST=true</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">NGINX_PROXY_PASS_URL=http://registry:5000</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SHOW_CATALOG_NB_TAGS=true</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">CATALOG_MIN_BRANCHES=1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">CATALOG_MAX_BRANCHES=1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">TAGLIST_PAGE_SIZE=100</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">REGISTRY_SECURED=false</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">CATALOG_ELEMENTS_LIMIT=1000</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">registry-network</span></span><br><span class="line"><span class="attr">extra_hosts:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">host.docker.internal:host-gateway</span></span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡Â·docker compose up -dÂ·å°±å¯ä»¥å¯åŠ¨äº†ã€‚</p><h1 id="dockerè¿æ¥ç§æœ‰ä»“åº“"><a href="#dockerè¿æ¥ç§æœ‰ä»“åº“" class="headerlink" title="dockerè¿æ¥ç§æœ‰ä»“åº“"></a>dockerè¿æ¥ç§æœ‰ä»“åº“</h1><p>dockeré»˜è®¤ä¸æ”¯æŒhttpåè®®ï¼Œéœ€è¦é¢å¤–é…ç½®, é€šè¿‡åœ¨&#x2F;etc&#x2F;docker&#x2F;daemon.json ä¸­å°†ç§æœ‰ä»“åº“åœ°å€æ·»åŠ è¿›å…¥å°±å¥½äº†ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;insecure-registries&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;192.168.31.220:5000&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¯ä»¥é€šè¿‡docker loginå»ç™»é™†ç§æœ‰ä»“åº“ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login 192.168.31.220:5000</span><br></pre></td></tr></table></figure><h1 id="k3sè¿æ¥ç§æœ‰ä»“åº“"><a href="#k3sè¿æ¥ç§æœ‰ä»“åº“" class="headerlink" title="k3sè¿æ¥ç§æœ‰ä»“åº“"></a>k3sè¿æ¥ç§æœ‰ä»“åº“</h1><p>å¦‚æœk3sä½¿ç”¨dockerè¿è¡Œæ—¶å°±ä¸éœ€è¦é¢å¤–çš„æ“ä½œäº†ï¼Œå°±å¯ä»¥æ“ä½œäº†åº”è¯¥ï¼ˆæ²¡è¯•è¿‡ï¼‰</p><p>å¦‚æœk3sä½¿ç”¨containerdè¿è¡Œæ—¶ï¼Œéœ€è¦è‡ªè¡Œé…ç½®&#x2F;var&#x2F;lib&#x2F;rancher&#x2F;k3s&#x2F;agent&#x2F;etc&#x2F;containerd&#x2F;config.tomlã€‚</p><p>ä¸€èˆ¬è€Œè¨€ä¸é¼“åŠ±ç›´æ¥ä¿®æ”¹&#x2F;var&#x2F;lib&#x2F;rancher&#x2F;k3s&#x2F;agent&#x2F;etc&#x2F;containerd&#x2F;config.tomlæ–‡ä»¶ï¼Œè€Œæ˜¯é€šè¿‡ &#x2F;etc&#x2F;rancher&#x2F;k3s&#x2F;registries.yamlè®©k3sè‡ªè¡Œç”Ÿæˆcontainerdçš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mirrors:</span><br><span class="line">  <span class="string">&quot;192.168.31.220:5000&quot;</span>:</span><br><span class="line">    endpoint:</span><br><span class="line">      - <span class="string">&quot;http://192.168.31.220:5000&quot;</span></span><br><span class="line"></span><br><span class="line">configs:</span><br><span class="line">  <span class="string">&quot;192.168.31.220:5000&quot;</span>:</span><br><span class="line">    auth:</span><br><span class="line">      username: admin</span><br><span class="line">      password: password</span><br><span class="line">    tls:</span><br><span class="line">      insecure_skip_verify: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>mirrorså®šä¹‰é•œåƒä»“åº“çš„é•œåƒè§„åˆ™ï¼ˆmirrorï¼‰ï¼Œç”¨äºæŒ‡å®šå¦‚ä½•è®¿é—®ç‰¹å®šçš„ç§æœ‰ä»“åº“ã€‚å½“å®¹å™¨è¿è¡Œæ—¶å°è¯•æ‹‰å–é•œåƒæ—¶ï¼Œä¼šæ ¹æ® mirrors çš„é…ç½®å†³å®šä»å“ªä¸ªåœ°å€æ‹‰å–ã€‚<br>configså®šä¹‰ç§æœ‰ä»“åº“çš„è®¤è¯å’Œ TLS é…ç½®ã€‚å½“è®¿é—®ç§æœ‰ä»“åº“æ—¶ï¼Œå®¹å™¨è¿è¡Œæ—¶ä¼šä½¿ç”¨è¿™é‡Œé…ç½®çš„ç”¨æˆ·åã€å¯†ç å’Œ TLS è®¾ç½®ã€‚</p><p>æœ‰çš„æ—¶å€™k3sä¸ä¸€å®šèƒ½å¤Ÿå®æ—¶è‡ªåŠ¨ç›‘å¬registries.yamlçš„æ”¹åŠ¨ï¼Œæ‰€ä»¥æœ€å¥½çš„æ–¹å¼è¿˜æ˜¯é‡å¯k3s:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart k3s-agent   <span class="comment"># worker èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">sudo systemctl restart k3s         <span class="comment"># server èŠ‚ç‚¹</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªpodå»æµ‹è¯•k3sæ˜¯å¦æ­£å¸¸è®¿é—®ç§æœ‰ä»“åº“ã€‚</p><p>è¿™é‡Œæ¨èä½¿ç”¨crictlå»ç›´æ¥æ‹‰å–ç§æœ‰ä»“åº“çš„é•œåƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo crictl pull 192.168.31.220:5000/hoteler-api:07e1b87e82ccfc49e5bee7d3d88cf2c304376056</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://blog.csdn.net/tergou/article/details/120422445">Docker login ç™»å½•ç§æœï¼ŒæŠ¥é”™ï¼› http: server gave HTTP response to HTTPS client</a></li><li><a href="https://docs.k3s.io/zh/installation/private-registry">Private Registry Configuration</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k3s </tag>
            
            <tag> docker registry </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨armbianä¸Šä½¿ç”¨snapå®‰è£…neovim</title>
      <link href="/2025/02/14/software/install/use-snap-to-install-neovim-on-armbian/"/>
      <url>/2025/02/14/software/install/use-snap-to-install-neovim-on-armbian/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æœ€è¿‘æäº†ä¸€å°armbiançš„æœºå­ï¼Œæƒ³åœ¨ä¸Šé¢å®‰è£…neovimï¼Œä½†æ˜¯å‘ç°aptä¸Šçš„nvimç‰ˆæœ¬å¤ªä½äº†ï¼Œåªæœ‰0.4.0å¥½åƒã€‚ç»è¿‡ä¸€ç•ªçš„æœç´¢ï¼Œå‘ç°Snapså¯ä»¥æ»¡è¶³æˆ‘çš„è¦æ±‚ã€‚</p><h1 id="Snapsä»‹ç»"><a href="#Snapsä»‹ç»" class="headerlink" title="Snapsä»‹ç»"></a>Snapsä»‹ç»</h1><p>Snapsæ˜¯ç”±Canonicalæä¾›çš„è·¨åˆ†å‘åŒ…ç®¡ç†ç³»ç»Ÿçš„å·¥å…·.Snaps åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªä¸å…¶ä¾èµ–é¡¹å’Œåº“ä¸€èµ·ç¼–è¯‘çš„åº”ç”¨ç¨‹åºâ€”â€”ä¸ºåº”ç”¨ç¨‹åºè¿è¡Œæä¾›äº†ä¸€ä¸ªæ²™ç›’ç¯å¢ƒã€‚å®ƒä»¬å®‰è£…èµ·æ¥æ›´å®¹æ˜“ã€æ›´å¿«æ·ï¼Œå¯ä»¥æ¥æ”¶æœ€æ–°æ›´æ–°ï¼Œå¹¶ä¸”ä¸å—æ“ä½œç³»ç»Ÿå’Œå…¶ä»–åº”ç”¨ç¨‹åºçš„é™åˆ¶ã€‚</p><h1 id="å®‰è£…Snaps"><a href="#å®‰è£…Snaps" class="headerlink" title="å®‰è£…Snaps"></a>å®‰è£…Snaps</h1><p>ä½¿ç”¨aptå®‰è£…Snapï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install snapd</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…neovim"><a href="#å®‰è£…neovim" class="headerlink" title="å®‰è£…neovim"></a>å®‰è£…neovim</h1><p>ä½¿ç”¨snapå®‰è£…neovim:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo snap install --classic nvim</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ä¸€ä¸‹noevimçš„ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvim --version</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NVIM v0.10.4</span><br><span class="line">Build <span class="built_in">type</span>: RelWithDebInfo</span><br><span class="line">LuaJIT 2.1.1713484068</span><br><span class="line">Run <span class="string">&quot;nvim -V1 -v&quot;</span> <span class="keyword">for</span> more info</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://www.cnblogs.com/pipci/p/16109561.html">å¦‚ä½•åœ¨å„ç§ Linux å‘è¡Œç‰ˆä¸­å®‰è£…å’Œä½¿ç”¨ Snap</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> neovim </tag>
            
            <tag> snap </tag>
            
            <tag> armbian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨k8sä¸­å¦‚ä½•å¼ºåˆ¶åˆ é™¤å¤„äºTerminatingçŠ¶æ€çš„namesapce</title>
      <link href="/2025/02/13/back-end/how-to-forcefully-delete-a-namespace-that-is-stuck-in-the-Terminating-state/"/>
      <url>/2025/02/13/back-end/how-to-forcefully-delete-a-namespace-that-is-stuck-in-the-Terminating-state/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åœ¨k3sä¸­åˆ é™¤ä¸€ä¸ªnamespaceååˆ†ç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªå‘½ä»¤çš„äº‹å„¿ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete ns <span class="variable">$&#123;namespace&#125;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¯èƒ½å­˜åœ¨åˆ é™¤å¤±è´¥æˆ–è€…namespaceä¸€ç›´å¤„äºTerminatingçŠ¶æ€çš„è¯ï¼Œé‚£ä¹ˆä¸Šé¢çš„å‘½ä»¤å¯èƒ½è¡Œä¸é€šã€‚<br>è¿™é‡Œä»‹ç»ä¸¤ç§å®ç”¨çš„è§£å†³æ–¹æ¡ˆå»å¸®åŠ©æˆ‘ä»¬è§£å†³ã€‚</p><p>æ³¨æ„: è¿™ä¸¤ç§æ–¹æ¡ˆå¯èƒ½å­˜åœ¨é”™è¯¯åˆ é™¤çš„æƒ…å†µï¼Œè¯·è°¨æ…æ“ä½œã€‚</p><h2 id="å¼ºåˆ¶åˆ é™¤"><a href="#å¼ºåˆ¶åˆ é™¤" class="headerlink" title="å¼ºåˆ¶åˆ é™¤"></a>å¼ºåˆ¶åˆ é™¤</h2><p>kubectlæä¾›forceå’Œgrace-period&#x3D;0ä¸¤ä¸ªå‚æ•°å¸®åŠ©æˆ‘ä»¬å¼ºåˆ¶åˆ é™¤namespaceï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete ns <span class="variable">$&#123;namespace&#125;</span> --force --grace-period=0</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><ul><li><p>â€“forceï¼šå¼ºåˆ¶åˆ é™¤èµ„æºï¼Œè·³è¿‡æ­£å¸¸çš„åˆ é™¤æµç¨‹ã€‚</p></li><li><p>â€“grace-period&#x3D;0ï¼šç«‹å³åˆ é™¤èµ„æºï¼Œä¸ç­‰å¾…ä»»ä½•æ¸…ç†æ“ä½œã€‚</p></li></ul><h2 id="ä½¿ç”¨Kubernetes-API-åˆ é™¤"><a href="#ä½¿ç”¨Kubernetes-API-åˆ é™¤" class="headerlink" title="ä½¿ç”¨Kubernetes API åˆ é™¤"></a>ä½¿ç”¨Kubernetes API åˆ é™¤</h2><p>è·å–å¤„äºTerminatingçŠ¶æ€çš„namespaceï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get ns |grep Terminating |awk &#123;<span class="string">&#x27;print $1&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨Kubernetes API åˆ é™¤æŒ‡å®šçš„namespace</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl get ns <span class="variable">$&#123;namespace&#125;</span> -o json &gt;<span class="variable">$&#123;namespace&#125;</span>.json</span><br><span class="line">sed -i <span class="string">&#x27;/&quot;kubernetes&quot;/d&#x27;</span> <span class="variable">$&#123;namespace&#125;</span>.json</span><br><span class="line">kubectl replace --raw <span class="string">&quot;/api/v1/namespaces/<span class="variable">$&#123;namespace&#125;</span>/finalize&quot;</span> -f <span class="variable">$&#123;namespace&#125;</span>.json</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://segmentfault.com/a/1190000042972476">Kubernetes çš„ NameSpace æ— æ³•åˆ é™¤åº”è¯¥æ€ä¹ˆåŠ</a></li><li><a href="https://www.cnblogs.com/sunshine99/p/17265300.html">kubernetesæ‰¹é‡åˆ é™¤é•¿æœŸå¤„äºTerminatingçŠ¶æ€çš„namespace</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> k3s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Security ä¸­åŸºäºç”¨æˆ·ä¿¡æ¯çš„åŠ¨æ€å¯†ç åŠ å¯†</title>
      <link href="/2025/02/08/back-end/dynamic-password-encryption-based-on-user-information-in-spring-security/"/>
      <url>/2025/02/08/back-end/dynamic-password-encryption-based-on-user-information-in-spring-security/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-Security-ä¸­åŸºäºç”¨æˆ·ä¿¡æ¯çš„åŠ¨æ€å¯†ç åŠ å¯†"><a href="#Spring-Security-ä¸­åŸºäºç”¨æˆ·ä¿¡æ¯çš„åŠ¨æ€å¯†ç åŠ å¯†" class="headerlink" title="Spring Security ä¸­åŸºäºç”¨æˆ·ä¿¡æ¯çš„åŠ¨æ€å¯†ç åŠ å¯†"></a>Spring Security ä¸­åŸºäºç”¨æˆ·ä¿¡æ¯çš„åŠ¨æ€å¯†ç åŠ å¯†</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é€šè¿‡è‡ªå®šä¹‰ Spring Security çš„ DaoAuthenticationProviderï¼Œå¯ä»¥å®ç°æ ¹æ®ç”¨æˆ·ä¿¡æ¯çš„ä¸åŒï¼ŒåŠ¨æ€åˆ‡æ¢ä¸åŒçš„å¯†ç åŠ å¯†æ–¹å¼ã€‚è¿™ç§æ–¹æ³•å…è®¸æ‚¨æ ¹æ®ç”¨æˆ·çš„è§’è‰²ã€ç»„æˆ–å…¶ä»–å±æ€§ï¼Œé€‰æ‹©æœ€åˆé€‚çš„åŠ å¯†ç®—æ³•ï¼Œä»è€Œæé«˜å®‰å…¨æ€§æˆ–æ»¡è¶³ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><h2 id="DaoAuthenticationProvider"><a href="#DaoAuthenticationProvider" class="headerlink" title="DaoAuthenticationProvider"></a>DaoAuthenticationProvider</h2><p>DaoAuthenticationProvideræ˜¯ç”¨äºå®ç°ç”¨æˆ·åå¯†ç çš„ç™»é™†AuthenticationProviderï¼Œé€šè¿‡è‡ªå®šä¹‰å®ç°additionalAuthenticationChecksæ–¹æ³•å¯ä»¥å®ç°ä»UserDetailsè·å–ä¸€ä¸ªå­—æ®µä»è€ŒåŠ¨æ€è·å–å¯†ç åŠ å¯†æœåŠ¡ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>è‡ªå®šä¹‰DaoAuthenticationProviderï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HotelerAuthenticationProvider</span> <span class="keyword">extends</span> <span class="title class_">DaoAuthenticationProvider</span> <span class="keyword">implements</span> <span class="title class_">AuthenticationProvider</span>, ApplicationContextAware &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">additionalAuthenticationChecks</span><span class="params">(UserDetails userDetails, UsernamePasswordAuthenticationToken authentication)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">        <span class="keyword">if</span> (authentication.getCredentials() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.logger.debug(<span class="string">&quot;Failed to authenticate since no credentials provided&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadCredentialsException</span>(<span class="built_in">this</span>.messages.getMessage(<span class="string">&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;</span>, <span class="string">&quot;Bad credentials&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">var</span> <span class="variable">user</span> <span class="operator">=</span>  (User)userDetails;</span><br><span class="line">        <span class="type">var</span> <span class="variable">passwordType</span> <span class="operator">=</span> CommonUtils.isNotEmpty(user.getPasswordType()) ? user.getPasswordType() : <span class="string">&quot;noop&quot;</span>;</span><br><span class="line">        <span class="type">var</span> <span class="variable">passwordService</span> <span class="operator">=</span> <span class="built_in">this</span>.getPasswordService(passwordType);</span><br><span class="line">        <span class="type">var</span> <span class="variable">presentedPassword</span> <span class="operator">=</span> authentication.getCredentials().toString();</span><br><span class="line">        <span class="keyword">if</span> (!user.getPassword().equals(passwordService.encodePassword(presentedPassword))) &#123;</span><br><span class="line">            <span class="built_in">this</span>.logger.debug(<span class="string">&quot;Failed to authenticate since password does not match stored value&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadCredentialsException</span>(<span class="built_in">this</span>.messages.getMessage(<span class="string">&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;</span>, <span class="string">&quot;Bad credentials&quot;</span>));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="built_in">this</span>.applicationContext = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doAfterPropertiesSet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.doAfterPropertiesSet();</span><br><span class="line">        Assert.notNull(<span class="built_in">this</span>.applicationContext, <span class="string">&quot;A applicationContext must be set&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> IPasswordService <span class="title function_">getPasswordService</span><span class="params">(String passwordType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.requireNonNull(<span class="built_in">this</span>.applicationContext).getBean(passwordType + <span class="string">&quot;PasswordService&quot;</span>, IPasswordService.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HotelerAuthenticationProvider</span><span class="params">(UserDetailsService userDetailsService)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.setUserDetailsService(userDetailsService);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†HotelerAuthenticationProvideræ³¨å…¥åˆ°AuthenticationManagerä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> AuthenticationManager <span class="title function_">authenticationManager</span><span class="params">(HotelerAuthenticationProvider authenticationProvider)</span> &#123;;</span><br><span class="line">    <span class="type">ProviderManager</span> <span class="variable">pm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProviderManager</span>(authenticationProvider);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Spring Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024å¹´åº¦æ€»ç»“</title>
      <link href="/2025/01/13/summary/2024/"/>
      <url>/2025/01/13/summary/2024/</url>
      
        <content type="html"><![CDATA[<h1 id="2024å¹´åº¦æ€»ç»“"><a href="#2024å¹´åº¦æ€»ç»“" class="headerlink" title="2024å¹´åº¦æ€»ç»“"></a>2024å¹´åº¦æ€»ç»“</h1><p>å¯¹æˆ‘æ¥è¯´ï¼Œ2024å¹´æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰æ„ä¹‰çš„ä¸€å¹´ã€‚8æœˆ24å·ï¼Œæˆ‘ç¾ä¸½åˆå¯çˆ±çš„å®å®å‡ºç”Ÿäº†ï¼Œä½“éªŒåˆ°äº†åˆä¸ºäººçˆ¶çš„å–œæ‚¦ï¼›10æœˆ7å·ï¼Œå›½åº†èŠ‚åˆšè¿‡ï¼Œå…¬å¸äººäº‹å°±å¼€é‚®ä»¶é€šçŸ¥æˆ‘æˆ‘çš„å²—ä½è¢«å–æ¶ˆäº†ã€‚</p><h1 id="åˆä¸ºäººçˆ¶çš„å–œæ‚¦"><a href="#åˆä¸ºäººçˆ¶çš„å–œæ‚¦" class="headerlink" title="åˆä¸ºäººçˆ¶çš„å–œæ‚¦"></a>åˆä¸ºäººçˆ¶çš„å–œæ‚¦</h1><p>å­©å­çš„å‡ºç”Ÿæ—¶é—´å…¶å®æŒºæ„å¤–çš„ã€‚ç”±äºè€å©†åœ¨9æœˆåˆæœ‰ä¸€åœºå¾ˆé‡è¦çš„è€ƒè¯•ï¼Œæ‰€ä»¥ä¸èƒ½è€½æï¼Œæ‰€ä»¥åŸæ¥è®¡åˆ’åœ¨20å·å»åŒ»é™¢æ‰“å‚¬äº§ç´ çš„ï¼Œç»“æœå› ä¸ºæŠ¥å‘Šæ™šäº†ä¸€å¤©ï¼Œç„¶åå°±è¢«é€šçŸ¥ä¸ç”¨æ‰“å‚¬äº§ç´ ï¼Œå·²ç»å¼€å§‹è§çº¢äº†ã€‚ä¸è¿‡å¼€å®«å£çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¿‡ä¸¤å¤©è¿˜æ˜¯ä¸Šå‚¬äº§ç´ äº†ã€‚æˆ‘è®°å¾—é‚£ä¸ªæ—¶å€™æˆ‘åœ¨å®¶é‡Œå‘†ç€ï¼ŒåŒ»é™¢æˆ‘æœ‰ä¸ˆæ¯å¨˜é™ªç€ï¼Œåæ­£åˆä¸å¯èƒ½é‚£ä¹ˆæ€¥ç€ç”Ÿå‡ºæ¥ï¼Œæˆ‘å°±å›å®¶å…ˆå¥½å¥½ä¼‘æ¯ï¼Œæ‰“ç®—ç¬¬äºŒå¤©è¿‡å»ã€‚ç»“æœç¬¬äºŒå¤©æˆ‘ä¸ˆæ¯å¨˜å°±é€šçŸ¥æˆ‘è®©æˆ‘èµ¶ç´§è¿‡å»ç­¾å­—ç»™æˆ‘è€å©†æ‰“å‚¬äº§ç´ ã€‚ä¸€æ³¢ä¸‰æŠ˜ï¼Œåˆ°æœ€åè¿™ä¸ªå‚¬äº§ç´ è¿˜æ˜¯æ‰“ä¸Šå»äº†ã€‚åœ¨6å·å¾…äº§å®¤ï¼Œæ™šä¸Š6ç‚¹06åˆ†ï¼Œ7æ–¤2ä¸¤ï¼Œæˆ‘å¯çˆ±çš„å„¿å­å°±è¿™æ ·å­å¹³å¹³å®‰å®‰çš„å‡ºç”Ÿäº†ã€‚è¯´å®è¯ï¼Œæˆ‘å¹¶æ²¡æœ‰åœ¨ç¬¬ä¸€æ—¶é—´å¬åˆ°å­©å­çš„å“­å£°ï¼Œç›¸åè¿™ä¸ªå°å®¶ä¼™ç¡çš„æ­»æ­»çš„ã€‚æˆ‘ä¼¸è¿‡å»çœ‹çœ‹äº†ä»–ï¼Œç¬¬ä¸€æ„Ÿè§‰ä»–å¥½ä¸‘å•Šï¼Œå¤´å‹æ€ªæ€ªçš„ï¼Œæœ‰ç‚¹æ‹‰é•¿çš„æ ·å­ã€‚å¬åŒ»ç”Ÿè¯´ï¼Œåˆšå‡ºç”Ÿçš„å°å®å®é€šå¸¸äº§é“çš„æŒ¤å‹ï¼Œå‡ºæ¥çš„æ—¶å€™å¤´å¤šå¤šå°‘å°‘ä¼šæœ‰ç‚¹æ‹‰é•¿çš„æ ·å­ï¼Œç­‰é•¿å¤§ç‚¹å°±å¥½äº†ã€‚</p><p>å­©å­çš„å‡ºç”Ÿï¼Œå¯¹æˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„äººç”Ÿé‡Œç¨‹ç¢‘ï¼Œä»è¿™ä¸€åˆ»å¼€å§‹ï¼Œæˆ‘ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ™®é€šçš„ç‰›é©¬ï¼Œæ›´æ˜¯ä¸€ä¸ªä¸Šæœ‰è€ä¸‹æœ‰å°çš„å¤©é€‰ç‰›é©¬ã€‚å°±è¿™æ ·ä¸€ä¸‹å­ï¼Œæ„Ÿè§‰èº«ä¸Šçš„è´£ä»»æ˜æ˜¾é‡äº†å¾ˆå¤šã€‚ç®—äº†ä¸€ä¸‹å­©å­çš„å¥¶ç²‰é’±ï¼Œå°¿ä¸æ¹¿çš„é’±ï¼Œå°†æ¥ä¼‘å­¦çš„é’±ï¼Œä»¥åå¨¶è€å©†çš„é’±å’Œå½©ç¤¼ï¼Œè¿˜æœ‰ä¾›å…»è€å©†å¤§äººåƒå–ç©ä¹çš„é’±ã€‚å¤„å¤„éƒ½æ˜¯é’±ï¼Œå¤„å¤„éƒ½æ˜¯å‹åŠ›ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“å°†æ¥å­©å­ä¼šæ´»æˆä»€ä¹ˆæ ·å­ï¼Œä½†æ˜¯æˆ‘ä¸å¥¢æœ›ä»–èƒ½å‡ºäººå¤´åœ°ï¼Œåªå¸Œæœ›å¹³å¹³å®‰å®‰çš„é•¿å¤§ï¼›ä¸æœŸå¾…ä»–å°†æ¥å­¦ä¸šæœ‰æˆï¼Œäº‹ä¸šéå‡¡ï¼Œåªå¸Œæœ›ä»–èƒ½è¿‡çš„è‡ªåœ¨å®‰å¿ƒã€‚</p><h1 id="è£å‘˜"><a href="#è£å‘˜" class="headerlink" title="è£å‘˜"></a>è£å‘˜</h1><p>å…¶å®è£å‘˜æ˜¯æœ‰ç‚¹é£å£°çš„ï¼Œä½†æ˜¯ä¸€ç›´éƒ½æ˜¯ç‹¼æ¥çš„çŠ¶æ€ã€‚åœ¨å›½åº†èŠ‚ï¼Œéƒ¨é—¨é¢†å¯¼å°±ç§ä¸‹çš„å°±é€éœ²è¿‡æ¯ä¸ªleaderéƒ½éœ€è¦ä¸Šäº¤ä¸€ä»½è£å‘˜åå•ï¼Œæ›´ä¸Šçº§çš„é¢†å¯¼ä¼šæ ¹æ®è¿™ä»½åå•è£å‘˜ã€‚å¯¹äºæˆ‘è¿™ç§å¹²æ´»å„¿çš„å°å–½å•°ï¼Œå¤§æ¦‚ç‡æ˜¯å¯ä»¥ä¿ä½é¥­ç¢—çš„ï¼Œæ¯•ç«Ÿæˆ‘è¿˜æ˜¯æ¯”è¾ƒèƒ½å¹²æ´»å„¿çš„ï¼Œæœ€è¿‘åšçš„é¡¹ç›®ä¹Ÿæ˜¯æ¯”è¾ƒæœ‰é’±çš„å…¶å®ã€‚</p><p>ä½†æ˜¯éå¸¸å°´å°¬çš„æ˜¯ï¼Œç¡®å®æ˜¯è£å‘˜äº†ï¼Œä½†æ˜¯ä¸æ˜¯ä¸Šæµ·å‘èµ·çš„è£å‘˜ï¼Œæ˜¯ç¾å›½å‘èµ·çš„è£å‘˜ã€‚ç¾å›½æœ€é«˜å±‚å†³å®šå…¨çƒè£å‘˜å¥½å‡ åƒäººï¼Œé¢„è®¡æ¶‰åŠç¾å›½ï¼Œå¢¨è¥¿å“¥ï¼Œå°åº¦å’Œä¸Šæµ·å‡ ä¸ªåœ°æ–¹çš„officeã€‚</p><p>è¿™æ¬¡è£å‘˜ä¸»è¦æ˜¯æˆ‘ä»¬P &amp; Téƒ¨é—¨ï¼Œå…¶ä»–éƒ¨é—¨ä¼¼ä¹è¿˜å¥½å¥½çš„ã€‚P &amp; Tç”±Labså’ŒDigitalä¸¤ä¸ªå°éƒ¨é—¨ï¼Œæˆ‘ä»¬labsè¿™è¾¹ååˆ†å¹³é™çš„æ¥å—äº†è¿™æ¬¡è£å‘˜ï¼Œå¤§å®¶è™½ç„¶éƒ½ä¸å¤ªèƒ½æ¥å—ï¼Œä½†æ˜¯æ™®éé€‰æ‹©è®¤å‘½ï¼Œå¤§å®¶è¯¥åƒåƒè¯¥å–å–ï¼Œå¥½èšå¥½æ•£ã€‚ä½†æ˜¯éš”å£éƒ¨é—¨æ˜¯æœ‰äººé—¹äº†ä¸‹ï¼Œä½†æ˜¯å¾ˆå¿«å°±æ²¡ä¸‹æ–‡äº†ã€‚åæ¥æˆ‘å¬è¯´å‡ºå¤´é—¹äº‹çš„äººç¬¬ä¸€ä¸ªæ‰¾åˆ°å·¥ä½œä¹‹åå°±ä¸å‡ºå¤´äº†ï¼Œç»“æœä¹Ÿå°±æ²¡äººé—¹äº‹äº†ã€‚</p><h1 id="æ‰¾å·¥ä½œ"><a href="#æ‰¾å·¥ä½œ" class="headerlink" title="æ‰¾å·¥ä½œ"></a>æ‰¾å·¥ä½œ</h1><p>æ‰¾å·¥ä½œæŒºéš¾çš„ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å¤–åŒ…ã€‚æ²¡åšé¢è¯•çš„è®°å½•ï¼Œå°±éšä¾¿å›å¿†ä¸€ä¸‹å§ã€‚é¢è¯•PayPalå¤–åŒ…, äºŒé¢å’Œä¸‰é¢ä¸€èµ·é¢çš„ï¼ŒæŒ‚äº†ï¼Œæ„Ÿè§‰äºŒé¢å’Œä¸‰é¢éƒ½ä¸æ˜¯å¾ˆå¥½ã€‚é¢è¯•VOA2(ä¸€å®¶ä¸é”™çš„æ³•èµ„å°å…¬å¸)ï¼Œå› ä¸ºè‹±è¯­å’Œå²—ä½ä¸åˆé€‚æŒ‚ã€‚é¢è¯•è¿ªå£«å°¼å¤–åŒ…ï¼Œä¸€é¢æŒ‚äº†ï¼Œæç¬‘çš„æ˜¯åˆä¸€å®¶å¤–åŒ…æ¥é‚€è¯·æˆ‘å»é¢è¯•ï¼Œä¸»è¦æ˜¯è¿ªå£«å°¼çš„æŠ€æœ¯æ ˆæ˜¯Angular+Graphqlï¼Œæ¯”è¾ƒå°ä¼—ï¼Œä½†æ˜¯æˆ‘éƒ½ç”¨è¿‡ï¼Œæˆ‘ä¸å¤ªæƒ³å»ï¼Œä½†æ˜¯å¯¹æ–¹åŠäº†æˆ‘å¥½å‡ æ¬¡ï¼Œæœ€åè¿˜æ˜¯åœ¨äºŒé¢æŒ‚äº†ï¼ˆé¢è¯•ä¸‰æ¬¡ï¼ŒæŒ‚äº†ä¸¤æ¬¡ï¼ŒæŒºå¥½ç©çš„ç»å†ï¼‰ã€‚é¢è¯•èŠ±æ——å¤–åŒ…ï¼ŒäºŒé¢æŒ‚äº†ï¼Œå…¶å®æœ¬æ¥æ˜¯æŒºæœ‰æœºä¼šçš„ï¼Œä½†æ˜¯äºŒé¢å°±27åˆ†é’Ÿï¼Œè¿˜ç®—ä¸Šæˆ‘é—®çš„é—®é¢˜ï¼Œåªèƒ½è¢«æŒ‚äº†ã€‚é¢è¯•åé’¦ï¼ˆåé’¦æ˜¯å¤–åŒ…å…¬å¸ï¼Œä½†æ˜¯è¿™ä¸ªå²—ä½ä¸æ˜¯å¤–åŒ…ï¼‰ï¼Œæˆ‘æ˜æ˜é¢è¯•çš„æ˜¯å‰ç«¯ï¼Œé¢è¯•å®˜æ˜¯åç«¯çš„ï¼Œé“ä¸åŒã€‚<br>é¢è¯•æ‘©æ ¹å£«ä¸¹åˆ©å¤–åŒ…ï¼ŒäºŒé¢è¿‡äº†ï¼Œæ„Ÿè§‰æ¯”è¾ƒæ°´ï¼Œç›¸å¯¹å¥½è¿‘ã€‚</p><h1 id="æ‘©æ ¹å£«ä¸¹åˆ©"><a href="#æ‘©æ ¹å£«ä¸¹åˆ©" class="headerlink" title="æ‘©æ ¹å£«ä¸¹åˆ©"></a>æ‘©æ ¹å£«ä¸¹åˆ©</h1><p>è¿›å…¥æ‘©æ ¹å£«ä¸¹åˆ©ä¹‹åå…¶å®æœ‰æ®µæ—¶é—´æ˜¯ä¸å¤ªé€‚åº”çš„ï¼Œä¹ æƒ¯äº†æ™®åæ°¸é“è¿™ç§æ··åˆåŠå…¬å’Œä¸å®šæ—¶å·¥ä½œåˆ¶ï¼Œä¸å¤ªèƒ½æ¥å—æ‘©æ ¹å£«ä¸¹åˆ©è¿™ç§965çš„é£æ ¼ï¼Œä¸è¿‡è¿˜å¥½ï¼Œä¸¤å‘¨å°±é€‚åº”äº†ï¼Œå‘äº†å·¥èµ„å°±æ›´åŠ é€‚åº”ï¼Œæ²¡æœ‰å¿…è¦å’Œé’±è¿‡ä¸å»ã€‚æ‘©æ ¹å£«ä¸¹åˆ©é‡Œé¢ä»€ä¹ˆæƒ…å†µæˆ‘ä¸æ–¹ä¾¿å¤šè¯´ï¼Œä½†æ˜¯æ ¹æ®å·¥ä½œå®‰æ’æ¥çœ‹ï¼ŒåšæŒåˆ°2026å¹´åº•é—®é¢˜ä¸å¤§ï¼Œä»¥åå°±å†è¯´å§ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¦‚æœæ²¡æœ‰è£å‘˜è¿™å›äº‹å„¿ï¼Œé‚£ä¹ˆ2024å¹´å¯¹æˆ‘è¿˜æ˜¯ä¸€ä¸ªæŒºä¸é”™çš„å¹´ä»½ã€‚æ¶¨ç‚¹å·¥èµ„ï¼ˆæ™®åæ°¸é“æ¯å¹´7æœˆè°ƒè–ªï¼‰ï¼Œæœ‰ä¸ªå„¿å­ï¼Œæœ¬æ¥å°±å¯ä»¥è¿™æ ·å­è¿‡å»äº†ã€‚å¯æƒœæ²¡æœ‰å¦‚æœï¼Œç°åœ¨åœ¨æ‘©æ ¹åšå¤–åŒ…ä¹Ÿèƒ½æ¥å—ï¼Œæ¯•ç«Ÿæ­£å¼å‘˜å·¥å¯¹æˆ‘ä»¬ç®—å¾—ä¸Šéå¸¸niceäº†ã€‚å¸Œæœ›2025å¹´å¯ä»¥å¹³å¹³å®‰å®‰ï¼Œä¿ä½å·¥ä½œï¼Œå°‘ç‚¹ä¸ªäººæ¶ˆè´¹ï¼Œå¤šç‚¹ç•™ç»™å®¶äººã€‚æŠ€æœ¯ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¤§çš„æƒ³æ³•ï¼Œä¿ä½å·¥ä½œå°±è¡Œï¼Œè‹Ÿæ´»åˆ°ç»æµèƒ½å¤ŸçœŸçš„å¤è‹å§ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>scriptæ ‡ç­¾ä¸­çš„deferå’Œasync</title>
      <link href="/2024/11/04/front-end/html-scripts-defer-async/"/>
      <url>/2024/11/04/front-end/html-scripts-defer-async/</url>
      
        <content type="html"><![CDATA[<h1 id="æµè§ˆå™¨ä¸­scriptæ ‡ç­¾ä¸­çš„deferå’Œasyncæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æµè§ˆå™¨ä¸­scriptæ ‡ç­¾ä¸­çš„deferå’Œasyncæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æµè§ˆå™¨ä¸­scriptæ ‡ç­¾ä¸­çš„deferå’Œasyncæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æµè§ˆå™¨ä¸­scriptæ ‡ç­¾ä¸­çš„deferå’Œasyncæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>åœ¨ HTML ä¸­ï¼Œ<code>&lt;script&gt;</code> æ ‡ç­¾çš„ <code>defer</code> å’Œ <code>async</code> å±æ€§ç”¨äºæ§åˆ¶è„šæœ¬çš„åŠ è½½å’Œæ‰§è¡Œæ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç† JavaScript æ–‡ä»¶æ—¶ã€‚å®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«å’Œåº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p><h3 id="1-defer"><a href="#1-defer" class="headerlink" title="1. defer"></a>1. <code>defer</code></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šè„šæœ¬åœ¨æ–‡æ¡£è§£æå®Œæˆåæ‰§è¡Œï¼Œä½†åœ¨ DOMContentLoaded äº‹ä»¶ä¹‹å‰æ‰§è¡Œã€‚</li><li><strong>åŠ è½½é¡ºåº</strong>ï¼š<code>defer</code> è„šæœ¬ä¼šæŒ‰ç…§å®ƒä»¬åœ¨æ–‡æ¡£ä¸­çš„å‡ºç°é¡ºåºåŠ è½½å¹¶æ‰§è¡Œã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºä¾èµ–äº DOM å®Œå…¨åŠ è½½çš„è„šæœ¬ï¼Œæˆ–è€…éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªè„šæœ¬çš„æƒ…å†µã€‚</li></ul><h4 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h4><ul><li>ç¡®ä¿ DOM å…ƒç´ åœ¨è„šæœ¬æ‰§è¡Œæ—¶å·²å­˜åœ¨ï¼Œé¿å…äº†å› å…ƒç´ æœªåŠ è½½è€Œå¯¼è‡´çš„é”™è¯¯ã€‚</li><li>ä¸ä¼šé˜»å¡ HTML çš„è§£æï¼Œå¯ä»¥æé«˜é¡µé¢åŠ è½½æ€§èƒ½ã€‚</li></ul><h4 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script1.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script2.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-async"><a href="#2-async" class="headerlink" title="2. async"></a>2. <code>async</code></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šè„šæœ¬ä¼šåœ¨ä¸‹è½½å®Œæˆåç«‹å³æ‰§è¡Œï¼Œè€Œä¸ä¼šç­‰å¾… DOMContentLoadedã€‚</li><li><strong>åŠ è½½é¡ºåº</strong>ï¼š<code>async</code> è„šæœ¬ä¸ä¿è¯æ‰§è¡Œé¡ºåºã€‚å¦‚æœæœ‰å¤šä¸ª <code>async</code> è„šæœ¬ï¼Œæ‰§è¡Œé¡ºåºå¯èƒ½ä¸å®ƒä»¬åœ¨æ–‡æ¡£ä¸­çš„å‡ºç°é¡ºåºä¸åŒã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚åˆäºç‹¬ç«‹äºå…¶ä»–è„šæœ¬çš„è„šæœ¬ï¼Œä¾‹å¦‚åˆ†æå·¥å…·æˆ–å¹¿å‘Šè„šæœ¬ã€‚</li></ul><h4 id="ä¼˜ç‚¹ï¼š-1"><a href="#ä¼˜ç‚¹ï¼š-1" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h4><ul><li>è„šæœ¬åœ¨åŠ è½½æ—¶ä¸é˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œæå‡é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</li><li>å¯¹äºä¸ä¾èµ–äº DOM ç»“æ„çš„è„šæœ¬ï¼Œèƒ½æ›´å¿«åœ°æ‰§è¡Œã€‚</li></ul><h4 id="ç¤ºä¾‹ï¼š-1"><a href="#ç¤ºä¾‹ï¼š-1" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-åŒºåˆ«æ€»ç»“"><a href="#3-åŒºåˆ«æ€»ç»“" class="headerlink" title="3. åŒºåˆ«æ€»ç»“"></a>3. åŒºåˆ«æ€»ç»“</h3><table><thead><tr><th>ç‰¹æ€§</th><th><code>defer</code></th><th><code>async</code></th></tr></thead><tbody><tr><td>æ‰§è¡Œæ—¶æœº</td><td>DOM è§£æå®Œæˆåï¼ŒDOMContentLoaded ä¹‹å‰</td><td>ä¸‹è½½å®Œæˆåç«‹å³æ‰§è¡Œ</td></tr><tr><td>åŠ è½½é¡ºåº</td><td>æŒ‰ç…§åœ¨æ–‡æ¡£ä¸­çš„é¡ºåºåŠ è½½å¹¶æ‰§è¡Œ</td><td>ä¸ä¿è¯æ‰§è¡Œé¡ºåº</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ä¾èµ–äº DOM çš„è„šæœ¬ï¼Œé¡ºåºæ‰§è¡Œ</td><td>ç‹¬ç«‹çš„è„šæœ¬ï¼Œä¸ä¾èµ–å…¶ä»–è„šæœ¬</td></tr></tbody></table><h3 id="4-é€‰æ‹©ä½¿ç”¨åœºæ™¯"><a href="#4-é€‰æ‹©ä½¿ç”¨åœºæ™¯" class="headerlink" title="4. é€‰æ‹©ä½¿ç”¨åœºæ™¯"></a>4. é€‰æ‹©ä½¿ç”¨åœºæ™¯</h3><ul><li><p>**ä½¿ç”¨ <code>defer</code>**ï¼š</p><ul><li>éœ€è¦ä¾èµ–äºé¡µé¢ DOM å®Œå…¨åŠ è½½çš„è„šæœ¬ï¼ˆå¦‚æ“ä½œ DOM å…ƒç´ çš„è„šæœ¬ï¼‰ã€‚</li><li>éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªè„šæœ¬ã€‚</li></ul></li><li><p>**ä½¿ç”¨ <code>async</code>**ï¼š</p><ul><li>ç‹¬ç«‹äºå…¶ä»–è„šæœ¬çš„ç¬¬ä¸‰æ–¹è„šæœ¬ï¼ˆå¦‚å¹¿å‘Šã€åˆ†æå·¥å…·ï¼‰ã€‚</li><li>ä¸ä¾èµ–äº DOM çš„è„šæœ¬ï¼Œå¯ä»¥åœ¨é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­ç«‹å³æ‰§è¡Œã€‚</li></ul></li></ul><h3 id="5-ç»“è®º"><a href="#5-ç»“è®º" class="headerlink" title="5. ç»“è®º"></a>5. ç»“è®º</h3><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œåˆç†ä½¿ç”¨ <code>defer</code> å’Œ <code>async</code> å±æ€§å¯ä»¥æé«˜é¡µé¢æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚æ ¹æ®è„šæœ¬çš„ä¾èµ–å…³ç³»å’Œæ‰§è¡Œé¡ºåºé€‰æ‹©é€‚åˆçš„æ–¹å¼ï¼Œæœ‰åŠ©äºä¼˜åŒ–é¡µé¢çš„åŠ è½½å’Œæ¸²æŸ“é€Ÿåº¦ã€‚</p><h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h1><ol><li><a href="https://chatgpt.com/c/6714f7ef-9400-8013-b1dc-9c283200754b">chatgpt</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cssçš„æ¨¡æ‹Ÿé¢è¯•</title>
      <link href="/2024/10/30/front-end/css-mock-interview/"/>
      <url>/2024/10/30/front-end/css-mock-interview/</url>
      
        <content type="html"><![CDATA[<h2 id="csså˜é‡æ˜¯ä»€ä¹ˆ"><a href="#csså˜é‡æ˜¯ä»€ä¹ˆ" class="headerlink" title="csså˜é‡æ˜¯ä»€ä¹ˆ"></a>csså˜é‡æ˜¯ä»€ä¹ˆ</h2><p>CSS å˜é‡ï¼ˆä¹Ÿç§°ä¸ºè‡ªå®šä¹‰å±æ€§ï¼‰æ˜¯ CSS ä¸­ç”¨äºå®šä¹‰å¯é‡ç”¨å€¼çš„ç‰¹æ€§ã€‚å®ƒä»¬ä½¿ç”¨ <code>--</code> å‰ç¼€å®šä¹‰ï¼Œå¯ä»¥åœ¨æ•´ä¸ªæ ·å¼è¡¨ä¸­è¢«å¼•ç”¨å’Œå¤ç”¨ï¼Œä»è€Œæé«˜ä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="1-å®šä¹‰-CSS-å˜é‡"><a href="#1-å®šä¹‰-CSS-å˜é‡" class="headerlink" title="1. å®šä¹‰ CSS å˜é‡"></a>1. å®šä¹‰ CSS å˜é‡</h3><p>CSS å˜é‡é€šå¸¸åœ¨ <code>:root</code> é€‰æ‹©å™¨ä¸­å®šä¹‰ï¼Œè¿™æ ·å®ƒä»¬å¯ä»¥åœ¨æ•´ä¸ªæ–‡æ¡£ä¸­ä½¿ç”¨ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--primary-color</span>: <span class="number">#3498db</span>;</span><br><span class="line">  <span class="attr">--font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--spacing</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä»¥ä¸Šå®šä¹‰çš„ <code>--primary-color</code>ã€<code>--font-size</code> å’Œ <code>--spacing</code> å°±æ˜¯ CSS å˜é‡ã€‚</li></ul><h3 id="2-ä½¿ç”¨-CSS-å˜é‡"><a href="#2-ä½¿ç”¨-CSS-å˜é‡" class="headerlink" title="2. ä½¿ç”¨ CSS å˜é‡"></a>2. ä½¿ç”¨ CSS å˜é‡</h3><p>CSS å˜é‡ä½¿ç”¨ <code>var()</code> å‡½æ•°è¿›è¡Œå¼•ç”¨ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--primary-color);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--font-size);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--spacing);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œ<code>var(--primary-color)</code> å¼•ç”¨äº†ä¹‹å‰å®šä¹‰çš„å˜é‡ <code>--primary-color</code> çš„å€¼ã€‚</p><h3 id="3-åŠ¨æ€ä¿®æ”¹å˜é‡"><a href="#3-åŠ¨æ€ä¿®æ”¹å˜é‡" class="headerlink" title="3. åŠ¨æ€ä¿®æ”¹å˜é‡"></a>3. åŠ¨æ€ä¿®æ”¹å˜é‡</h3><p>CSS å˜é‡çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå¯ä»¥é€šè¿‡ JavaScript åŠ¨æ€ä¿®æ”¹å˜é‡çš„å€¼ï¼Œè½»æ¾å®ç°ä¸»é¢˜åˆ‡æ¢ç­‰æ•ˆæœï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--primary-color&#x27;</span>, <span class="string">&#x27;#e74c3c&#x27;</span>);</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™æ®µä»£ç ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜ <code>--primary-color</code> çš„å€¼ï¼Œä»è€Œä½¿å¾—æ‰€æœ‰å¼•ç”¨æ­¤å˜é‡çš„åœ°æ–¹é¢œè‰²å‘ç”Ÿå˜åŒ–ã€‚</p><h3 id="4-CSS-å˜é‡çš„ä¼˜åŠ¿"><a href="#4-CSS-å˜é‡çš„ä¼˜åŠ¿" class="headerlink" title="4. CSS å˜é‡çš„ä¼˜åŠ¿"></a>4. CSS å˜é‡çš„ä¼˜åŠ¿</h3><ul><li><strong>æé«˜ä»£ç å¯ç»´æŠ¤æ€§</strong>ï¼šåªéœ€ä¿®æ”¹å˜é‡å€¼ï¼Œå°±å¯ä»¥ç»Ÿä¸€åœ°æ”¹å˜æ ·å¼ã€‚</li><li><strong>æ”¯æŒä¸»é¢˜åˆ‡æ¢</strong>ï¼šå¯ä»¥é€šè¿‡æ”¹å˜å˜é‡æ¥åŠ¨æ€æ›´æ–°é¡µé¢ä¸»é¢˜ã€‚</li><li><strong>ä½œç”¨åŸŸçµæ´»</strong>ï¼šCSS å˜é‡å¯ä»¥åœ¨ç‰¹å®šé€‰æ‹©å™¨ä¸­å®šä¹‰ï¼Œå…·æœ‰ç‰¹å®šçš„ä½œç”¨åŸŸã€‚</li></ul><h3 id="5-CSS-å˜é‡çš„å…¼å®¹æ€§"><a href="#5-CSS-å˜é‡çš„å…¼å®¹æ€§" class="headerlink" title="5. CSS å˜é‡çš„å…¼å®¹æ€§"></a>5. CSS å˜é‡çš„å…¼å®¹æ€§</h3><p>CSS å˜é‡åœ¨ç°ä»£æµè§ˆå™¨ä¸­æ”¯æŒè¾ƒå¥½ï¼Œä½†åœ¨ä¸€äº›è€ç‰ˆæœ¬æµè§ˆå™¨ï¼ˆå¦‚ IEï¼‰ä¸­ä¸æ”¯æŒã€‚</p><h2 id="rootæ˜¯ä»€ä¹ˆ"><a href="#rootæ˜¯ä»€ä¹ˆ" class="headerlink" title=":rootæ˜¯ä»€ä¹ˆ"></a>:rootæ˜¯ä»€ä¹ˆ</h2><p><code>:root</code> æ˜¯ä¸€ä¸ªCSSä¼ªç±»é€‰æ‹©å™¨ï¼Œä¸»è¦ç”¨äºé€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚åœ¨HTMLæ–‡æ¡£ä¸­ï¼Œæ ¹å…ƒç´ é€šå¸¸æ˜¯ <code>&lt;html&gt;</code> æ ‡ç­¾ã€‚ä½¿ç”¨ <code>:root</code> é€‰æ‹©å™¨å¯ä»¥æ–¹ä¾¿åœ°è®¾ç½®å…¨å±€CSSå˜é‡æˆ–æ ·å¼ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³äº <code>:root</code> çš„å…³é”®ç‚¹ï¼š</p><h3 id="1-é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ "><a href="#1-é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ " class="headerlink" title="1. é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ "></a>1. <strong>é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ </strong></h3><ul><li><code>:root</code> é€‰æ‹©å™¨é€‰æ‹©çš„æ˜¯æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼Œè¿™åœ¨HTMLä¸­å¯¹åº”äº <code>&lt;html&gt;</code> æ ‡ç­¾ã€‚</li><li>ä¾‹å¦‚ï¼Œä»¥ä¸‹CSSä»£ç å°†é€‰æ‹©æ ¹å…ƒç´ å¹¶åº”ç”¨æ ·å¼ï¼š<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--main-color</span>: <span class="number">#3498db</span>; <span class="comment">/* å®šä¹‰CSSå˜é‡ */</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-CSSå˜é‡çš„å®šä¹‰"><a href="#2-CSSå˜é‡çš„å®šä¹‰" class="headerlink" title="2. CSSå˜é‡çš„å®šä¹‰"></a>2. <strong>CSSå˜é‡çš„å®šä¹‰</strong></h3><ul><li><code>:root</code> æ˜¯å®šä¹‰CSSå˜é‡çš„å¸¸è§ä½ç½®ã€‚ç”±äº <code>:root</code> é€‰æ‹©å™¨å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œä½¿ç”¨å®ƒå¯ä»¥ç¡®ä¿å˜é‡åœ¨æ•´ä¸ªæ–‡æ¡£ä¸­éƒ½å¯ä»¥è¢«è®¿é—®åˆ°ã€‚</li><li>å®šä¹‰åœ¨ <code>:root</code> ä¸­çš„å˜é‡å¯ä»¥åœ¨åç»­çš„CSSè§„åˆ™ä¸­ä½¿ç”¨ï¼š<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--primary-color</span>: <span class="number">#3498db</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--primary-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-å…¨å±€æ ·å¼"><a href="#3-å…¨å±€æ ·å¼" class="headerlink" title="3. å…¨å±€æ ·å¼"></a>3. <strong>å…¨å±€æ ·å¼</strong></h3><ul><li>ä½¿ç”¨ <code>:root</code> å¯ä»¥è®¾ç½®å…¨å±€æ ·å¼æˆ–CSSå˜é‡ï¼Œä½¿å¾—æ ·å¼æ›´åŠ ç»Ÿä¸€å’Œå¯ç»´æŠ¤ã€‚</li><li>åœ¨é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ å¸Œæœ›æœ‰ä¸€ä¸ªåœ°æ–¹é›†ä¸­ç®¡ç†ä¸»é¢˜é¢œè‰²ã€å­—ä½“å¤§å°ç­‰ï¼Œå¯ä»¥é€šè¿‡ <code>:root</code> å®ç°ã€‚</li></ul><h3 id="4-ä¸å…¶ä»–é€‰æ‹©å™¨çš„ç»„åˆ"><a href="#4-ä¸å…¶ä»–é€‰æ‹©å™¨çš„ç»„åˆ" class="headerlink" title="4. ä¸å…¶ä»–é€‰æ‹©å™¨çš„ç»„åˆ"></a>4. <strong>ä¸å…¶ä»–é€‰æ‹©å™¨çš„ç»„åˆ</strong></h3><ul><li><code>:root</code> å¯ä»¥ä¸å…¶ä»–é€‰æ‹©å™¨ç»„åˆä½¿ç”¨ï¼Œä»è€Œé’ˆå¯¹ç‰¹å®šæ¡ä»¶åº”ç”¨æ ·å¼ã€‚ä¾‹å¦‚ï¼š<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span><span class="selector-class">.dark-mode</span> &#123;</span><br><span class="line">    <span class="attr">--background-color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attr">--text-color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>:root</code> å®šä¹‰å’Œä½¿ç”¨CSSå˜é‡ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--primary-color</span>: <span class="number">#3498db</span>;</span><br><span class="line">    <span class="attr">--font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--font-size);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--primary-color);</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--primary-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ <code>:root</code> ä¸­å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼š<code>--primary-color</code> å’Œ <code>--font-size</code>ï¼Œç„¶ååœ¨ <code>body</code> å’Œ <code>h1</code> å…ƒç´ ä¸­ä½¿ç”¨äº†è¿™äº›å˜é‡ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><code>:root</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºå®šä¹‰å…¨å±€CSSå˜é‡å’Œæ ·å¼ï¼Œæ–¹ä¾¿ç»´æŠ¤å’Œç®¡ç†æ ·å¼ã€‚å®ƒå¸®åŠ©å¼€å‘è€…åœ¨æ•´ä¸ªæ–‡æ¡£ä¸­å®ç°ä¸€è‡´çš„è®¾è®¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nodejsçš„æ¨¡æ‹Ÿé¢è¯•</title>
      <link href="/2024/10/29/front-end/nodejs-mock-interview/"/>
      <url>/2024/10/29/front-end/nodejs-mock-interview/</url>
      
        <content type="html"><![CDATA[<h2 id="CommonJSæ˜¯ä»€ä¹ˆ"><a href="#CommonJSæ˜¯ä»€ä¹ˆ" class="headerlink" title="CommonJSæ˜¯ä»€ä¹ˆ"></a>CommonJSæ˜¯ä»€ä¹ˆ</h2><p>CommonJSï¼ˆç®€ç§°CJSï¼‰æ˜¯ä¸€ç§JavaScriptæ¨¡å—åŒ–è§„èŒƒï¼Œæœ€åˆä¸ºåœ¨æœåŠ¡ç«¯ï¼ˆå¦‚Node.jsï¼‰å®ç°æ¨¡å—åŒ–è€Œè®¾è®¡ã€‚åœ¨CommonJSä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½è¢«è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå¹¶é€šè¿‡<code>module.exports</code>å¯¼å‡ºå’Œ<code>require</code>å¼•å…¥å…¶ä»–æ¨¡å—ï¼Œå½¢æˆæ¸…æ™°çš„æ¨¡å—ä¾èµ–ç»“æ„ã€‚ä»¥ä¸‹æ˜¯CommonJSçš„å‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li><strong>æ¨¡å—å¯¼å‡ºå’Œå¯¼å…¥</strong>ï¼šCommonJSä½¿ç”¨<code>module.exports</code>å¯¼å‡ºå†…å®¹ï¼Œå…¶ä»–æ–‡ä»¶ä½¿ç”¨<code>require</code>å¯¼å…¥ã€‚ä¾‹å¦‚ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å‡ºæ¨¡å—</span></span><br><span class="line"><span class="comment">// math.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">add</span>: <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b,</span><br><span class="line">  <span class="attr">subtract</span>: <span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> math = <span class="built_in">require</span>(<span class="string">&quot;./math&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(math.<span class="title function_">add</span>(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º5</span></span><br></pre></td></tr></table></figure><ol start="2"><li><p><strong>åŒæ­¥åŠ è½½</strong>ï¼šCommonJSæ¨¡å—æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œè¿™åœ¨æœåŠ¡ç«¯ç¯å¢ƒä¸­æ˜¯åˆç†çš„ï¼Œå› ä¸ºæ–‡ä»¶ç³»ç»Ÿé€šå¸¸æ˜¯æœ¬åœ°çš„ï¼Œè¯»å–é€Ÿåº¦å¿«ã€‚ä½†åœ¨æµè§ˆå™¨ç«¯ä¸é€‚ç”¨ï¼Œå› ä¸ºç½‘ç»œåŠ è½½æ˜¯å¼‚æ­¥çš„ï¼ŒCommonJSå› æ­¤ä¸é€‚ç”¨äºå‰ç«¯æ¨¡å—åŒ–ã€‚</p></li><li><p><strong>æ¨¡å—ä½œç”¨åŸŸ</strong>ï¼šCommonJSæ¨¡å—ä¼šä¸ºæ¯ä¸ªæ–‡ä»¶åˆ›å»ºç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œå› æ­¤ä¸ä¼šæ±¡æŸ“å…¨å±€å‘½åç©ºé—´ã€‚æ¨¡å—å†…å®šä¹‰çš„å˜é‡æˆ–å‡½æ•°ä¸ä¼šæ³„éœ²åˆ°å…¶ä»–æ¨¡å—ã€‚</p></li><li><p><strong>åœ¨Node.jsä¸­çš„åº”ç”¨</strong>ï¼šNode.jséµå¾ªCommonJSè§„èŒƒï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åˆ›å»ºæ¨¡å—åŒ–ä»£ç ç»“æ„ã€‚CommonJSé€‚åˆNode.jsåº”ç”¨çš„æ¨¡å—åŒ–å’Œä¾èµ–ç®¡ç†ï¼Œä½†éšç€ECMAScriptæ¨¡å—ï¼ˆESMï¼‰çš„æ ‡å‡†åŒ–ï¼ŒNode.jsç°å·²æ”¯æŒESMæ ‡å‡†ã€‚</p></li></ol><h2 id="CommonJSä¸­requireæ˜¯æ€ä¹ˆå®ç°çš„"><a href="#CommonJSä¸­requireæ˜¯æ€ä¹ˆå®ç°çš„" class="headerlink" title="CommonJSä¸­requireæ˜¯æ€ä¹ˆå®ç°çš„"></a>CommonJSä¸­requireæ˜¯æ€ä¹ˆå®ç°çš„</h2><p>åœ¨CommonJSä¸­ï¼Œ<code>require</code>çš„å®ç°æ˜¯é€šè¿‡Node.jsçš„<code>Module</code>ç³»ç»Ÿæ¥ç®¡ç†å’ŒåŠ è½½æ¨¡å—çš„ã€‚<code>require</code>æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åŠ è½½æ¨¡å—ã€è§£æä¾èµ–ã€ç¼“å­˜å·²åŠ è½½çš„æ¨¡å—ï¼Œä»è€Œç¡®ä¿æ¨¡å—çš„é«˜æ•ˆåŠ è½½ã€‚ä¸‹é¢æ˜¯<code>require</code>çš„å®ç°åŸç†åˆ†è§£ï¼š</p><h3 id="1-è·¯å¾„è§£æ"><a href="#1-è·¯å¾„è§£æ" class="headerlink" title="1. è·¯å¾„è§£æ"></a>1. <strong>è·¯å¾„è§£æ</strong></h3><ul><li><code>require</code>é¦–å…ˆä¼šè§£ææ¨¡å—çš„è·¯å¾„ï¼Œä»¥ç¡®å®šè¯¥è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ä½ç½®ã€‚</li><li>å¦‚æœæ˜¯æ ¸å¿ƒæ¨¡å—ï¼ˆå¦‚<code>fs</code>ã€<code>path</code>ç­‰ï¼‰ï¼ŒNode.jsä¼šç›´æ¥åŠ è½½è¿™äº›æ¨¡å—ï¼Œå› ä¸ºå®ƒä»¬å†…ç½®åœ¨Node.jsä¸­ã€‚</li><li>å¦‚æœæ˜¯è‡ªå®šä¹‰æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹åº“ï¼ŒNode.jsä¼šåœ¨<code>node_modules</code>ç›®å½•ä¸­æŸ¥æ‰¾æŒ‡å®šæ¨¡å—ã€‚</li><li>Node.jsçš„è·¯å¾„è§£æè§„åˆ™æ˜¯å…ˆæŸ¥æ‰¾æœ¬åœ°æ–‡ä»¶ï¼Œç„¶åæŸ¥æ‰¾<code>node_modules</code>ï¼Œå¹¶éµå¾ªç›®å½•å±‚çº§æŸ¥æ‰¾ï¼ˆä»å½“å‰ç›®å½•é€å±‚å¾€ä¸Šï¼‰ã€‚</li></ul><h3 id="2-æ¨¡å—ç¼“å­˜"><a href="#2-æ¨¡å—ç¼“å­˜" class="headerlink" title="2. æ¨¡å—ç¼“å­˜"></a>2. <strong>æ¨¡å—ç¼“å­˜</strong></h3><ul><li>Node.jsä¼šç¼“å­˜å·²ç»åŠ è½½çš„æ¨¡å—ï¼Œä¿å­˜åœ¨<code>require.cache</code>å¯¹è±¡ä¸­ã€‚ç¼“å­˜çš„æ¨¡å—æ˜¯ä¸€ä¸ª<code>Module</code>å¯¹è±¡ï¼Œå…¶<code>exports</code>å±æ€§åŒ…å«æ¨¡å—çš„å¯¼å‡ºå†…å®¹ã€‚</li><li>å¦‚æœæ¨¡å—å·²ç»åŠ è½½å¹¶å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œ<code>require</code>ä¼šç›´æ¥ä»ç¼“å­˜è¿”å›å¯¼å‡ºçš„å†…å®¹ï¼Œé¿å…é‡å¤åŠ è½½ã€‚</li></ul><h3 id="3-åˆ›å»ºModuleå¯¹è±¡"><a href="#3-åˆ›å»ºModuleå¯¹è±¡" class="headerlink" title="3. åˆ›å»ºModuleå¯¹è±¡"></a>3. <strong>åˆ›å»ºModuleå¯¹è±¡</strong></h3><ul><li>å¦‚æœæ¨¡å—æ²¡æœ‰è¢«ç¼“å­˜ï¼ŒNode.jsä¼šä¸ºè¯¥æ¨¡å—åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Module</code>å¯¹è±¡ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable language_">module</span> = <span class="keyword">new</span> <span class="title class_">Module</span>(filename);</span><br></pre></td></tr></table></figure></li><li>è¿™ä¸ª<code>Module</code>å¯¹è±¡åŒ…å«<code>id</code>ã€<code>filename</code>ã€<code>loaded</code>å’Œ<code>exports</code>ç­‰å±æ€§ï¼Œç”¨æ¥è¡¨ç¤ºæ¨¡å—çš„å”¯ä¸€æ ‡è¯†ã€æ–‡ä»¶è·¯å¾„ã€åŠ è½½çŠ¶æ€ã€å¯¼å‡ºå¯¹è±¡ç­‰ã€‚</li></ul><h3 id="4-åŠ è½½æ¨¡å—å¹¶æ‰§è¡Œ"><a href="#4-åŠ è½½æ¨¡å—å¹¶æ‰§è¡Œ" class="headerlink" title="4. åŠ è½½æ¨¡å—å¹¶æ‰§è¡Œ"></a>4. <strong>åŠ è½½æ¨¡å—å¹¶æ‰§è¡Œ</strong></h3><ul><li><code>require</code>ä¼šè¯»å–æ¨¡å—æ–‡ä»¶å†…å®¹ï¼Œç„¶åå°†ä»£ç åŒ…è£¹åœ¨ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ä¸­ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶<code>exports</code>ã€<code>require</code>ã€<code>module</code>ã€<code>__filename</code>å’Œ<code>__dirname</code>äº”ä¸ªå‚æ•°ï¼Œä»è€Œç¡®ä¿æ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚</li><li>ä¾‹å¦‚ï¼Œå‡è®¾æ¨¡å—ä»£ç æ˜¯ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">add</span>: <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>åŠ è½½æ—¶ï¼ŒNode.jsä¼šå°†å…¶è½¬æ¢ä¸ºå¦‚ä¸‹ç»“æ„ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, <span class="built_in">require</span>, <span class="variable language_">module</span>, __filename, __dirname</span>) &#123;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">add</span>: <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><code>require</code>æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå°†æ‰§è¡Œç»“æœèµ‹å€¼ç»™<code>module.exports</code>ã€‚æ‰§è¡Œå®Œåï¼Œ<code>module.exports</code>å°±åŒ…å«äº†æ¨¡å—çš„å¯¼å‡ºå†…å®¹ã€‚</li></ul><h3 id="5-è¿”å›module-exports"><a href="#5-è¿”å›module-exports" class="headerlink" title="5. è¿”å›module.exports"></a>5. <strong>è¿”å›module.exports</strong></h3><ul><li>æ‰§è¡Œå®Œæˆåï¼Œ<code>require</code>å‡½æ•°è¿”å›<code>module.exports</code>çš„å†…å®¹ã€‚å…¶ä»–æ¨¡å—å¯ä»¥é€šè¿‡è°ƒç”¨<code>require</code>è®¿é—®è¯¥æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚</li></ul><h3 id="6-å¾ªç¯ä¾èµ–å¤„ç†"><a href="#6-å¾ªç¯ä¾èµ–å¤„ç†" class="headerlink" title="6. å¾ªç¯ä¾èµ–å¤„ç†"></a>6. <strong>å¾ªç¯ä¾èµ–å¤„ç†</strong></h3><ul><li>å¦‚æœæ¨¡å—Aå’Œæ¨¡å—Bå­˜åœ¨å¾ªç¯ä¾èµ–ï¼ŒNode.jsä¼šåœ¨åŠ è½½æ—¶åˆ›å»ºä¸€ä¸ªæœªå®Œæˆçš„<code>module.exports</code>å¯¹è±¡æ”¾å…¥ç¼“å­˜ï¼Œä½¿å¾—ç›¸äº’ä¾èµ–çš„æ¨¡å—å¯ä»¥è®¿é—®æœªå®Œæˆçš„å†…å®¹ï¼Œä»è€Œé¿å…æ­»å¾ªç¯ã€‚</li></ul><h3 id="ç®€åŒ–ç‰ˆä»£ç ç¤ºä¾‹"><a href="#ç®€åŒ–ç‰ˆä»£ç ç¤ºä¾‹" class="headerlink" title="ç®€åŒ–ç‰ˆä»£ç ç¤ºä¾‹"></a>ç®€åŒ–ç‰ˆä»£ç ç¤ºä¾‹</h3><p>ä»¥ä¸‹ä»£ç æ˜¯Node.jsä¸­<code>require</code>å®ç°çš„ç®€åŒ–ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€åŒ–çš„ CommonJS require å®ç°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Module</span> = <span class="keyword">function</span> (<span class="params">filename</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">filename</span> = filename;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">exports</span> = &#123;&#125;; <span class="comment">// å¯¼å‡ºå¯¹è±¡</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">loaded</span> = <span class="literal">false</span>; <span class="comment">// åŠ è½½çŠ¶æ€</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Module</span>.<span class="property">_cache</span> = &#123;&#125;; <span class="comment">// æ¨¡å—ç¼“å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Module</span>.<span class="property">_load</span> = <span class="keyword">function</span> (<span class="params">filename</span>) &#123;</span><br><span class="line">  <span class="comment">// æ£€æŸ¥ç¼“å­˜</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Module</span>.<span class="property">_cache</span>[filename]) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Module</span>.<span class="property">_cache</span>[filename].<span class="property">exports</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ›å»ºæ–°çš„æ¨¡å—å¹¶ç¼“å­˜</span></span><br><span class="line">  <span class="keyword">const</span> <span class="variable language_">module</span> = <span class="keyword">new</span> <span class="title class_">Module</span>(filename);</span><br><span class="line">  <span class="title class_">Module</span>.<span class="property">_cache</span>[filename] = <span class="variable language_">module</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯»å–æ–‡ä»¶å†…å®¹å¹¶åŒ…è£…ä¸ºå‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> wrappedSrc = <span class="string">`(function(exports, require, module, __filename, __dirname) &#123; <span class="subst">$&#123;readFileSync(filename)&#125;</span> \n&#125;)`</span>;</span><br><span class="line">  <span class="keyword">const</span> compiledWrapper = <span class="built_in">eval</span>(wrappedSrc);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ¨¡å—å‡½æ•°</span></span><br><span class="line">  <span class="title function_">compiledWrapper</span>(<span class="variable language_">module</span>.<span class="property">exports</span>, <span class="built_in">require</span>, <span class="variable language_">module</span>, filename, <span class="title function_">dirname</span>(filename));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®¾ç½®åŠ è½½å®ŒæˆçŠ¶æ€</span></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">loaded</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">require</span>(<span class="params">filename</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Module</span>.<span class="title function_">_load</span>(filename);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><code>require</code>çš„æ ¸å¿ƒåœ¨äºä»¥ä¸‹å‡ æ­¥ï¼š</p><ol><li><strong>è§£æè·¯å¾„</strong>ä»¥æ‰¾åˆ°æ¨¡å—æ–‡ä»¶ã€‚</li><li><strong>æ£€æŸ¥ç¼“å­˜</strong>ä»¥é¿å…é‡å¤åŠ è½½ã€‚</li><li><strong>åˆ›å»ºå¹¶ç¼“å­˜æ¨¡å—å¯¹è±¡</strong>ï¼Œé˜²æ­¢å¾ªç¯ä¾èµ–ã€‚</li><li><strong>åŒ…è£…å’Œæ‰§è¡Œä»£ç </strong>ä»¥æä¾›æ¨¡å—ç‹¬ç«‹ä½œç”¨åŸŸã€‚</li><li><strong>è¿”å›module.exports</strong>çš„å†…å®¹ä¾›è°ƒç”¨æ–¹ä½¿ç”¨ã€‚</li></ol><p>è¿™å°±æ˜¯CommonJSä¸­<code>require</code>çš„åŸºæœ¬å®ç°é€»è¾‘ï¼Œé€šè¿‡ç¼“å­˜ã€ä½œç”¨åŸŸéš”ç¦»ç­‰æœºåˆ¶ï¼Œç¡®ä¿æ¨¡å—çš„é«˜æ•ˆã€ç‹¬ç«‹è¿è¡Œã€‚</p><h2 id="CommonJSå’ŒESMçš„åŒºåˆ«ï¼š"><a href="#CommonJSå’ŒESMçš„åŒºåˆ«ï¼š" class="headerlink" title="CommonJSå’ŒESMçš„åŒºåˆ«ï¼š"></a>CommonJSå’ŒESMçš„åŒºåˆ«ï¼š</h2><ul><li><strong>å¯¼å…¥&#x2F;å¯¼å‡ºè¯­æ³•</strong>ï¼šCommonJSä½¿ç”¨<code>require</code>å’Œ<code>module.exports</code>ï¼Œè€ŒESMä½¿ç”¨<code>import</code>å’Œ<code>export</code>ã€‚</li><li><strong>åŠ è½½æ–¹å¼</strong>ï¼šCommonJSæ˜¯åŒæ­¥åŠ è½½ï¼ŒESMæ”¯æŒå¼‚æ­¥åŠ è½½ã€‚</li><li><strong>æ‰§è¡Œæ—¶æœº</strong>ï¼šCommonJSæ¨¡å—åœ¨åŠ è½½æ—¶ç«‹å³æ‰§è¡Œï¼ŒESMæ¨¡å—åˆ™åœ¨ç¼–è¯‘æ—¶é™æ€åˆ†æä¾èµ–å…³ç³»ã€‚</li></ul><p>æ€»ä½“æ¥è¯´ï¼ŒCommonJSæ˜¯Node.jsä¸­å¸¸è§çš„æ¨¡å—åŒ–è§„èŒƒï¼Œå¯¹æœåŠ¡ç«¯å¼€å‘å°¤å…¶é‡è¦ï¼Œè€Œåœ¨å‰ç«¯å¼€å‘ä¸­æ›´æ¨èä½¿ç”¨ESæ¨¡å—åŒ–ï¼ˆESMï¼‰æ ‡å‡†ã€‚</p><h2 id="ESMæ˜¯ä»€ä¹ˆ"><a href="#ESMæ˜¯ä»€ä¹ˆ" class="headerlink" title="ESMæ˜¯ä»€ä¹ˆ"></a>ESMæ˜¯ä»€ä¹ˆ</h2><p>ESMï¼ˆECMAScript Moduleï¼‰æ˜¯JavaScriptåœ¨ECMAScript 6ï¼ˆES6ï¼‰æ ‡å‡†ä¸­å¼•å…¥çš„æ¨¡å—ç³»ç»Ÿï¼Œä¹Ÿç§°ä¸ºESæ¨¡å—ã€‚å®ƒä¸ºJavaScriptæä¾›äº†ä¸€ç§å®˜æ–¹ã€æ ‡å‡†åŒ–çš„æ¨¡å—åŒ–æ–¹å¼ï¼Œåœ¨æµè§ˆå™¨å’ŒNode.jsç¯å¢ƒä¸­éƒ½æ”¯æŒã€‚ESMè§£å†³äº†JavaScriptæ—©æœŸæ¨¡å—åŒ–è§„èŒƒï¼ˆå¦‚CommonJSã€AMDï¼‰å­˜åœ¨çš„è¯¸å¤šé—®é¢˜ï¼Œå¹¶å¼•å…¥äº†ä¸€äº›é‡è¦çš„æ–°ç‰¹æ€§ã€‚</p><h3 id="ESMçš„ç‰¹ç‚¹å’Œè¯­æ³•"><a href="#ESMçš„ç‰¹ç‚¹å’Œè¯­æ³•" class="headerlink" title="ESMçš„ç‰¹ç‚¹å’Œè¯­æ³•"></a>ESMçš„ç‰¹ç‚¹å’Œè¯­æ³•</h3><ol><li><p><strong>é™æ€å¯¼å…¥å’Œå¯¼å‡º</strong></p><ul><li><p>ESMæ”¯æŒé™æ€åˆ†æï¼Œè¿™æ„å‘³ç€åœ¨ç¼–è¯‘é˜¶æ®µï¼ŒJavaScriptå¼•æ“å°±èƒ½ç¡®å®šæ¨¡å—ä¾èµ–å…³ç³»ï¼Œè€Œä¸æ˜¯åƒCommonJSé‚£æ ·åŠ¨æ€åŠ è½½ã€‚è¿™ç§é™æ€ç»“æ„æœ‰åŠ©äºæ€§èƒ½ä¼˜åŒ–å’Œä»£ç æ£€æŸ¥ã€‚</p></li><li><p><strong>å¯¼å‡º</strong>ä½¿ç”¨<code>export</code>å…³é”®å­—ï¼Œæ”¯æŒå‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// named export</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">subtract</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default export</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>å¯¼å…¥</strong>ä½¿ç”¨<code>import</code>å…³é”®å­—ï¼Œå¯ä»¥é€‰æ‹©å¯¼å…¥æ¨¡å—çš„éƒ¨åˆ†å†…å®¹ï¼Œæˆ–è€…ç›´æ¥å¯¼å…¥é»˜è®¤å¯¼å‡ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; add, subtract &#125; <span class="keyword">from</span> <span class="string">&quot;./math.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> multiply <span class="keyword">from</span> <span class="string">&quot;./math.js&quot;</span>;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ”¯æŒå¼‚æ­¥åŠ è½½</strong></p><ul><li>åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼ŒESæ¨¡å—å¯ä»¥å¼‚æ­¥åŠ è½½ï¼Œä¸”åœ¨æ¨¡å—ä¸­å¯ä»¥ä½¿ç”¨<code>&lt;script type=&quot;module&quot;&gt;</code>æ ‡ç­¾åŠ è½½è„šæœ¬ï¼Œä¸”æ¨¡å—é»˜è®¤æ˜¯å¼‚æ­¥åŠ è½½çš„ã€‚è¿™ä½¿å¾—ESMåœ¨æµè§ˆå™¨ç«¯æ¯”CommonJSæ›´é«˜æ•ˆã€‚</li><li>ä¾‹å¦‚ï¼Œ<code>import()</code>åŠ¨æ€å¯¼å…¥å‡½æ•°å…è®¸åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—ï¼Œæ˜¯ä¸€ç§éå¸¸çµæ´»çš„ç”¨æ³•ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">&quot;./math.js&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="variable language_">module</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">module</span>.<span class="title function_">add</span>(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ¨¡å—ä½œç”¨åŸŸ</strong></p><ul><li>ESMæ¨¡å—ä»£ç é»˜è®¤åœ¨æ¨¡å—ä½œç”¨åŸŸå†…æ‰§è¡Œï¼Œä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸã€‚</li><li>ESMæ¨¡å—ä¸­çš„é¡¶å±‚<code>this</code>å€¼ä¸º<code>undefined</code>ï¼Œé¿å…äº†å˜é‡æ±¡æŸ“ã€‚</li></ul></li><li><p><strong>æµè§ˆå™¨å’ŒNode.jsçš„æ”¯æŒ</strong></p><ul><li>æµè§ˆå™¨åŸç”Ÿæ”¯æŒESMï¼Œä¸éœ€è¦ä»»ä½•å·¥å…·æˆ–åº“å³å¯ç›´æ¥åŠ è½½ã€‚</li><li>Node.js 12åŠä»¥ä¸Šç‰ˆæœ¬ä¹Ÿæ”¯æŒESæ¨¡å—ï¼ˆæ–‡ä»¶åç¼€ä¸º<code>.mjs</code>ï¼Œæˆ–åœ¨<code>package.json</code>ä¸­æŒ‡å®š<code>&quot;type&quot;: &quot;module&quot;</code>ï¼‰ã€‚è¿™ä½¿å¾—ESMæˆä¸ºäº†è·¨å¹³å°çš„æ ‡å‡†æ¨¡å—åŒ–æ–¹æ¡ˆã€‚</li></ul></li><li><p><strong>Tree Shaking</strong></p><ul><li>ç”±äºESMæ˜¯é™æ€ç»“æ„çš„æ¨¡å—ï¼Œæ„å»ºå·¥å…·ï¼ˆå¦‚Webpackã€Rollupï¼‰å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µä¼˜åŒ–ä»£ç ï¼Œåˆ é™¤æœªä½¿ç”¨çš„å¯¼å‡ºï¼ˆTree Shakingï¼‰ï¼Œå‡å°‘æœ€ç»ˆæ‰“åŒ…æ–‡ä»¶çš„å¤§å°ã€‚</li></ul></li></ol><h3 id="ESMä¸CommonJSçš„åŒºåˆ«"><a href="#ESMä¸CommonJSçš„åŒºåˆ«" class="headerlink" title="ESMä¸CommonJSçš„åŒºåˆ«"></a>ESMä¸CommonJSçš„åŒºåˆ«</h3><table><thead><tr><th>ç‰¹æ€§</th><th>ESM</th><th>CommonJS</th></tr></thead><tbody><tr><td>å¯¼å…¥&#x2F;å¯¼å‡ºè¯­æ³•</td><td><code>import</code> &#x2F; <code>export</code></td><td><code>require</code> &#x2F; <code>module.exports</code></td></tr><tr><td>ä¾èµ–è§£ææ—¶é—´</td><td>é™æ€è§£æ</td><td>åŠ¨æ€è§£æ</td></tr><tr><td>åŠ è½½æ–¹å¼</td><td>å¼‚æ­¥åŠ è½½ï¼ˆæµè§ˆå™¨ç«¯ï¼‰</td><td>åŒæ­¥åŠ è½½</td></tr><tr><td>ç¼“å­˜æœºåˆ¶</td><td>ç¼“å­˜ï¼Œä½†ä¸å¯å˜</td><td>ç¼“å­˜ï¼Œä½†å†…å®¹å¯å˜</td></tr><tr><td>é¡¶å±‚<code>this</code></td><td><code>undefined</code></td><td><code>global</code>ï¼ˆåœ¨Node.jsä¸­ï¼‰</td></tr><tr><td>Tree Shakingæ”¯æŒ</td><td>æ”¯æŒï¼ˆä¾¿äºç¼–è¯‘ä¼˜åŒ–ï¼‰</td><td>ä¸æ”¯æŒ</td></tr></tbody></table><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>math.js</code>æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// math.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">subtract</span> = (<span class="params">a, b</span>) =&gt; a - b;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ESMå¯¼å…¥è¯¥æ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; add, subtract &#125; <span class="keyword">from</span> <span class="string">&quot;./math.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> multiply <span class="keyword">from</span> <span class="string">&quot;./math.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º5</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">subtract</span>(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">multiply</span>(<span class="number">4</span>, <span class="number">5</span>)); <span class="comment">// è¾“å‡º20</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ESMæ¨¡å—ç³»ç»Ÿåœ¨JavaScriptç”Ÿæ€ç³»ç»Ÿä¸­é€æ¸æˆä¸ºä¸»æµï¼Œå› å…¶å…·æœ‰é™æ€åˆ†æã€å¼‚æ­¥åŠ è½½ã€Tree Shakingæ”¯æŒç­‰ä¼˜åŠ¿ï¼Œæˆä¸ºäº†ç°ä»£JavaScriptå¼€å‘ä¸­çš„é‡è¦æ¨¡å—åŒ–å·¥å…·ã€‚</p><h2 id="module-exportså’Œexportsçš„åŒºåˆ«"><a href="#module-exportså’Œexportsçš„åŒºåˆ«" class="headerlink" title="module.exportså’Œexportsçš„åŒºåˆ«"></a>module.exportså’Œexportsçš„åŒºåˆ«</h2><p>åœ¨Node.jsä¸­ï¼Œ<code>module.exports</code>å’Œ<code>exports</code>éƒ½æ˜¯ç”¨äºæ¨¡å—å¯¼å‡ºçš„å¯¹è±¡ï¼Œä½†å®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›ç»†å¾®çš„åŒºåˆ«ã€‚ç†è§£è¿™äº›åŒºåˆ«å¯ä»¥å¸®åŠ©ä½ é¿å…ä¸€äº›å¸¸è§çš„é”™è¯¯ã€‚</p><h3 id="1-é»˜è®¤å¼•ç”¨å…³ç³»"><a href="#1-é»˜è®¤å¼•ç”¨å…³ç³»" class="headerlink" title="1. é»˜è®¤å¼•ç”¨å…³ç³»"></a>1. <strong>é»˜è®¤å¼•ç”¨å…³ç³»</strong></h3><ul><li><code>exports</code>å’Œ<code>module.exports</code>åœ¨æ¨¡å—å¼€å§‹æ—¶æ˜¯æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>exports</code>æ˜¯<code>module.exports</code>çš„å¼•ç”¨ã€‚</li><li>ä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒä»¬ç­‰ä»·äºï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">exports</span> = (<span class="variable language_">module</span>.<span class="property">exports</span> = &#123;&#125;);</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-å¯¼å‡ºæ•´ä¸ªå¯¹è±¡"><a href="#2-å¯¼å‡ºæ•´ä¸ªå¯¹è±¡" class="headerlink" title="2. å¯¼å‡ºæ•´ä¸ªå¯¹è±¡"></a>2. <strong>å¯¼å‡ºæ•´ä¸ªå¯¹è±¡</strong></h3><ul><li><code>module.exports</code>æ˜¯çœŸæ­£å¯¼å‡ºçš„å¯¹è±¡ï¼Œ<code>require</code>çš„è¿”å›å€¼æœ€ç»ˆæ˜¯<code>module.exports</code>çš„å€¼ã€‚</li><li>å¦‚æœæƒ³è¦å¯¼å‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œåº”ç›´æ¥èµ‹å€¼ç»™<code>module.exports</code>ï¼Œè€Œä¸æ˜¯<code>exports</code>ï¼Œå¦åˆ™ä¸ä¼šç”Ÿæ•ˆã€‚</li><li>ä¾‹å¦‚ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// æˆ–è€…å¯¼å‡ºå‡½æ•°</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li>é”™è¯¯ç¤ºä¾‹ï¼Œå¦‚æœç›´æ¥ä¿®æ”¹<code>exports</code>ï¼Œ<code>module.exports</code>ä¸ä¼šå—å½±å“ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span> = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// requireæ—¶è¿”å›çš„æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œè€Œä¸æ˜¯&#123; foo: &#x27;bar&#x27; &#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="3-æ·»åŠ å±æ€§æˆ–æ–¹æ³•"><a href="#3-æ·»åŠ å±æ€§æˆ–æ–¹æ³•" class="headerlink" title="3. æ·»åŠ å±æ€§æˆ–æ–¹æ³•"></a>3. <strong>æ·»åŠ å±æ€§æˆ–æ–¹æ³•</strong></h3><ul><li><p>å¦‚æœåªæ˜¯æƒ³ç»™æ¨¡å—æ·»åŠ ä¸€äº›å±æ€§æˆ–æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨<code>exports</code>ä¸Šæ·»åŠ å±æ€§ï¼Œå› ä¸º<code>exports</code>æ˜¯<code>module.exports</code>çš„å¼•ç”¨ã€‚</p></li><li><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•ä¸€ï¼šä½¿ç”¨ exports</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•äºŒï¼šä½¿ç”¨ module.exports</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-è¦†ç›–-vs-æ‰©å±•"><a href="#4-è¦†ç›–-vs-æ‰©å±•" class="headerlink" title="4. è¦†ç›– vs. æ‰©å±•"></a>4. <strong>è¦†ç›– vs. æ‰©å±•</strong></h3><ul><li>å½“éœ€è¦<strong>è¦†ç›–æ•´ä¸ªå¯¼å‡ºå¯¹è±¡</strong>æ—¶ï¼Œå¿…é¡»ä½¿ç”¨<code>module.exports</code>ã€‚</li><li>è€Œå½“åªæ˜¯æƒ³åœ¨ç°æœ‰çš„å¯¼å‡ºå¯¹è±¡ä¸Š<strong>æ·»åŠ å±æ€§æˆ–æ–¹æ³•</strong>æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>exports</code>æˆ–<code>module.exports</code>ï¼Œæ•ˆæœç›¸åŒã€‚</li></ul><h3 id="ä¾‹å­æ¯”è¾ƒ"><a href="#ä¾‹å­æ¯”è¾ƒ" class="headerlink" title="ä¾‹å­æ¯”è¾ƒ"></a>ä¾‹å­æ¯”è¾ƒ</h3><p>å‡è®¾æœ‰ä¸€ä¸ªæ¨¡å—<code>myModule.js</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯å†™æ³•</span></span><br><span class="line"><span class="built_in">exports</span> = &#123; <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span> &#125;; <span class="comment">// æ­¤æ—¶ `exports` ä¸å†æŒ‡å‘ `module.exports`ï¼Œä¸ä¼šç”Ÿæ•ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®å†™æ³•</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å±æ€§çš„æ­£ç¡®å†™æ³•</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>; <span class="comment">// æˆ–è€… module.exports.foo = &#x27;bar&#x27;;</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><code>module.exports</code>æ˜¯çœŸæ­£çš„å¯¼å‡ºå¯¹è±¡ã€‚</li><li><code>exports</code>åªæ˜¯<code>module.exports</code>çš„å¼•ç”¨ï¼Œä¸»è¦ç”¨äºè¾…åŠ©å¯¼å‡ºå±æ€§æˆ–æ–¹æ³•ã€‚</li><li>è¦†ç›–æ•´ä¸ªå¯¼å‡ºå¯¹è±¡æ—¶ä½¿ç”¨<code>module.exports</code>ï¼›ä»…æ·»åŠ å±æ€§æˆ–æ–¹æ³•æ—¶ä¸¤è€…çš†å¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Angularçš„æ¨¡æ‹Ÿé¢è¯•</title>
      <link href="/2024/10/26/front-end/angular-mock-interview/"/>
      <url>/2024/10/26/front-end/angular-mock-interview/</url>
      
        <content type="html"><![CDATA[<ul><li></li></ul><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡æ˜¯é’ˆå¯¹angularå‰ç«¯çš„æ¨¡æ‹Ÿé¢è¯•</p><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><h2 id="å‰ç«¯CSSçš„ä¼˜å…ˆçº§"><a href="#å‰ç«¯CSSçš„ä¼˜å…ˆçº§" class="headerlink" title="å‰ç«¯CSSçš„ä¼˜å…ˆçº§"></a>å‰ç«¯CSSçš„ä¼˜å…ˆçº§</h2><p>åœ¨ CSS ä¸­ï¼Œé€‰æ‹©å™¨ç”¨äºé€‰æ‹© HTML å…ƒç´ å¹¶åº”ç”¨æ ·å¼ã€‚ä¸åŒé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ï¼ˆæƒé‡ï¼‰å†³å®šäº†æ ·å¼çš„åº”ç”¨é¡ºåºã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨é€‰æ‹©å™¨ç±»å‹åŠå…¶ä¼˜å…ˆçº§è§„åˆ™ï¼š</p><ol><li><p>CSS é€‰æ‹©å™¨ç±»å‹</p><ul><li>å…ƒç´ é€‰æ‹©å™¨ï¼šç›´æ¥é€‰æ‹© HTML å…ƒç´ ï¼Œå¦‚ divã€pã€h1ã€‚</li><li>ç±»é€‰æ‹©å™¨ï¼šé€šè¿‡ç±»åé€‰æ‹©å…ƒç´ ï¼Œä½¿ç”¨ . å‰ç¼€ï¼Œå¦‚ .boxã€‚</li><li>ID é€‰æ‹©å™¨ï¼šé€šè¿‡ ID åç§°é€‰æ‹©å…ƒç´ ï¼Œä½¿ç”¨ # å‰ç¼€ï¼Œå¦‚ #headerã€‚</li><li>å±æ€§é€‰æ‹©å™¨ï¼šé€šè¿‡å…ƒç´ å±æ€§é€‰æ‹©å…ƒç´ ï¼Œå¦‚ [type&#x3D;â€textâ€]ã€‚</li><li>ä¼ªç±»é€‰æ‹©å™¨ï¼šé€‰æ‹©ç‰¹å®šçŠ¶æ€çš„å…ƒç´ ï¼Œå¦‚ :hoverã€:focusã€‚</li><li>ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼šé€‰æ‹©å…ƒç´ çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚ ::beforeã€::afterã€‚</li><li>ç»„åˆé€‰æ‹©å™¨ï¼šé€šè¿‡å¤šç§é€‰æ‹©å™¨çš„ç»„åˆï¼Œé€‰æ‹©æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„å…ƒç´ ã€‚å¸¸è§çš„ç»„åˆç¬¦æœ‰ï¼š<ul><li>åä»£é€‰æ‹©å™¨ï¼šdiv pï¼Œé€‰æ‹© div ä¸­çš„æ‰€æœ‰ p å…ƒç´ ã€‚</li><li>å­é€‰æ‹©å™¨ï¼šdiv &gt; pï¼Œé€‰æ‹© div çš„ç›´æ¥å­å…ƒç´  pã€‚</li><li>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ï¼šh1 + pï¼Œé€‰æ‹©ç´§è·Ÿåœ¨ h1 ä¹‹åçš„ p å…ƒç´ ã€‚</li><li>é€šç”¨å…„å¼Ÿé€‰æ‹©å™¨ï¼šh1 ~ pï¼Œé€‰æ‹© h1 ä¹‹åçš„æ‰€æœ‰ p å…ƒç´ ã€‚</li></ul></li></ul></li><li><p>CSS é€‰æ‹©å™¨ä¼˜å…ˆçº§ï¼ˆæƒé‡ï¼‰è®¡ç®—è§„åˆ™<br>CSS ä¸­çš„ä¼˜å…ˆçº§ä½¿ç”¨æƒé‡å€¼è¿›è¡Œè®¡ç®—ï¼Œä»¥ç¡®å®šæ ·å¼çš„åº”ç”¨é¡ºåºã€‚æƒé‡å€¼çš„è®¡ç®—é€šå¸¸æŒ‰å››ä½æ•°æ¥è¡¨ç¤ºï¼ˆa, b, c, dï¼‰ï¼Œä¸åŒé€‰æ‹©å™¨ç±»å‹çš„æƒé‡å€¼å¦‚ä¸‹ï¼š</p><ul><li>å†…è”æ ·å¼ï¼š1000 æƒé‡ï¼Œæœ€é«˜ä¼˜å…ˆçº§ï¼ˆa&#x3D;1ï¼Œå¦‚ &lt;div style&#x3D;â€color: red;â€&gt;ï¼‰ã€‚</li><li>ID é€‰æ‹©å™¨ï¼š0100 æƒé‡ï¼Œæ¯ä¸ª ID é€‰æ‹©å™¨ä¼šä¸ºæƒé‡ b åŠ  1ã€‚</li><li>ç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ã€ä¼ªç±»é€‰æ‹©å™¨ï¼š0010 æƒé‡ï¼Œæ¯ä¸ªç±»ã€å±æ€§ã€ä¼ªç±»ä¸ºæƒé‡ c åŠ  1ã€‚</li><li>å…ƒç´ é€‰æ‹©å™¨ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼š0001 æƒé‡ï¼Œæ¯ä¸ªå…ƒç´ æˆ–ä¼ªå…ƒç´ ä¸ºæƒé‡ d åŠ  1ã€‚</li><li>é€šé…é€‰æ‹©å™¨ *ï¼šæ²¡æœ‰æƒé‡ï¼Œä¸å½±å“ä¼˜å…ˆçº§ã€‚</li></ul></li></ol><p>ä¼˜å…ˆçº§è®¡ç®—ç¤ºä¾‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#header</span> <span class="selector-class">.menu-item</span> <span class="selector-tag">a</span> çš„ä¼˜å…ˆçº§ï¼š<span class="number">0100</span> + <span class="number">0010</span> + <span class="number">0001</span> = <span class="number">0111</span></span><br><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">p</span> çš„ä¼˜å…ˆçº§ï¼š<span class="number">0001</span> + <span class="number">0001</span> = <span class="number">0002</span></span><br><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">::before</span> çš„ä¼˜å…ˆçº§ï¼š<span class="number">0001</span> + <span class="number">0001</span> = <span class="number">0002</span></span><br><span class="line"><span class="selector-class">.nav</span> <span class="selector-class">.link</span><span class="selector-pseudo">:hover</span> çš„ä¼˜å…ˆçº§ï¼š<span class="number">0010</span> + <span class="number">0010</span> = <span class="number">0020</span></span><br></pre></td></tr></table></figure><ol start="3"><li>å±‚å è§„åˆ™ï¼ˆé‡è¦æ€§ï¼‰<br>å¦‚æœå¤šä¸ªé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆåå®šä¹‰çš„æ ·å¼å°†è¦†ç›–å…ˆå®šä¹‰çš„æ ·å¼ã€‚å¦‚æœæ ·å¼å¸¦æœ‰ !important æ ‡è®°ï¼Œåˆ™ä¼šç›´æ¥è¦†ç›–å¸¸è§„æ ·å¼çš„ä¼˜å…ˆçº§ã€‚å¤šä¸ª !important æ ·å¼å†²çªæ—¶ï¼Œéµå¾ªä¼˜å…ˆçº§å’Œæºé¡ºåºï¼ˆåè€…è¦†ç›–å‰è€…ï¼‰ã€‚</li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼šå†…è”æ ·å¼ &gt; ID é€‰æ‹©å™¨ &gt; ç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ã€ä¼ªç±»é€‰æ‹©å™¨ &gt; å…ƒç´ é€‰æ‹©å™¨ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨ã€‚<br>ä½¿ç”¨ !important å¯ä»¥æé«˜æ ·å¼ä¼˜å…ˆçº§ï¼Œä½†åº”è°¨æ…ä½¿ç”¨ï¼Œä»¥å…é™ä½ä»£ç å¯ç»´æŠ¤æ€§ã€‚</p><h2 id="CSSä¸»é¢˜åˆ‡æ¢çš„æ€è·¯ï¼Œä»£ç æ€ä¹ˆåšå…¨å±€çš„å˜é‡"><a href="#CSSä¸»é¢˜åˆ‡æ¢çš„æ€è·¯ï¼Œä»£ç æ€ä¹ˆåšå…¨å±€çš„å˜é‡" class="headerlink" title="CSSä¸»é¢˜åˆ‡æ¢çš„æ€è·¯ï¼Œä»£ç æ€ä¹ˆåšå…¨å±€çš„å˜é‡"></a>CSSä¸»é¢˜åˆ‡æ¢çš„æ€è·¯ï¼Œä»£ç æ€ä¹ˆåšå…¨å±€çš„å˜é‡</h2><p>æ–¹æ¡ˆä¸€ï¼š</p><p>åœ¨ Angular ä¸­å®ç° CSS ä¸»é¢˜åˆ‡æ¢çš„æ€è·¯ï¼Œé€šå¸¸åˆ©ç”¨CSS å˜é‡å’Œå…¨å±€æ ·å¼ï¼Œå¹¶ç»“åˆ Angular çš„æœåŠ¡æ¥ç®¡ç†å’Œåˆ‡æ¢ä¸»é¢˜ã€‚å¯ä»¥é€šè¿‡åŠ¨æ€åˆ‡æ¢ data-theme å±æ€§ï¼Œå®ç°å…¨å±€çš„ä¸»é¢˜åˆ‡æ¢ã€‚</p><p>æ–¹æ¡ˆäºŒï¼š</p><p>ä½¿ç”¨scsså’Œåˆ‡æ¢linkçš„æ–¹å¼ã€‚</p><p>æ–¹æ¡ˆä¸‰ï¼š</p><p>ä½¿ç”¨css in jsçš„æ€è·¯ï¼Œä¸ä¸€å®šæ”¯æŒangular</p><h2 id="ç½‘é¡µçš„æš—é»‘æ¨¡å¼æ€ä¹ˆå®ç°"><a href="#ç½‘é¡µçš„æš—é»‘æ¨¡å¼æ€ä¹ˆå®ç°" class="headerlink" title="ç½‘é¡µçš„æš—é»‘æ¨¡å¼æ€ä¹ˆå®ç°"></a>ç½‘é¡µçš„æš—é»‘æ¨¡å¼æ€ä¹ˆå®ç°</h2><p>å®ç°ç½‘é¡µçš„æš—é»‘æ¨¡å¼ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨<strong>CSS å˜é‡</strong>ã€<strong>åª’ä½“æŸ¥è¯¢</strong>ã€<strong>JavaScript</strong> ç­‰æ–¹æ³•æ¥è¿›è¡Œåˆ‡æ¢ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„å®ç°æ–¹å¼ï¼š</p><h3 id="1-ä½¿ç”¨-CSS-å˜é‡å®ç°æš—é»‘æ¨¡å¼"><a href="#1-ä½¿ç”¨-CSS-å˜é‡å®ç°æš—é»‘æ¨¡å¼" class="headerlink" title="1. ä½¿ç”¨ CSS å˜é‡å®ç°æš—é»‘æ¨¡å¼"></a>1. ä½¿ç”¨ CSS å˜é‡å®ç°æš—é»‘æ¨¡å¼</h3><p>è¿™ç§æ–¹å¼é€šè¿‡å®šä¹‰ CSS å˜é‡æ¥æ§åˆ¶ä¸»é¢˜é¢œè‰²ï¼Œå†ä½¿ç”¨ JavaScript åˆ‡æ¢ CSS å˜é‡å€¼ã€‚</p><h4 id="1-1-å®šä¹‰-CSS-å˜é‡"><a href="#1-1-å®šä¹‰-CSS-å˜é‡" class="headerlink" title="1.1 å®šä¹‰ CSS å˜é‡"></a>1.1 å®šä¹‰ CSS å˜é‡</h4><p>åœ¨ <code>:root</code> ä¸­å®šä¹‰äº®è‰²æ¨¡å¼çš„ CSS å˜é‡ï¼Œå¹¶ä¸ºæš—è‰²æ¨¡å¼è®¾ç½®ä¸€ä¸ª <code>data-theme=&quot;dark&quot;</code> å±æ€§æ—¶çš„å˜é‡å€¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®šä¹‰äº®è‰²æ¨¡å¼ */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--background-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attr">--text-color</span>: <span class="number">#000000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å®šä¹‰æš—é»‘æ¨¡å¼ */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attr">--background-color</span>: <span class="number">#1e1e1e</span>;</span><br><span class="line">  <span class="attr">--text-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½¿ç”¨å˜é‡åº”ç”¨åˆ°æ ·å¼ */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--background-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--text-color);</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">0.3s</span>, color <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-ä½¿ç”¨-JavaScript-åˆ‡æ¢ä¸»é¢˜"><a href="#1-2-ä½¿ç”¨-JavaScript-åˆ‡æ¢ä¸»é¢˜" class="headerlink" title="1.2 ä½¿ç”¨ JavaScript åˆ‡æ¢ä¸»é¢˜"></a>1.2 ä½¿ç”¨ JavaScript åˆ‡æ¢ä¸»é¢˜</h4><p>ä½¿ç”¨ JavaScript ç›‘å¬ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶ï¼Œåœ¨é¡µé¢æ ¹å…ƒç´ ä¸Šæ·»åŠ æˆ–ç§»é™¤ <code>data-theme=&quot;dark&quot;</code> å±æ€§ï¼Œåˆ‡æ¢æš—é»‘å’Œäº®è‰²æ¨¡å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ‡æ¢æš—é»‘æ¨¡å¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toggleDarkMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentTheme = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-theme&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> newTheme = currentTheme === <span class="string">&quot;dark&quot;</span> ? <span class="string">&quot;light&quot;</span> : <span class="string">&quot;dark&quot;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, newTheme);</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;theme&quot;</span>, newTheme); <span class="comment">// ä¿å­˜ç”¨æˆ·é€‰æ‹©</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line"><span class="keyword">const</span> savedTheme = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;theme&quot;</span>) || <span class="string">&quot;light&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, savedTheme);</span><br></pre></td></tr></table></figure><h4 id="1-3-ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬"><a href="#1-3-ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬" class="headerlink" title="1.3 ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬"></a>1.3 ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬</h4><p>åœ¨ HTML ä¸­æ·»åŠ ä¸€ä¸ªæŒ‰é’®æ¥åˆ‡æ¢ä¸»é¢˜ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;toggleDarkMode()&quot;</span>&gt;</span>åˆ‡æ¢æš—é»‘æ¨¡å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨åª’ä½“æŸ¥è¯¢è‡ªåŠ¨åŒ¹é…ç³»ç»Ÿä¸»é¢˜"><a href="#2-ä½¿ç”¨åª’ä½“æŸ¥è¯¢è‡ªåŠ¨åŒ¹é…ç³»ç»Ÿä¸»é¢˜" class="headerlink" title="2. ä½¿ç”¨åª’ä½“æŸ¥è¯¢è‡ªåŠ¨åŒ¹é…ç³»ç»Ÿä¸»é¢˜"></a>2. ä½¿ç”¨åª’ä½“æŸ¥è¯¢è‡ªåŠ¨åŒ¹é…ç³»ç»Ÿä¸»é¢˜</h3><p>CSS æä¾›äº†ä¸€ä¸ª <code>prefers-color-scheme</code> åª’ä½“æŸ¥è¯¢ï¼Œå¯ä»¥è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿè®¾ç½®ï¼ŒåŒ¹é…äº®è‰²æˆ–æš—é»‘æ¨¡å¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* é»˜è®¤äº®è‰²æ¨¡å¼ */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--background-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attr">--text-color</span>: <span class="number">#000000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æš—é»‘æ¨¡å¼ */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">prefers-color-scheme</span>: dark) &#123;</span><br><span class="line">  <span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--background-color</span>: <span class="number">#1e1e1e</span>;</span><br><span class="line">    <span class="attr">--text-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--background-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--text-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•ä¼šæ ¹æ®ç”¨æˆ·çš„ç³»ç»Ÿä¸»é¢˜è®¾ç½®è‡ªåŠ¨åº”ç”¨äº®è‰²æˆ–æš—é»‘æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç³»ç»Ÿè®¾ç½®ä¸­è°ƒæ•´ã€‚</p><h3 id="3-ä½¿ç”¨-CSS-å’Œ-JavaScript-ç»“åˆç”¨æˆ·é¦–é€‰é¡¹"><a href="#3-ä½¿ç”¨-CSS-å’Œ-JavaScript-ç»“åˆç”¨æˆ·é¦–é€‰é¡¹" class="headerlink" title="3. ä½¿ç”¨ CSS å’Œ JavaScript ç»“åˆç”¨æˆ·é¦–é€‰é¡¹"></a>3. ä½¿ç”¨ CSS å’Œ JavaScript ç»“åˆç”¨æˆ·é¦–é€‰é¡¹</h3><p>å¯ä»¥ç»“åˆåª’ä½“æŸ¥è¯¢å’Œ JavaScript è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿè®¾ç½®ï¼ŒåŒæ—¶æä¾›æŒ‰é’®å…è®¸ç”¨æˆ·è‡ªå®šä¹‰é€‰æ‹©ã€‚</p><h4 id="3-1-æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿä¸»é¢˜è®¾ç½®"><a href="#3-1-æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿä¸»é¢˜è®¾ç½®" class="headerlink" title="3.1 æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿä¸»é¢˜è®¾ç½®"></a>3.1 æ£€æµ‹ç”¨æˆ·ç³»ç»Ÿä¸»é¢˜è®¾ç½®</h4><p>å½“ç”¨æˆ·é¦–æ¬¡è®¿é—®ç½‘ç«™æ—¶ï¼Œæ£€æµ‹ç³»ç»Ÿä¸»é¢˜ï¼Œä¼˜å…ˆä½¿ç”¨ç”¨æˆ·ç³»ç»Ÿçš„ä¸»é¢˜åå¥½ã€‚å¦‚æœç”¨æˆ·é€‰æ‹©äº†ç‰¹å®šçš„ä¸»é¢˜ï¼Œåˆ™å°†å…¶åå¥½ä¿å­˜åˆ° <code>localStorage</code> ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initTheme</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> savedTheme = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;theme&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (savedTheme) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, savedTheme);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">&quot;(prefers-color-scheme: dark)&quot;</span>).<span class="property">matches</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, <span class="string">&quot;dark&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, <span class="string">&quot;light&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">initTheme</span>();</span><br></pre></td></tr></table></figure><h4 id="3-2-åˆ‡æ¢ä¸»é¢˜å¹¶ä¿å­˜ç”¨æˆ·é€‰æ‹©"><a href="#3-2-åˆ‡æ¢ä¸»é¢˜å¹¶ä¿å­˜ç”¨æˆ·é€‰æ‹©" class="headerlink" title="3.2 åˆ‡æ¢ä¸»é¢˜å¹¶ä¿å­˜ç”¨æˆ·é€‰æ‹©"></a>3.2 åˆ‡æ¢ä¸»é¢˜å¹¶ä¿å­˜ç”¨æˆ·é€‰æ‹©</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">toggleDarkMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentTheme = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-theme&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> newTheme = currentTheme === <span class="string">&quot;dark&quot;</span> ? <span class="string">&quot;light&quot;</span> : <span class="string">&quot;dark&quot;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-theme&quot;</span>, newTheme);</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;theme&quot;</span>, newTheme);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-HTML-ç¤ºä¾‹"><a href="#3-3-HTML-ç¤ºä¾‹" class="headerlink" title="3.3 HTML ç¤ºä¾‹"></a>3.3 HTML ç¤ºä¾‹</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;toggleDarkMode()&quot;</span>&gt;</span>åˆ‡æ¢æš—é»‘æ¨¡å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><strong>CSS å˜é‡æ³•</strong>ï¼šå®šä¹‰å˜é‡å¹¶é€šè¿‡ <code>data-theme</code> åˆ‡æ¢ï¼Œéå¸¸çµæ´»ã€‚</li><li><strong>åª’ä½“æŸ¥è¯¢</strong>ï¼šè‡ªåŠ¨é€‚åº”ç”¨æˆ·ç³»ç»Ÿä¸»é¢˜è®¾ç½®ï¼Œä¾¿äºå®ç°æ— ç¼æš—é»‘æ¨¡å¼ã€‚</li><li><strong>JavaScript ä¿å­˜ç”¨æˆ·åå¥½</strong>ï¼šåœ¨ <code>localStorage</code> ä¸­è®°å½•ç”¨æˆ·é€‰æ‹©ï¼Œæä¾›æ›´ä¸ªæ€§åŒ–çš„ä½“éªŒã€‚</li></ul><h2 id="Angular-å“ªäº›æ–¹å¼èƒ½è·å–domèŠ‚ç‚¹"><a href="#Angular-å“ªäº›æ–¹å¼èƒ½è·å–domèŠ‚ç‚¹" class="headerlink" title="Angular å“ªäº›æ–¹å¼èƒ½è·å–domèŠ‚ç‚¹"></a>Angular å“ªäº›æ–¹å¼èƒ½è·å–domèŠ‚ç‚¹</h2><p>Angular æä¾›äº†å¤šç§æ–¹å¼æ¥è·å– DOM èŠ‚ç‚¹ï¼Œæ¯ç§æ–¹å¼éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ã€‚é€‰æ‹©å“ªç§æ–¹å¼å–å†³äºå…·ä½“çš„éœ€æ±‚å’Œåœºæ™¯ã€‚</p><ul><li>ViewChild å’Œ ViewChildren: ç”¨äºè·å–æ¨¡æ¿ä¸­å®šä¹‰çš„å…ƒç´ æˆ–æŒ‡ä»¤ã€‚</li><li>ElementRef: ç”¨äºè·å–ç»„ä»¶çš„æ ¹å…ƒç´ ã€‚</li><li>@HostListener: ç”¨äºç›‘å¬å®¿ä¸»å…ƒç´ çš„äº‹ä»¶ã€‚</li><li>Renderer2: ç”¨äºåœ¨ç»„ä»¶ä¸­ç›´æ¥æ“ä½œ DOMã€‚</li><li>åŸç”ŸJavaScriptã€‚</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ ViewChildã€ViewChildren å’Œ ElementRef æ¥è·å– DOM å…ƒç´ ï¼Œå› ä¸ºå®ƒä»¬ä¸ Angular çš„å˜æ›´æ£€æµ‹æœºåˆ¶é›†æˆå¾—æ›´å¥½ã€‚</p><h2 id="Angularé‡Œé¢serviceçš„å®ç°ï¼Œserviceæ˜¯åº”ç”¨åœ¨å…¨ç”Ÿå‘½å‘¨æœŸé‡Œå—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ"><a href="#Angularé‡Œé¢serviceçš„å®ç°ï¼Œserviceæ˜¯åº”ç”¨åœ¨å…¨ç”Ÿå‘½å‘¨æœŸé‡Œå—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="Angularé‡Œé¢serviceçš„å®ç°ï¼Œserviceæ˜¯åº”ç”¨åœ¨å…¨ç”Ÿå‘½å‘¨æœŸé‡Œå—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ"></a>Angularé‡Œé¢serviceçš„å®ç°ï¼Œserviceæ˜¯åº”ç”¨åœ¨å…¨ç”Ÿå‘½å‘¨æœŸé‡Œå—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</h2><p>åœ¨ Angular ä¸­ï¼ŒæœåŠ¡ï¼ˆServiceï¼‰æ˜¯ä¸€ç§ç”¨äºæä¾›ç‰¹å®šåŠŸèƒ½ã€æ•°æ®å’Œä¸šåŠ¡é€»è¾‘çš„å•ä¾‹å¯¹è±¡ã€‚æœåŠ¡çš„è®¾è®¡å’Œå®ç°ä½¿å¾—å®ƒä»¬åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…å¯ä»¥è¢«å…±äº«å’Œé‡ç”¨ã€‚ä¸‹é¢æ˜¯å…³äº Angular æœåŠ¡çš„å®ç°åŠå…¶åœ¨å…¨ç”Ÿå‘½å‘¨æœŸä¸­çš„åº”ç”¨åŸå› çš„è¯¦ç»†è¯´æ˜ã€‚</p><h3 id="1-æœåŠ¡çš„åŸºæœ¬å®ç°"><a href="#1-æœåŠ¡çš„åŸºæœ¬å®ç°" class="headerlink" title="1. æœåŠ¡çš„åŸºæœ¬å®ç°"></a>1. æœåŠ¡çš„åŸºæœ¬å®ç°</h3><p>æœåŠ¡é€šå¸¸æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>@Injectable</code> è£…é¥°å™¨çš„ç±»ï¼Œå…è®¸å°†å…¶æ³¨å…¥åˆ°ç»„ä»¶ã€å…¶ä»–æœåŠ¡æˆ–æŒ‡ä»¤ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æœåŠ¡ç¤ºä¾‹ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>(&#123;</span><br><span class="line">  <span class="attr">providedIn</span>: <span class="string">&#x27;root&#x27;</span> <span class="comment">// è¿™é‡Œçš„ root è¡¨ç¤ºè¯¥æœåŠ¡åœ¨æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸå†…æ˜¯å•ä¾‹çš„</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ExampleService</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">data</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = <span class="string">&#x27;Hello, World!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getData</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">data</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setData</span>(<span class="attr">newData</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = newData;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†"><a href="#2-æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†" class="headerlink" title="2. æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†"></a>2. æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3><p>æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸç›¸åŒã€‚è¿™æ˜¯é€šè¿‡æä¾›æœåŠ¡çš„æ¨¡å—ä½œç”¨åŸŸæ¥å®ç°çš„ã€‚åœ¨ Angular ä¸­ï¼ŒæœåŠ¡çš„å®ä¾‹é€šå¸¸æ˜¯åœ¨æ ¹æ³¨å…¥å™¨ï¼ˆroot injectorï¼‰ä¸­åˆ›å»ºçš„ï¼Œä»è€Œä½¿å…¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«ã€‚</p><h4 id="2-1-å•ä¾‹æ¨¡å¼"><a href="#2-1-å•ä¾‹æ¨¡å¼" class="headerlink" title="2.1 å•ä¾‹æ¨¡å¼"></a>2.1 å•ä¾‹æ¨¡å¼</h4><p>ä½¿ç”¨ <code>@Injectable</code> è£…é¥°å™¨å¹¶å°† <code>providedIn</code> è®¾ç½®ä¸º <code>root</code>ï¼ŒæœåŠ¡ä¼šè¢«æ³¨å†Œä¸ºå•ä¾‹ï¼Œè¿™æ„å‘³ç€åœ¨åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸå†…åªä¼šåˆ›å»ºä¸€ä¸ªæœåŠ¡å®ä¾‹ã€‚æ‰€æœ‰æ³¨å…¥äº†è¯¥æœåŠ¡çš„ç»„ä»¶å’Œå…¶ä»–æœåŠ¡éƒ½å°†å…±äº«åŒä¸€ä¸ªå®ä¾‹ã€‚è¿™æ ·åšçš„åŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><p><strong>æ•°æ®å…±äº«</strong>ï¼šå¤šä¸ªç»„ä»¶å¯ä»¥å…±äº«å’Œè®¿é—®åŒä¸€ä¸ªæœåŠ¡å®ä¾‹çš„æ•°æ®ï¼Œä¾¿äºè¿›è¡ŒçŠ¶æ€ç®¡ç†å’Œè·¨ç»„ä»¶é€šä¿¡ã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç”±äºåªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜ä½¿ç”¨å’Œæ€§èƒ½å¼€é”€ã€‚</p></li><li><p><strong>å…¨å±€è®¿é—®</strong>ï¼šä»»ä½•ç»„ä»¶æˆ–æœåŠ¡éƒ½å¯ä»¥éšæ—¶è®¿é—®å’Œè°ƒç”¨è¯¥æœåŠ¡çš„æ–¹æ³•ã€‚</p></li></ul><h3 id="3-æœåŠ¡çš„ä½¿ç”¨åœºæ™¯"><a href="#3-æœåŠ¡çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. æœåŠ¡çš„ä½¿ç”¨åœºæ™¯"></a>3. æœåŠ¡çš„ä½¿ç”¨åœºæ™¯</h3><ul><li><p><strong>ä¸šåŠ¡é€»è¾‘å¤„ç†</strong>ï¼šå°†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ä»ç»„ä»¶ä¸­æŠ½ç¦»åˆ°æœåŠ¡ä¸­ï¼Œä¿æŒç»„ä»¶çš„ç®€æ´å’Œå¯ç»´æŠ¤æ€§ã€‚</p></li><li><p><strong>æ•°æ®å…±äº«å’ŒçŠ¶æ€ç®¡ç†</strong>ï¼šåœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®ï¼Œé¿å…äº† prop drillingï¼ˆå±‚å±‚ä¼ é€’æ•°æ®ï¼‰ã€‚</p></li><li><p><strong>HTTP è¯·æ±‚</strong>ï¼šé€šå¸¸ä½¿ç”¨æœåŠ¡æ¥å¤„ç† HTTP è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥é›†ä¸­ç®¡ç† API è°ƒç”¨ï¼Œæ–¹ä¾¿å¤„ç†é”™è¯¯å’Œå“åº”ã€‚</p></li><li><p><strong>é…ç½®å’Œç¯å¢ƒå˜é‡</strong>ï¼šæœåŠ¡å¯ä»¥ç”¨äºå­˜å‚¨å…¨å±€é…ç½®å’Œç¯å¢ƒå˜é‡ï¼Œä¾›å„ä¸ªç»„ä»¶ä½¿ç”¨ã€‚</p></li></ul><h3 id="4-å…·ä½“ç¤ºä¾‹"><a href="#4-å…·ä½“ç¤ºä¾‹" class="headerlink" title="4. å…·ä½“ç¤ºä¾‹"></a>4. å…·ä½“ç¤ºä¾‹</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æœåŠ¡ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span>, <span class="title class_">OnInit</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ExampleService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./example.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-example&#x27;</span>,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h1&gt;&#123;&#123; data &#125;&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;button (click)=&quot;changeData()&quot;&gt;æ”¹å˜æ•°æ®&lt;/button&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ExampleComponent</span> <span class="keyword">implements</span> <span class="title class_">OnInit</span> &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> exampleService: ExampleService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">ngOnInit</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = <span class="variable language_">this</span>.<span class="property">exampleService</span>.<span class="title function_">getData</span>(); <span class="comment">// è·å–æœåŠ¡ä¸­çš„æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">changeData</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">exampleService</span>.<span class="title function_">setData</span>(<span class="string">&#x27;æ–°æ•°æ®&#x27;</span>); <span class="comment">// ä¿®æ”¹æœåŠ¡ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = <span class="variable language_">this</span>.<span class="property">exampleService</span>.<span class="title function_">getData</span>(); <span class="comment">// æ›´æ–°ç»„ä»¶ä¸­çš„æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>ExampleComponent</code> ä½¿ç”¨ <code>ExampleService</code> æ¥è·å–å’Œè®¾ç½®æ•°æ®ã€‚æ— è®ºæœ‰å¤šå°‘ä¸ª <code>ExampleComponent</code> å®ä¾‹ï¼Œå®ƒä»¬éƒ½ä¼šå…±äº«åŒä¸€ä¸ª <code>ExampleService</code> å®ä¾‹ã€‚</p><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a>5. æ€»ç»“</h3><ul><li>Angular æœåŠ¡æ˜¯åº”ç”¨ç¨‹åºçš„å•ä¾‹å¯¹è±¡ï¼Œå…·æœ‰å…¨å±€å…±äº«çš„ç‰¹æ€§ã€‚</li><li>æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸æ•´ä¸ªåº”ç”¨ç¨‹åºç›¸åŒï¼Œä½¿å¾—è·¨ç»„ä»¶æ•°æ®å…±äº«å’Œä¸šåŠ¡é€»è¾‘ç®¡ç†å˜å¾—ç®€å•è€Œé«˜æ•ˆã€‚</li><li>é€šè¿‡ä½¿ç”¨æœåŠ¡ï¼Œèƒ½å¤Ÿæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ï¼ŒåŒæ—¶ç®€åŒ–ç»„ä»¶çš„ç»“æ„ã€‚</li></ul><h2 id="å›¾ç‰‡ä¼˜åŒ–"><a href="#å›¾ç‰‡ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡ä¼˜åŒ–"></a>å›¾ç‰‡ä¼˜åŒ–</h2><ol><li>ä½¿ç”¨ srcset å’Œ sizes å±æ€§</li><li>ä½¿ç”¨NgOptimizedImage</li><li>ä½¿ç”¨pictureç»“åˆwebpæ ¼å¼</li></ol><h2 id="Angularåšåˆ°å¤šå°‘ç‰ˆæœ¬ï¼Œè¦ä»14å‡çº§åˆ°18æ€ä¹ˆåš"><a href="#Angularåšåˆ°å¤šå°‘ç‰ˆæœ¬ï¼Œè¦ä»14å‡çº§åˆ°18æ€ä¹ˆåš" class="headerlink" title="Angularåšåˆ°å¤šå°‘ç‰ˆæœ¬ï¼Œè¦ä»14å‡çº§åˆ°18æ€ä¹ˆåš"></a>Angularåšåˆ°å¤šå°‘ç‰ˆæœ¬ï¼Œè¦ä»14å‡çº§åˆ°18æ€ä¹ˆåš</h2><p>ä½¿ç”¨<a href="https://angular.dev/update-guide">https://angular.dev/update-guide</a></p><h2 id="æ•æ·å¼€å‘ç›¸è¾ƒäºä¹‹å‰çš„ç€‘å¸ƒæµçš„åŒºåˆ«ï¼Œæ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—ï¼Œå¤šä¹…ä¸€ä¸ªsprint"><a href="#æ•æ·å¼€å‘ç›¸è¾ƒäºä¹‹å‰çš„ç€‘å¸ƒæµçš„åŒºåˆ«ï¼Œæ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—ï¼Œå¤šä¹…ä¸€ä¸ªsprint" class="headerlink" title="æ•æ·å¼€å‘ç›¸è¾ƒäºä¹‹å‰çš„ç€‘å¸ƒæµçš„åŒºåˆ«ï¼Œæ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—ï¼Œå¤šä¹…ä¸€ä¸ªsprint"></a>æ•æ·å¼€å‘ç›¸è¾ƒäºä¹‹å‰çš„ç€‘å¸ƒæµçš„åŒºåˆ«ï¼Œæ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—ï¼Œå¤šä¹…ä¸€ä¸ªsprint</h2><p>æ•æ·å¼€å‘ä¸ä¼ ç»Ÿçš„ç€‘å¸ƒæµå¼€å‘æ–¹æ³•ç›¸æ¯”ï¼Œå…·æœ‰ä¸€äº›æ˜¾è‘—çš„åŒºåˆ«ï¼Œå°¤å…¶æ˜¯åœ¨æµç¨‹ã€çµæ´»æ€§å’Œå›¢é˜Ÿåä½œæ–¹é¢ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦åŒºåˆ«å’Œæ•æ·å¼€å‘ä¸­æ—¶é—´ä¼°ç®—çš„ç›¸å…³ä¿¡æ¯ã€‚</p><h3 id="1-æ•æ·å¼€å‘ä¸ç€‘å¸ƒæµçš„åŒºåˆ«"><a href="#1-æ•æ·å¼€å‘ä¸ç€‘å¸ƒæµçš„åŒºåˆ«" class="headerlink" title="1. æ•æ·å¼€å‘ä¸ç€‘å¸ƒæµçš„åŒºåˆ«"></a>1. æ•æ·å¼€å‘ä¸ç€‘å¸ƒæµçš„åŒºåˆ«</h3><ul><li><p><strong>å¼€å‘æµç¨‹</strong>ï¼š</p><ul><li><strong>ç€‘å¸ƒæµ</strong>ï¼šçº¿æ€§æµç¨‹ï¼Œä¾æ¬¡è¿›è¡Œéœ€æ±‚åˆ†æã€è®¾è®¡ã€å¼€å‘ã€æµ‹è¯•å’Œç»´æŠ¤ã€‚æ¯ä¸ªé˜¶æ®µå®Œæˆåå†è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œé€šå¸¸ä¸å…è®¸è¿”å›ã€‚</li><li><strong>æ•æ·å¼€å‘</strong>ï¼šè¿­ä»£å’Œå¢é‡çš„æµç¨‹ï¼Œå¼ºè°ƒçŸ­å‘¨æœŸçš„å¼€å‘å’Œé¢‘ç¹äº¤ä»˜ï¼Œæ¯ä¸ªè¿­ä»£ï¼ˆSprintï¼‰éƒ½ä¼šè¿›è¡Œéœ€æ±‚ã€è®¾è®¡ã€å¼€å‘ã€æµ‹è¯•ç­‰æ­¥éª¤ã€‚</li></ul></li><li><p><strong>çµæ´»æ€§å’Œé€‚åº”æ€§</strong>ï¼š</p><ul><li><strong>ç€‘å¸ƒæµ</strong>ï¼šå¯¹éœ€æ±‚å˜åŒ–çš„é€‚åº”æ€§è¾ƒå·®ï¼Œéœ€æ±‚ä¸€æ—¦ç¡®å®šï¼Œåç»­é˜¶æ®µéš¾ä»¥è°ƒæ•´ã€‚</li><li><strong>æ•æ·å¼€å‘</strong>ï¼šé¼“åŠ±é¢‘ç¹åé¦ˆå’Œé€‚åº”å˜åŒ–ï¼Œå›¢é˜Ÿå¯ä»¥æ ¹æ®ç”¨æˆ·åé¦ˆå’Œå¸‚åœºå˜åŒ–çµæ´»è°ƒæ•´éœ€æ±‚ã€‚</li></ul></li><li><p><strong>ç”¨æˆ·å‚ä¸</strong>ï¼š</p><ul><li><strong>ç€‘å¸ƒæµ</strong>ï¼šç”¨æˆ·é€šå¸¸åœ¨åˆæœŸæä¾›éœ€æ±‚ï¼Œåç»­å‚ä¸è¾ƒå°‘ï¼Œç›´åˆ°æœ€ç»ˆäº¤ä»˜ã€‚</li><li><strong>æ•æ·å¼€å‘</strong>ï¼šç”¨æˆ·å’Œåˆ©ç›Šç›¸å…³è€…æŒç»­å‚ä¸ï¼Œé€šè¿‡è¿­ä»£åé¦ˆç¡®ä¿äº§å“ç¬¦åˆç”¨æˆ·éœ€æ±‚ã€‚</li></ul></li><li><p><strong>å›¢é˜Ÿåä½œ</strong>ï¼š</p><ul><li><strong>ç€‘å¸ƒæµ</strong>ï¼šå›¢é˜Ÿè§’è‰²è¾ƒä¸ºåˆ†æ˜ï¼Œæ²Ÿé€šç›¸å¯¹è¾ƒå°‘ï¼Œä¾èµ–æ–‡æ¡£ã€‚</li><li><strong>æ•æ·å¼€å‘</strong>ï¼šå¼ºè°ƒå›¢é˜Ÿçš„è·¨èŒèƒ½åä½œï¼Œå®šæœŸå¬å¼€ä¼šè®®ï¼ˆå¦‚ç«™ä¼šã€å›é¡¾ä¼šï¼‰ä¿ƒè¿›æ²Ÿé€šå’Œåä½œã€‚</li></ul></li></ul><h3 id="2-æ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—"><a href="#2-æ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—" class="headerlink" title="2. æ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—"></a>2. æ•æ·å¼€å‘çš„æ—¶é—´ä¼°ç®—</h3><p>åœ¨æ•æ·å¼€å‘ä¸­ï¼Œæ—¶é—´ä¼°ç®—é€šå¸¸æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li><p><strong>Sprint çš„å‘¨æœŸ</strong>ï¼š</p><ul><li>ä¸€ä¸ª Sprint é€šå¸¸æŒç»­ <strong>1 åˆ° 4 å‘¨</strong>ï¼Œå¸¸è§çš„åšæ³•æ˜¯ 2 å‘¨ã€‚å›¢é˜Ÿå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚å’Œå›¢é˜Ÿæˆå‘˜çš„å·¥ä½œèŠ‚å¥é€‰æ‹©åˆé€‚çš„å‘¨æœŸã€‚</li></ul></li><li><p><strong>æ—¶é—´ç›’ï¼ˆTime Boxï¼‰</strong>ï¼š</p><ul><li>æ•æ·æ–¹æ³•å¼ºè°ƒä½¿ç”¨æ—¶é—´ç›’æ¥æ§åˆ¶å·¥ä½œèŠ‚å¥ã€‚åœ¨æ¯ä¸ª Sprint ä¸­ï¼Œå›¢é˜Ÿä¼šå®šä¹‰è¦å®Œæˆçš„ä»»åŠ¡ï¼Œå¹¶åœ¨è§„å®šçš„æ—¶é—´å†…åŠªåŠ›å®Œæˆã€‚</li></ul></li><li><p><strong>æ•…äº‹ç‚¹å’Œä»»åŠ¡ä¼°ç®—</strong>ï¼š</p><ul><li>ä½¿ç”¨æ•…äº‹ç‚¹ï¼ˆStory Pointsï¼‰æ¥è¯„ä¼°å·¥ä½œé‡ï¼Œé€šå¸¸åŸºäºç›¸å¯¹å¤æ‚åº¦å’Œå®Œæˆæ—¶é—´ã€‚å›¢é˜Ÿå¯ä»¥é€šè¿‡å›é¡¾å†å²æ•°æ®æ¥è¿›è¡Œæ›´å‡†ç¡®çš„æ—¶é—´ä¼°ç®—ã€‚</li></ul></li></ul><h3 id="3-Sprint-è®¡åˆ’"><a href="#3-Sprint-è®¡åˆ’" class="headerlink" title="3. Sprint è®¡åˆ’"></a>3. Sprint è®¡åˆ’</h3><ul><li><p><strong>Sprint è®¡åˆ’ä¼šè®®</strong>ï¼šåœ¨æ¯ä¸ª Sprint å¼€å§‹æ—¶ï¼Œå›¢é˜Ÿä¼šå¬å¼€è®¡åˆ’ä¼šè®®ï¼Œç¡®å®šè¦åœ¨è¯¥ Sprint ä¸­å®Œæˆçš„ä»»åŠ¡ã€‚å›¢é˜Ÿä¼šæ ¹æ®ä¼˜å…ˆçº§å’Œå®¹é‡è¿›è¡Œä»»åŠ¡åˆ†é…ã€‚</p></li><li><p><strong>æ¯æ—¥ç«™ä¼š</strong>ï¼šåœ¨ Sprint è¿›è¡Œä¸­ï¼Œå›¢é˜Ÿæ¯å¤©è¿›è¡ŒçŸ­æš‚çš„ç«™ä¼šï¼Œè®¨è®ºè¿›å±•ã€é‡åˆ°çš„é—®é¢˜å’Œè®¡åˆ’ã€‚</p></li></ul><h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><strong>æ•æ·å¼€å‘</strong>ï¼šå¼ºè°ƒè¿­ä»£ã€çµæ´»æ€§å’Œå›¢é˜Ÿåä½œï¼Œèƒ½å¤Ÿå¿«é€Ÿå“åº”å˜åŒ–ã€‚</li><li><strong>Sprint å‘¨æœŸ</strong>ï¼šé€šå¸¸ä¸º 1 åˆ° 4 å‘¨ï¼Œ2 å‘¨ä¸ºå¸¸è§åšæ³•ã€‚</li><li><strong>æ—¶é—´ä¼°ç®—</strong>ï¼šä½¿ç”¨æ•…äº‹ç‚¹ã€ä»»åŠ¡ä¼°ç®—å’Œæ—¶é—´ç›’çš„æ–¹æ³•æ¥æé«˜å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚</li></ul><p>è¿™äº›ç‰¹ç‚¹ä½¿æ•æ·å¼€å‘é€‚åˆå¿«é€Ÿå˜åŒ–çš„é¡¹ç›®éœ€æ±‚å’Œé«˜åŠ¨æ€ç¯å¢ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> angular </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€ä¸‹2024å¹´10æœˆ18å·å’Œå‰åŒäº‹çš„ä¸€æ¬¡æ¨¡æ‹Ÿé¢è¯•</title>
      <link href="/2024/10/20/front-end/mock-interview/"/>
      <url>/2024/10/20/front-end/mock-interview/</url>
      
        <content type="html"><![CDATA[<h2 id="æ•æ·å¼€å‘"><a href="#æ•æ·å¼€å‘" class="headerlink" title="æ•æ·å¼€å‘"></a>æ•æ·å¼€å‘</h2><p>æ•æ·å¼€å‘æ˜¯ä¸€ç§ä»¥<strong>è¿­ä»£</strong>å’Œ<strong>å¢é‡</strong>çš„æ–¹å¼æ¥å¼€å‘è½¯ä»¶çš„æµç¨‹ï¼Œå®ƒæ³¨é‡<strong>å›¢é˜Ÿåä½œ</strong>ã€<strong>å¿«é€Ÿåé¦ˆ</strong>ä»¥åŠ<strong>åº”å¯¹å˜åŒ–</strong>çš„èƒ½åŠ›ã€‚åœ¨æ•æ·å¼€å‘ä¸­ï¼Œ<strong>Sprintï¼ˆå†²åˆºï¼‰</strong> æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚ä¸‹é¢æˆ‘ä¸ºä½ æ€»ç»“äº†æ•æ·å¼€å‘æµç¨‹ä¸­çš„<strong>Sprint</strong>ã€è¿­ä»£èŠ‚å¥ã€å’Œæ—¶é—´å‘¨æœŸï¼š</p><h3 id="1-Sprintï¼ˆå†²åˆºï¼‰"><a href="#1-Sprintï¼ˆå†²åˆºï¼‰" class="headerlink" title="1. Sprintï¼ˆå†²åˆºï¼‰"></a>1. <strong>Sprintï¼ˆå†²åˆºï¼‰</strong></h3><ul><li><strong>Sprint</strong> æ˜¯æ•æ·å¼€å‘çš„åŸºç¡€å•ä½ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª<strong>å›ºå®šæ—¶é—´å‘¨æœŸ</strong>ï¼Œé€šå¸¸ä¸º<strong>1åˆ°4å‘¨</strong>ã€‚</li><li>æ¯ä¸ª Sprint éƒ½æ˜¯ä¸€ä¸ª<strong>å°å‹è¿­ä»£å‘¨æœŸ</strong>ï¼Œåœ¨è¿™ä¸ªå‘¨æœŸä¸­ï¼Œå›¢é˜Ÿéœ€è¦å®Œæˆä¸€å®šæ•°é‡çš„å·¥ä½œï¼ˆé€šå¸¸æ˜¯å…·ä½“çš„åŠŸèƒ½ã€ç”¨æˆ·æ•…äº‹æˆ–ä»»åŠ¡ï¼‰ã€‚</li><li><strong>ç›®æ ‡</strong>æ˜¯åœ¨æ¯ä¸ª Sprint ç»“æŸæ—¶äº¤ä»˜ä¸€ä¸ª<strong>å¯å·¥ä½œçš„äº§å“å¢é‡</strong>ï¼Œå³ä½¿ä¸ä¸€å®šæ˜¯å®Œæ•´äº§å“ï¼Œä¹Ÿåº”è¯¥æ˜¯èƒ½å¤Ÿæ¼”ç¤ºæˆ–å‘å¸ƒçš„å¯ç”¨åŠŸèƒ½ã€‚</li></ul><h3 id="2-è¿­ä»£èŠ‚å¥"><a href="#2-è¿­ä»£èŠ‚å¥" class="headerlink" title="2. è¿­ä»£èŠ‚å¥"></a>2. <strong>è¿­ä»£èŠ‚å¥</strong></h3><p>æ•æ·å¼€å‘çš„è¿­ä»£èŠ‚å¥æ˜¯åŸºäº Sprint çš„ã€‚å›¢é˜Ÿä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¾ªç¯è¿›è¡Œå¼€å‘ï¼š</p><ol><li><p><strong>Sprint è®¡åˆ’ä¼šè®®ï¼ˆSprint Planningï¼‰</strong>ï¼š</p><ul><li>åœ¨æ¯ä¸ª Sprint å¼€å§‹æ—¶ï¼Œå›¢é˜Ÿä¼šå¬å¼€è®¡åˆ’ä¼šè®®ï¼Œç¡®å®šå½“å‰ Sprint çš„<strong>ç›®æ ‡</strong>å’Œ<strong>å¾…å®Œæˆçš„ä»»åŠ¡</strong>ã€‚è¿™äº›ä»»åŠ¡ä¸€èˆ¬ä»<strong>äº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼ˆProduct Backlogï¼‰</strong>ä¸­é€‰å–ï¼Œå¹¶æ‹†åˆ†æˆæ›´å°çš„<strong>ç”¨æˆ·æ•…äº‹ï¼ˆUser Storiesï¼‰</strong>æˆ–<strong>ä»»åŠ¡ï¼ˆTasksï¼‰</strong>ã€‚</li><li>å›¢é˜Ÿä¼šè¯„ä¼°æ¯ä¸ªä»»åŠ¡çš„å·¥ä½œé‡ï¼Œå¹¶ç¡®ä¿ä»»åŠ¡çš„æ€»é‡ç¬¦åˆ Sprint çš„å·¥ä½œå‘¨æœŸã€‚</li></ul></li><li><p><strong>Sprint æ‰§è¡Œ</strong>ï¼š</p><ul><li>å›¢é˜Ÿæ ¹æ®è®¡åˆ’å¼€å§‹æ‰§è¡Œä»»åŠ¡ï¼Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæœ‰<strong>æ¯æ—¥ç«™ä¼šï¼ˆDaily Standupï¼‰</strong>ï¼Œå›¢é˜Ÿæˆå‘˜æ±‡æŠ¥è¿›å±•ã€è®¨è®ºé—®é¢˜ä»¥åŠè°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§ã€‚</li><li>æ¯ä¸ª Sprint ä¸­ï¼Œå›¢é˜Ÿå°½é‡ä¿æŒå¿«é€Ÿè¿­ä»£ï¼Œåœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´å†…äº¤ä»˜æœ‰ä»·å€¼çš„åŠŸèƒ½ã€‚</li></ul></li><li><p><strong>Sprint è¯„å®¡ä¼šè®®ï¼ˆSprint Reviewï¼‰</strong>ï¼š</p><ul><li>åœ¨ Sprint ç»“æŸæ—¶ï¼Œå›¢é˜Ÿä¼šå¬å¼€è¯„å®¡ä¼šè®®ï¼Œå±•ç¤ºåœ¨ Sprint ä¸­å®Œæˆçš„å·¥ä½œæˆæœï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª<strong>å¯æ¼”ç¤ºçš„äº§å“åŠŸèƒ½</strong>ã€‚</li><li>å›¢é˜Ÿä¸åˆ©ç›Šç›¸å…³è€…ä¸€èµ·<strong>æ£€éªŒäº§å“å¢é‡</strong>ï¼Œå¹¶å¯¹ä¸‹ä¸€ä¸ª Sprint çš„å·¥ä½œè¿›è¡Œè®¨è®ºå’Œè°ƒæ•´ã€‚</li></ul></li><li><p><strong>Sprint å›é¡¾ä¼šè®®ï¼ˆSprint Retrospectiveï¼‰</strong>ï¼š</p><ul><li>åœ¨ Sprint ç»“æŸåï¼Œå›¢é˜Ÿè¿˜ä¼šå¬å¼€å›é¡¾ä¼šè®®ï¼Œè®¨è®º Sprint ä¸­çš„<strong>é—®é¢˜</strong>å’Œ<strong>æ”¹è¿›ç‚¹</strong>ã€‚</li><li>è¿™ä¸ªä¼šè®®å¸®åŠ©å›¢é˜Ÿåœ¨æ¯ä¸ª Sprint åä¸æ–­æ”¹è¿›å·¥ä½œæµç¨‹ã€æ²Ÿé€šæ–¹å¼å’Œå·¥å…·ã€‚</li></ul></li></ol><h3 id="3-æ—¶é—´å‘¨æœŸ"><a href="#3-æ—¶é—´å‘¨æœŸ" class="headerlink" title="3. æ—¶é—´å‘¨æœŸ"></a>3. <strong>æ—¶é—´å‘¨æœŸ</strong></h3><ul><li>æ¯ä¸ª Sprint çš„æ—¶é—´å‘¨æœŸé€šå¸¸æ˜¯<strong>å›ºå®šçš„</strong>ï¼Œå¹¶ä¸”æ ¹æ®å›¢é˜Ÿå’Œé¡¹ç›®çš„éœ€æ±‚è€Œå®šï¼Œå¸¸è§çš„å‘¨æœŸä¸ºï¼š<ul><li><strong>1å‘¨</strong>ï¼šé€‚ç”¨äºéœ€æ±‚éå¸¸ç´§æ€¥çš„é¡¹ç›®ï¼Œå›¢é˜Ÿéœ€è¦å¿«é€Ÿåé¦ˆå’Œè¿­ä»£ï¼Œä½†è¦æ±‚å›¢é˜Ÿæœ‰å¾ˆå¼ºçš„é€‚åº”èƒ½åŠ›ã€‚</li><li><strong>2å‘¨</strong>ï¼šè¿™æ˜¯æœ€å¸¸è§çš„å‘¨æœŸï¼Œèƒ½è®©å›¢é˜Ÿæœ‰è¶³å¤Ÿçš„æ—¶é—´å®Œæˆå¯äº¤ä»˜çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¿æŒçµæ´»åº”å¯¹å˜åŒ–ã€‚</li><li><strong>3åˆ°4å‘¨</strong>ï¼šé€‚ç”¨äºæ›´å¤æ‚çš„åŠŸèƒ½å¼€å‘ï¼Œéœ€è¦è¾ƒé•¿æ—¶é—´æ¥å®Œæˆï¼Œä½†ä»ç„¶éµå¾ªæ•æ·çš„çŸ­å‘¨æœŸè¿­ä»£åŸåˆ™ã€‚</li></ul></li></ul><h3 id="4-æŒç»­äº¤ä»˜å’Œåé¦ˆ"><a href="#4-æŒç»­äº¤ä»˜å’Œåé¦ˆ" class="headerlink" title="4. æŒç»­äº¤ä»˜å’Œåé¦ˆ"></a>4. <strong>æŒç»­äº¤ä»˜å’Œåé¦ˆ</strong></h3><p>æ•æ·å¼€å‘çš„ä¸€ä¸ªæ ¸å¿ƒç›®æ ‡æ˜¯å°½æ—©äº¤ä»˜å¯ç”¨çš„äº§å“å¹¶ä»ç”¨æˆ·å¤„è·å¾—åé¦ˆã€‚å› æ­¤ï¼Œæ¯ä¸ª Sprint ç»“æŸæ—¶ï¼Œå›¢é˜Ÿéƒ½ä¼šäº¤ä»˜<strong>å¯å·¥ä½œçš„äº§å“å¢é‡</strong>ï¼Œå¹¶ä¾æ®<strong>ç”¨æˆ·åé¦ˆ</strong>è°ƒæ•´ä¸‹ä¸€é˜¶æ®µçš„å¼€å‘å·¥ä½œã€‚è¿™ä¸ªæµç¨‹åå¤è¿›è¡Œï¼Œç›´åˆ°é¡¹ç›®å®Œæˆæˆ–éœ€æ±‚åœæ­¢ã€‚</p><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>æ•æ·å¼€å‘æµç¨‹æ˜¯é€šè¿‡å¤šä¸ª Sprint è¿­ä»£å®ç°çš„ï¼Œæ¯ä¸ª Sprint é€šå¸¸æŒç»­ 1-4 å‘¨ã€‚åœ¨æ¯ä¸ª Sprint ä¸­ï¼Œå›¢é˜Ÿä¼šè®¡åˆ’ä»»åŠ¡ï¼Œè¿›è¡Œå¼€å‘å’Œæµ‹è¯•ï¼Œå¹¶äº¤ä»˜å¯ç”¨çš„äº§å“å¢é‡ã€‚é€šè¿‡é¢‘ç¹çš„åé¦ˆå’Œä¸æ–­ä¼˜åŒ–ï¼Œå›¢é˜Ÿèƒ½å¤Ÿåº”å¯¹éœ€æ±‚å˜åŒ–å¹¶æŒç»­æ”¹è¿›å¼€å‘æ•ˆç‡ã€‚</p><h2 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h2><h3 id="javascriptçš„é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œèƒ½ä¸èƒ½å†™ä¸€ä¸ªä¾‹å­"><a href="#javascriptçš„é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œèƒ½ä¸èƒ½å†™ä¸€ä¸ªä¾‹å­" class="headerlink" title="javascriptçš„é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œèƒ½ä¸èƒ½å†™ä¸€ä¸ªä¾‹å­"></a>javascriptçš„é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œèƒ½ä¸èƒ½å†™ä¸€ä¸ªä¾‹å­</h3><p>é—­åŒ…æ˜¯æŒ‡å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®å®ƒæ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå³ä½¿è¿™ä¸ªå‡½æ•°åœ¨è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚è¿™æ˜¯ JavaScript å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¸¸ç”¨äºéšè—æ•°æ®ã€æ¨¡æ‹Ÿç§æœ‰å˜é‡ã€åˆ›å»ºå›è°ƒå‡½æ•°ç­‰åœºæ™¯ã€‚</p><p>é—­åŒ…çš„ä¸‰ä¸ªç‰¹æ€§ï¼š</p><ul><li>å‡½æ•°åµŒå¥—ï¼šé—­åŒ…é€šå¸¸æ˜¯å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚</li><li>ä½œç”¨åŸŸé“¾ï¼šå‡½æ•°åœ¨å®šä¹‰æ—¶ç»‘å®šäº†å…¶æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸã€‚</li><li>å¤–éƒ¨å‡½æ•°æ‰§è¡Œåï¼Œå†…éƒ¨å‡½æ•°ä¾ç„¶èƒ½å¤Ÿè®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚</li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>; <span class="comment">// å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="comment">// è¿”å›ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼Œå½¢æˆé—­åŒ…</span></span><br><span class="line">    count++; <span class="comment">// å†…éƒ¨å‡½æ•°èƒ½å¤Ÿè®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(count);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="title function_">createCounter</span>(); <span class="comment">// è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œè¿”å›å†…éƒ¨å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">counter</span>(); <span class="comment">// è¾“å‡º: 1</span></span><br><span class="line"><span class="title function_">counter</span>(); <span class="comment">// è¾“å‡º: 2</span></span><br><span class="line"><span class="title function_">counter</span>(); <span class="comment">// è¾“å‡º: 3</span></span><br></pre></td></tr></table></figure><h3 id="javascriptçš„åŸå‹é“¾æ˜¯ä»€ä¹ˆ"><a href="#javascriptçš„åŸå‹é“¾æ˜¯ä»€ä¹ˆ" class="headerlink" title="javascriptçš„åŸå‹é“¾æ˜¯ä»€ä¹ˆ"></a>javascriptçš„åŸå‹é“¾æ˜¯ä»€ä¹ˆ</h3><p>JavaScriptçš„åŸå‹é“¾æ˜¯ç”¨äºå®ç°ç»§æ‰¿çš„ä¸€ç§æœºåˆ¶ã€‚</p><ul><li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__ å±æ€§ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡ã€‚</li><li>å¦‚æœåœ¨å¯¹è±¡ä¸Šæ‰¾ä¸åˆ°æŸä¸ªå±æ€§æˆ–æ–¹æ³•ï¼ŒJavaScript ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–æ–¹æ³•ï¼Œæˆ–è€…åˆ°è¾¾åŸå‹é“¾çš„é¡¶ç«¯ nullã€‚</li><li>å‡½æ•°çš„ prototype å±æ€§æ˜¯å…¶å®ä¾‹å¯¹è±¡çš„åŸå‹ã€‚é€šè¿‡è¿™ä¸ªæœºåˆ¶ï¼ŒJavaScript å®ç°äº†å±æ€§å’Œæ–¹æ³•çš„å…±äº«å’Œç»§æ‰¿ã€‚</li><li>åŸå‹é“¾çš„é¡¶ç«¯æ˜¯ Object.prototypeï¼Œå®ƒçš„ __proto__ æŒ‡å‘ nullï¼Œè¡¨ç¤ºåŸå‹é“¾çš„ç»“æŸ</li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line">person.<span class="title function_">sayHello</span>(); <span class="comment">// Hello, my name is John</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="javascriptä¸­newè¿ç®—ç¬¦åšäº†ä»€ä¹ˆ"><a href="#javascriptä¸­newè¿ç®—ç¬¦åšäº†ä»€ä¹ˆ" class="headerlink" title="javascriptä¸­newè¿ç®—ç¬¦åšäº†ä»€ä¹ˆ"></a>javascriptä¸­newè¿ç®—ç¬¦åšäº†ä»€ä¹ˆ</h3><p>å½“ä½ åœ¨ JavaScript ä¸­ä½¿ç”¨ new è¿ç®—ç¬¦æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ã€‚</li><li>å°†è¿™ä¸ªæ–°å¯¹è±¡çš„__proto__å±æ€§è®¾ç½®ä¸ºæ„é€ å‡½æ•°çš„prototypeå¯¹è±¡ï¼Œä»è€Œå®ç°åŸå‹é“¾ç»§æ‰¿ã€‚</li><li>è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå¹¶å°†æ–°å¯¹è±¡ä½œä¸ºå‡½æ•°å†…éƒ¨çš„ thisï¼Œè®©æ„é€ å‡½æ•°èƒ½å¤Ÿä¸ºæ–°å¯¹è±¡æ·»åŠ å±æ€§ã€‚</li><li>å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå¯¹è±¡ï¼›å¦åˆ™ï¼Œè¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</li></ul><h3 id="letå’Œconstæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#letå’Œconstæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="letå’Œconstæœ‰ä»€ä¹ˆåŒºåˆ«"></a>letå’Œconstæœ‰ä»€ä¹ˆåŒºåˆ«</h3><p>let å…è®¸é‡æ–°èµ‹å€¼ï¼Œè€Œ const ä¸å…è®¸é‡æ–°èµ‹å€¼ã€‚const å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œè€Œ let å¯ä»¥åœ¨å£°æ˜åå†èµ‹å€¼ã€‚</p><ul><li>ä½¿ç”¨ letï¼šé€‚åˆéœ€è¦åœ¨åç»­ä¿®æ”¹å˜é‡å€¼çš„åœºæ™¯ã€‚</li><li>ä½¿ç”¨ constï¼šé€‚åˆå£°æ˜ä¸éœ€è¦é‡æ–°èµ‹å€¼çš„å¸¸é‡ï¼Œå°¤å…¶æ˜¯ç”¨æ¥å£°æ˜ä¸å¯å˜çš„åŸå§‹ç±»å‹ï¼ˆå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ï¼‰ã€‚å¯¹äºå¯¹è±¡å’Œæ•°ç»„ï¼Œè™½ç„¶å¼•ç”¨ä¸èƒ½æ”¹å˜ï¼Œä½†å†…éƒ¨å†…å®¹å¯ä»¥ä¿®æ”¹ã€‚</li></ul><h3 id="interfaceå’Œtypeçš„åŒºåˆ«ï¼Œ-interfaceèƒ½ä¸èƒ½ç»§æ‰¿typeï¼Ÿ"><a href="#interfaceå’Œtypeçš„åŒºåˆ«ï¼Œ-interfaceèƒ½ä¸èƒ½ç»§æ‰¿typeï¼Ÿ" class="headerlink" title="interfaceå’Œtypeçš„åŒºåˆ«ï¼Œ interfaceèƒ½ä¸èƒ½ç»§æ‰¿typeï¼Ÿ"></a>interfaceå’Œtypeçš„åŒºåˆ«ï¼Œ interfaceèƒ½ä¸èƒ½ç»§æ‰¿typeï¼Ÿ</h3><p>interface å’Œ type éƒ½å¯ä»¥å®šä¹‰å¯¹è±¡çš„å½¢çŠ¶ï¼Œä½† interface æ›´é€‚åˆé¢å‘å¯¹è±¡çš„åœºæ™¯ï¼Œè€Œ type æ›´çµæ´»ï¼Œé€‚åˆå®šä¹‰è”åˆç±»å‹ã€å…ƒç»„ç­‰å¤æ‚ç±»å‹ã€‚<br>interface å¯ä»¥ç»§æ‰¿ typeï¼Œåè¿‡æ¥ä¹Ÿå¯ä»¥é€šè¿‡äº¤å‰ç±»å‹å®ç°æ‰©å±•ã€‚<br>interface æ”¯æŒåˆå¹¶å£°æ˜ï¼Œè¿™åœ¨åº“å¼€å‘å’Œæ‰©å±•æ—¶éå¸¸æœ‰ç”¨ï¼Œè€Œ type åˆ™æ— æ³•åˆå¹¶ã€‚</p><h3 id="apply-call-bind-çš„åŒºåˆ«"><a href="#apply-call-bind-çš„åŒºåˆ«" class="headerlink" title="apply, call, bind çš„åŒºåˆ«"></a>apply, call, bind çš„åŒºåˆ«</h3><p>applyã€call å’Œ bind æ˜¯ JavaScript ä¸­ç”¨æ¥æ”¹å˜å‡½æ•°å†…éƒ¨ this æŒ‡å‘çš„æ–¹æ³•ï¼Œå®ƒä»¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç±»ä¼¼çš„ï¼Œä½†åœ¨ä½¿ç”¨æ–¹å¼å’Œè¡Œä¸ºä¸Šæœ‰æ‰€ä¸åŒã€‚</p><p>æ ¸å¿ƒåŒºåˆ«æ€»ç»“ï¼š</p><ol><li>applyï¼šä¼ é€’å‚æ•°æ—¶ä½¿ç”¨æ•°ç»„å½¢å¼ï¼Œç«‹å³è°ƒç”¨å‡½æ•°ã€‚</li><li>callï¼šä¼ é€’å‚æ•°æ—¶ä½¿ç”¨é€—å·åˆ†éš”ï¼Œç«‹å³è°ƒç”¨å‡½æ•°ã€‚</li><li>bindï¼šè¿”å›ä¸€ä¸ªç»‘å®šäº† this çš„æ–°å‡½æ•°ï¼Œä½†ä¸ä¼šç«‹å³æ‰§è¡Œã€‚</li></ol><p>ä¹¦å†™applyï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myApply</span> = <span class="keyword">function</span>(<span class="params">context, argsArray</span>) &#123;</span><br><span class="line">  <span class="comment">// 1. å¦‚æœæ²¡æœ‰æä¾› contextï¼Œåˆ™é»˜è®¤è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡ (åœ¨æµè§ˆå™¨ä¸­æ˜¯ windowï¼Œåœ¨ Node.js ä¸­æ˜¯ global)</span></span><br><span class="line">  context = context || globalThis;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. ç»™ context æ·»åŠ ä¸€ä¸ªä¸´æ—¶æ–¹æ³•ï¼ŒæŒ‡å‘å½“å‰çš„å‡½æ•° (this)</span></span><br><span class="line">  <span class="keyword">const</span> fnSymbol = <span class="title class_">Symbol</span>();  <span class="comment">// ä½¿ç”¨ Symbol é¿å…å±æ€§å†²çª</span></span><br><span class="line">  context[fnSymbol] = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. æ‰§è¡Œå‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°æ•°ç»„</span></span><br><span class="line">  <span class="keyword">let</span> result;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(argsArray)) &#123;</span><br><span class="line">    result = context[fnSymbol](...argsArray);  <span class="comment">// è§£æ„æ•°ç»„ä¼ å‚</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result = context[fnSymbol]();  <span class="comment">// å¦‚æœæ²¡æœ‰å‚æ•°æ•°ç»„ï¼Œåˆ™ç›´æ¥è°ƒç”¨</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. åˆ é™¤ä¸´æ—¶å±æ€§</span></span><br><span class="line">  <span class="keyword">delete</span> context[fnSymbol];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. è¿”å›æ‰§è¡Œç»“æœ</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¹¦å†™callï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myCall</span> = <span class="keyword">function</span>(<span class="params">context, ...args</span>) &#123;</span><br><span class="line">  <span class="comment">// 1. å¦‚æœæ²¡æœ‰æä¾› contextï¼Œåˆ™é»˜è®¤è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡ (åœ¨æµè§ˆå™¨ä¸­æ˜¯ windowï¼Œåœ¨ Node.js ä¸­æ˜¯ global)</span></span><br><span class="line">  context = context || globalThis;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. ç»™ context æ·»åŠ ä¸€ä¸ªä¸´æ—¶æ–¹æ³•ï¼ŒæŒ‡å‘å½“å‰çš„å‡½æ•° (this)</span></span><br><span class="line">  <span class="keyword">const</span> fnSymbol = <span class="title class_">Symbol</span>();  <span class="comment">// ä½¿ç”¨ Symbol é¿å…å±æ€§å†²çª</span></span><br><span class="line">  context[fnSymbol] = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. æ‰§è¡Œå‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°</span></span><br><span class="line">  <span class="keyword">const</span> result = context[fnSymbol](...args);  <span class="comment">// é€šè¿‡å±•å¼€è¿ç®—ç¬¦ä¼ å…¥å‚æ•°</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. åˆ é™¤ä¸´æ—¶å±æ€§</span></span><br><span class="line">  <span class="keyword">delete</span> context[fnSymbol];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. è¿”å›æ‰§è¡Œç»“æœ</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰‹å†™bindï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span>(<span class="params">context, ...args</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¿å­˜åŸå‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> originalFunc = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªæ–°å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> boundFunction = <span class="keyword">function</span>(<span class="params">...newArgs</span>) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯æ„é€ å‡½æ•°è°ƒç”¨ï¼Œ`this` æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼Œåº”è¯¥å¿½ç•¥ç»‘å®šçš„ `context`</span></span><br><span class="line">    <span class="comment">// å¦åˆ™ä½¿ç”¨ç»‘å®šçš„ `context`</span></span><br><span class="line">    <span class="keyword">const</span> isNew = <span class="variable language_">this</span> <span class="keyword">instanceof</span> boundFunction;</span><br><span class="line">    <span class="keyword">const</span> thisArg = isNew ? <span class="variable language_">this</span> : context;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ apply ç»‘å®š `this`ï¼Œåˆå¹¶ args å’Œ newArgs</span></span><br><span class="line">    <span class="keyword">return</span> originalFunc.<span class="title function_">apply</span>(thisArg, [...args, ...newArgs]);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç»§æ‰¿åŸå‡½æ•°çš„ prototypeï¼Œç¡®ä¿ç»‘å®šåçš„å‡½æ•°æ˜¯åŸå‡½æ•°çš„å®ä¾‹</span></span><br><span class="line">  <span class="keyword">if</span> (originalFunc.<span class="property"><span class="keyword">prototype</span></span>) &#123;</span><br><span class="line">    boundFunction.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(originalFunc.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> boundFunction;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="reactçš„äº‹ä»¶åˆæˆ"><a href="#reactçš„äº‹ä»¶åˆæˆ" class="headerlink" title="reactçš„äº‹ä»¶åˆæˆ"></a>reactçš„äº‹ä»¶åˆæˆ</h3><p>åœ¨ React ä¸­ï¼Œäº‹ä»¶æ˜¯é€šè¿‡åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰æœºåˆ¶å¤„ç†çš„ï¼Œå®ƒæ˜¯å¯¹åŸç”Ÿ DOM äº‹ä»¶çš„ä¸€ç§è·¨æµè§ˆå™¨çš„å°è£…ï¼Œç¡®ä¿äº‹ä»¶åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­éƒ½æœ‰ä¸€è‡´çš„è¡Œä¸ºã€‚React ä½¿ç”¨äº‹ä»¶å§”æ‰˜çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰äº‹ä»¶ç»Ÿä¸€ç»‘å®šåœ¨æ ¹å…ƒç´ ä¸Šï¼Œé€šè¿‡äº‹ä»¶å†’æ³¡æ¥æ•æ‰å­å…ƒç´ çš„äº‹ä»¶è§¦å‘ã€‚è¿™ç§æœºåˆ¶å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºå®ƒé¿å…äº†åœ¨æ¯ä¸ª DOM èŠ‚ç‚¹ä¸Šç»‘å®šç‹¬ç«‹çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><p>SyntheticEvent çš„æ¥å£ä¸æµè§ˆå™¨çš„åŸç”Ÿäº‹ä»¶ä¸€è‡´ï¼Œåƒ preventDefault() å’Œ stopPropagation() éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSyntheticEvent æ˜¯å¯å›æ”¶çš„ï¼ŒReact ä¼šåœ¨äº‹ä»¶å¤„ç†åè‡ªåŠ¨é”€æ¯äº‹ä»¶å¯¹è±¡ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚å¦‚æœéœ€è¦åœ¨å¼‚æ­¥æ“ä½œä¸­ä½¿ç”¨äº‹ä»¶å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ event.persist() æ–¹æ³•é˜²æ­¢äº‹ä»¶è¢«å›æ”¶ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒReact çš„äº‹ä»¶åˆæˆæœºåˆ¶æä¾›äº†æ€§èƒ½ä¼˜åŒ–å’Œè·¨æµè§ˆå™¨å…¼å®¹æ€§ï¼Œæ˜¯äº‹ä»¶å¤„ç†çš„åŸºç¡€å·¥å…·ã€‚åœ¨ React 18 ä¸­ï¼Œåˆæˆäº‹ä»¶å…ˆäºåŸç”Ÿäº‹ä»¶å¤„ç†æ˜¯ä¸ºäº†ç¡®ä¿æ€§èƒ½ä¼˜åŒ–ã€ä¸€è‡´æ€§å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>è¦è·å–åˆæˆäº‹ä»¶ä¸­çš„åŸç”Ÿäº‹ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡ event.nativeEvent å±æ€§æ¥è®¿é—®ã€‚è¿™å…è®¸ä½ è·å–æµè§ˆå™¨çš„åŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼Œå¹¶ç›´æ¥ä¸ä¹‹è¿›è¡Œäº¤äº’ã€‚</p><p>åœ¨ React ä¸­ï¼Œé˜»æ­¢åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰å†’æ³¡ä¸é˜»æ­¢åŸç”Ÿ DOM äº‹ä»¶å†’æ³¡çš„æ–¹æ³•ç±»ä¼¼ã€‚ä½ å¯ä»¥ä½¿ç”¨åˆæˆäº‹ä»¶å¯¹è±¡çš„ stopPropagation() æ–¹æ³•æ¥é˜»æ­¢äº‹ä»¶çš„å†’æ³¡è¡Œä¸ºã€‚</p><p>å½“ä½ è°ƒç”¨ event.stopPropagation() æ—¶ï¼ŒReact ä¼šé˜»æ­¢è¯¥äº‹ä»¶ç»§ç»­å‘ä¸Šä¼ æ’­åˆ°çˆ¶çº§å…ƒç´ çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><h3 id="reactçš„vdomæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿"><a href="#reactçš„vdomæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿" class="headerlink" title="reactçš„vdomæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿"></a>reactçš„vdomæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿</h3><p>React çš„ Virtual DOMï¼ˆè™šæ‹Ÿ DOMï¼‰æ˜¯ React ç”¨æ¥ä¼˜åŒ– UI æ›´æ–°çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒæ˜¯å®é™… DOM çš„è½»é‡çº§å‰¯æœ¬ï¼Œé€šè¿‡åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿ DOM æ ‘æ¥è¿›è¡Œé«˜æ•ˆçš„ UI æ¸²æŸ“å’Œæ›´æ–°ã€‚</p><p>Virtual DOM å·¥ä½œåŸç†ï¼š</p><ol><li>å½“ React ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶ï¼ŒReact ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ª Virtual DOM æ ‘ã€‚è¿™ä¸ªè™šæ‹Ÿ DOM æ˜¯ React å…ƒç´ çš„å¯¹è±¡è¡¨ç¤ºï¼Œå®ƒè½»é‡ä¸”æ˜“äºæ“ä½œ</li><li>å½“ç»„ä»¶çš„çŠ¶æ€æˆ–å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒReact ä¼šé‡æ–°è®¡ç®—æ–°çš„ Virtual DOM æ ‘ï¼Œä½†ä¸ä¼šç«‹å³æ›´æ–°å®é™…çš„ DOM</li><li>React ä½¿ç”¨é«˜æ•ˆçš„å·®å¼‚ç®—æ³•ï¼ˆreconciliationï¼‰æ¥æ¯”è¾ƒæ–°æ—§ Virtual DOM æ ‘ã€‚å®ƒä¼šæ‰¾å‡ºæ–°æ—§ Virtual DOM æ ‘ä¹‹é—´çš„å·®å¼‚ï¼ˆdiffï¼‰ï¼Œå³éœ€è¦æ›´æ–°çš„éƒ¨åˆ†</li><li>React å°†è¿™äº›å·®å¼‚åº”ç”¨åˆ°å®é™…çš„ DOM ä¸Šï¼Œé€šè¿‡ä¸€æ¬¡æ€§æœ€å°åŒ–çš„æ›´æ–°æ¥æå‡æ€§èƒ½</li></ol><p>Virtual DOM çš„ä¼˜åŠ¿ï¼š</p><ol><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: ç›´æ¥æ“ä½œçœŸå® DOM æ˜¯æ¯”è¾ƒæ˜‚è´µçš„ï¼Œå› ä¸º DOM çš„æ“ä½œä¼šå¯¼è‡´æµè§ˆå™¨çš„é‡æ–°å¸ƒå±€å’Œé‡ç»˜ã€‚è€Œ Virtual DOM æ˜¯åœ¨å†…å­˜ä¸­æ“ä½œçš„ï¼Œé€Ÿåº¦å¿«å¾—å¤šã€‚é€šè¿‡æ‰¹é‡æ›´æ–° DOM çš„æ–¹å¼ï¼ŒReact å°†é¢‘ç¹çš„å°æ”¹åŠ¨åˆå¹¶ä¸ºä¸€æ¬¡å¤§çš„æ›´æ–°ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡æ’å’Œé‡ç»˜ï¼Œæå¤§åœ°æé«˜äº†æ€§èƒ½</li><li><strong>è·¨å¹³å°ä¸€è‡´æ€§</strong>: Virtual DOM æä¾›äº†ä¸€ç§æŠ½è±¡çš„ DOM ç»“æ„ï¼Œå®ƒä¸ä¾èµ–äºç‰¹å®šçš„å¹³å°ã€‚å› æ­¤ï¼ŒReact å¯ä»¥ç”¨äºæµè§ˆå™¨ç¯å¢ƒã€ç§»åŠ¨åº”ç”¨ï¼ˆReact Nativeï¼‰ã€ç”šè‡³æœåŠ¡å™¨ç«¯æ¸²æŸ“ç­‰ä¸åŒå¹³å°ï¼Œå¢å¼ºäº†ä»£ç çš„å¤ç”¨æ€§</li><li><strong>å¯é¢„æµ‹çš„ UI æ›´æ–°</strong>: é€šè¿‡ Virtual DOM å’Œ React çš„çŠ¶æ€é©±åŠ¨ï¼ˆdeclarativeï¼‰è®¾è®¡ï¼ŒReact å¯ä»¥ç¡®ä¿ UI çš„æ›´æ–°æ˜¯å¯é¢„æµ‹çš„ï¼Œå¼€å‘è€…åªéœ€ä¸“æ³¨äºæè¿° UI åº”è¯¥â€œå¦‚ä½•å‘ˆç°â€ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨æ§åˆ¶å…·ä½“çš„ DOM æ›´æ–°è¿‡ç¨‹</li><li><strong>ç®€åŒ–å¤æ‚æ“ä½œ</strong>: åœ¨å¤æ‚çš„åº”ç”¨ä¸­ï¼Œç›´æ¥æ“ä½œ DOM å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥ç»´æŠ¤å’Œè°ƒè¯•çš„é—®é¢˜ã€‚React çš„ Virtual DOM å±è”½äº†å¤æ‚çš„ DOM æ“ä½œï¼Œè®©å¼€å‘è€…åªéœ€è¦å®šä¹‰ç»„ä»¶çš„çŠ¶æ€å’Œç»“æ„ï¼ŒReact è‡ªåŠ¨å¤„ç† DOM æ“ä½œ</li></ol><p>Virtual DOM çš„å±€é™æ€§ï¼š</p><ol><li><strong>ä¸æ€»æ˜¯æœ€å¿«çš„</strong>ï¼šè™½ç„¶ Virtual DOM æä¾›äº†é«˜æ•ˆçš„æ›´æ–°æœºåˆ¶ï¼Œä½†åœ¨æŸäº›éå¸¸ç®€å•æˆ–ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œç›´æ¥æ“ä½œ DOM å¯èƒ½æ¯”ä½¿ç”¨ Virtual DOM æ›´å¿«</li><li><strong>å­¦ä¹ æˆæœ¬</strong>ï¼š éœ€è¦ç†è§£ React çš„çŠ¶æ€ç®¡ç†ã€ç”Ÿå‘½å‘¨æœŸã€Virtual DOM ç­‰æ¦‚å¿µï¼Œå¯èƒ½å¯¹åˆå­¦è€…æœ‰ä¸€å®šçš„å­¦ä¹ é—¨æ§›</li></ol><p>React çš„ Virtual DOM æ˜¯ä¸€ç§æå‡æ€§èƒ½çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œé€šè¿‡åœ¨å†…å­˜ä¸­åˆ›å»ºè½»é‡çº§çš„è™šæ‹Ÿ DOM æ ‘ï¼Œé…åˆå·®å¼‚ç®—æ³•å’Œæ‰¹é‡æ›´æ–°ç­–ç•¥ï¼Œæœ‰æ•ˆåœ°æé«˜äº† UI æ›´æ–°çš„æ•ˆç‡ï¼Œå¹¶ç®€åŒ–äº†è·¨å¹³å°å¼€å‘çš„å¤æ‚æ€§ã€‚</p><h3 id="reactä¸­çš„hocç»„ä»¶"><a href="#reactä¸­çš„hocç»„ä»¶" class="headerlink" title="reactä¸­çš„hocç»„ä»¶"></a>reactä¸­çš„hocç»„ä»¶</h3><p>åœ¨ React ä¸­ï¼ŒHOCï¼ˆHigher-Order Componentï¼Œé«˜é˜¶ç»„ä»¶ï¼‰ æ˜¯ä¸€ç§ç»„ä»¶å¤ç”¨çš„é«˜çº§æŠ€æœ¯ã€‚HOC æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚é«˜é˜¶ç»„ä»¶å¸¸ç”¨äºé€»è¾‘å¤ç”¨ã€å¢å¼ºç°æœ‰ç»„ä»¶çš„åŠŸèƒ½ï¼Œè€Œä¸æ”¹å˜ç»„ä»¶æœ¬èº«çš„å®ç°ã€‚</p><p>HOC çš„å®šä¹‰ï¼š</p><ul><li>é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒä¸ä¿®æ”¹ä¼ å…¥çš„ç»„ä»¶ï¼Œåªæ˜¯è¿”å›ä¸€ä¸ªå¢å¼ºåçš„æ–°ç»„ä»¶ã€‚</li></ul><p>HOC çš„å·¥ä½œåŸç†ï¼š</p><ul><li><strong>å‚æ•°æ˜¯ç»„ä»¶</strong>ï¼šHOC æ¥æ”¶ä¸€ä¸ªç°æœ‰ç»„ä»¶ä½œä¸ºå‚æ•°ã€‚</li><li><strong>è¿”å›æ–°ç»„ä»¶</strong>ï¼šå®ƒä¼šè¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œè¯¥ç»„ä»¶å¯ä»¥åŸºäºåŸç»„ä»¶è¿›è¡Œé¢å¤–çš„åŠŸèƒ½æ‰©å±•ã€‚</li><li><strong>ä¸ä¿®æ”¹åŸç»„ä»¶</strong>ï¼šHOC ä¸ç›´æ¥ä¿®æ”¹åŸç»„ä»¶ï¼Œè€Œæ˜¯é€šè¿‡åŒ…è£…ã€ç»„åˆçš„æ–¹å¼å¢å¼ºåŠŸèƒ½ã€‚</li></ul><p>HOC çš„å¸¸è§ç”¨é€”ï¼š</p><ul><li><strong>å¤ç”¨é€»è¾‘</strong>ï¼šå¤šä¸ªç»„ä»¶å…±äº«ç›¸åŒçš„é€»è¾‘æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ HOC å°†è¯¥é€»è¾‘æå–å‡ºæ¥ã€‚</li><li><strong>å¤„ç†æƒé™æ§åˆ¶</strong>ï¼šHOC å¯ç”¨äºæƒé™æ ¡éªŒé€»è¾‘ï¼Œä¾‹å¦‚æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è®¿é—®æƒé™ã€‚</li><li><strong>æ“ä½œ props</strong>ï¼šHOC å¯ä»¥ä¿®æ”¹ã€å¢åŠ æˆ–åˆ é™¤ç»„ä»¶çš„ propsã€‚</li><li><strong>æ“ä½œç”Ÿå‘½å‘¨æœŸ</strong>ï¼šé€šè¿‡ HOC å¯ä»¥æ§åˆ¶ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥å®ç°ç¼“å­˜ã€è¯·æ±‚æ‹¦æˆªç­‰åŠŸèƒ½ã€‚</li></ul><h3 id="reactç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼"><a href="#reactç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼" class="headerlink" title="reactç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼"></a>reactç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼</h3><ul><li><strong>çˆ¶å­ç»„ä»¶é€šä¿¡</strong>ï¼šçˆ¶ç»„ä»¶é€šè¿‡propså°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶ã€‚React çš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶</li><li><strong>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡ï¼ˆå›è°ƒå‡½æ•° Props</strong>ï¼šå­ç»„ä»¶æ— æ³•ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ•°æ®ï¼Œå› æ­¤å­ç»„ä»¶å¯ä»¥é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶ä¼ é€’çš„å›è°ƒå‡½æ•°æ¥å‘çˆ¶ç»„ä»¶ä¼ é€’ä¿¡æ¯ã€‚çˆ¶ç»„ä»¶å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­æ¥æ”¶å­ç»„ä»¶ä¼ é€’çš„æ•°æ®å¹¶æ›´æ–°çŠ¶æ€</li><li><strong>å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼ˆé€šè¿‡çˆ¶ç»„ä»¶ä¸­è½¬ï¼‰</strong>ï¼šç”±äº React çš„å•å‘æ•°æ®æµï¼Œå…„å¼Ÿç»„ä»¶ä¹‹é—´ä¸èƒ½ç›´æ¥é€šä¿¡ã€‚é€šå¸¸é€šè¿‡çˆ¶ç»„ä»¶ä¸­è½¬å®ç°å…„å¼Ÿç»„ä»¶é—´çš„é€šä¿¡ã€‚çˆ¶ç»„ä»¶å°†ä¸€ä¸ªå›è°ƒå‡½æ•°ä¼ é€’ç»™ä¸€ä¸ªå­ç»„ä»¶ï¼Œå½“è¿™ä¸ªå­ç»„ä»¶è§¦å‘å›è°ƒå‡½æ•°æ—¶ï¼Œçˆ¶ç»„ä»¶æ›´æ–°çŠ¶æ€ï¼Œç„¶åå°†çŠ¶æ€ä¼ é€’ç»™å¦ä¸€ä¸ªå­ç»„ä»¶</li><li><strong>è·¨å±‚çº§ç»„ä»¶é€šä¿¡ï¼ˆContext APIï¼‰</strong>: å¯¹äºå±‚çº§åµŒå¥—è¾ƒæ·±çš„ç»„ä»¶ï¼Œé€å±‚é€šè¿‡ props ä¼ é€’æ•°æ®ä¼šå¯¼è‡´ä»£ç è‡ƒè‚¿ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ Context API æ¥å®ç°è·¨å±‚çº§ç»„ä»¶çš„é€šä¿¡ã€‚Context æä¾›äº†ä¸€ä¸ªå…¨å±€çš„çŠ¶æ€æˆ–å‡½æ•°ï¼Œå…è®¸ä»»æ„ç»„ä»¶è®¢é˜…å¹¶è®¿é—®è¿™äº›æ•°æ®</li><li><strong>å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆReduxã€MobX ç­‰ï¼‰</strong>: å¯¹äºå¤æ‚çš„åº”ç”¨ï¼Œå°¤å…¶æ˜¯æœ‰å¤§é‡ç»„ä»¶éœ€è¦å…±äº«çŠ¶æ€æ—¶ï¼Œä½¿ç”¨ Redux æˆ– MobX ç­‰çŠ¶æ€ç®¡ç†åº“å¯ä»¥å¸®åŠ©ç®¡ç†å…¨å±€çŠ¶æ€ã€‚Redux çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†çŠ¶æ€é›†ä¸­ç®¡ç†ï¼Œç»„ä»¶é€šè¿‡è®¢é˜…çŠ¶æ€å’Œåˆ†å‘ï¼ˆdispatchï¼‰åŠ¨ä½œæ¥å®ç°é€šä¿¡</li><li><strong>Refsï¼ˆçˆ¶å­ç»„ä»¶ç›´æ¥å¼•ç”¨é€šä¿¡ï¼‰</strong>: æœ‰æ—¶éœ€è¦ç›´æ¥è®¿é—®å­ç»„ä»¶çš„æŸä¸ªå®ä¾‹æˆ– DOM èŠ‚ç‚¹ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ Refs å®ç°çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶çš„é€šä¿¡ã€‚çˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡ ref è·å–å­ç»„ä»¶å®ä¾‹ï¼Œå¹¶è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•æˆ–è®¿é—®å­ç»„ä»¶çš„ DOM èŠ‚ç‚¹</li></ul><h3 id="cssä¸­å‚ç›´å±…ä¸­çš„4ç§æ–¹å¼"><a href="#cssä¸­å‚ç›´å±…ä¸­çš„4ç§æ–¹å¼" class="headerlink" title="cssä¸­å‚ç›´å±…ä¸­çš„4ç§æ–¹å¼"></a>cssä¸­å‚ç›´å±…ä¸­çš„4ç§æ–¹å¼</h3><ul><li>ä½¿ç”¨ flexbox å®ç°å‚ç›´å±…ä¸­</li><li>ä½¿ç”¨ grid å®ç°å‚ç›´å±…ä¸­</li><li>ä½¿ç”¨ absolute positioning å’Œ transform å®ç°å‚ç›´å±…ä¸­</li><li>ä½¿ç”¨ line-height å®ç°å‚ç›´å±…ä¸­ï¼ˆä»…é™å•è¡Œæ–‡æœ¬ï¼‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> nodejs </category>
          
          <category> æ•æ·å¼€å‘ </category>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptä¸­çš„é—­åŒ…</title>
      <link href="/2024/10/20/front-end/javascript-closure/"/>
      <url>/2024/10/20/front-end/javascript-closure/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>é—­åŒ…ï¼ˆclosureï¼‰æ˜¯ä¸€ä¸ªå‡½æ•°ä»¥åŠå…¶æ†ç»‘çš„å‘¨è¾¹ç¯å¢ƒçŠ¶æ€ï¼ˆlexical environmentï¼Œè¯æ³•ç¯å¢ƒï¼‰çš„å¼•ç”¨çš„ç»„åˆã€‚æ¢è€Œè¨€ä¹‹ï¼Œé—­åŒ…è®©å¼€å‘è€…å¯ä»¥ä»å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸã€‚åœ¨ JavaScript ä¸­ï¼Œé—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„, é—­åŒ…ä¼šéšç€å‡½æ•°çš„åˆ›å»ºè€Œè¢«åŒæ—¶åˆ›å»ºã€‚</p><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><blockquote><p>æœ¬éƒ¨åˆ†ä¾‹å­æ¥è‡ªchatgpt</p></blockquote><ol><li>åˆ›å»ºç§æœ‰å˜é‡</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="title function_">createCounter</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">counter</span>()); <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">counter</span>());</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¿æŒå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inner = <span class="title function_">outer</span>();</span><br><span class="line"><span class="title function_">inner</span>(); <span class="comment">// è¾“å‡º &quot;John&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="3"><li>å‡½æ•°æŸ¯é‡ŒåŒ–</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addFive = <span class="title function_">add</span>(<span class="number">5</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">addFive</span>(<span class="number">10</span>)); <span class="comment">// è¾“å‡º 15</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>å»¶è¿Ÿæ‰§è¡Œå’Œå¼‚æ­¥ç¼–ç¨‹</li></ol><p>é—­åŒ…å¸¸ç”¨äºå»¶è¿Ÿæ‰§è¡Œå’Œå¤„ç†å¼‚æ­¥æ“ä½œï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿä¿å­˜å¤–éƒ¨å‡½æ•°ä¸­çš„çŠ¶æ€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">delayedMessage</span>(<span class="params">message, delay</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>æ¨¡æ‹Ÿæ¨¡å—</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable language_">module</span> = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> privateVar = <span class="string">&quot;I&#x27;m private&quot;</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">privateMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(privateVar);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">publicMethod</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">privateMethod</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">publicMethod</span>(); <span class="comment">// è¾“å‡º &quot;I&#x27;m private&quot;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“æ¥è¯´ï¼Œé—­åŒ…åœ¨ JavaScript ä¸­ç”¨äºæ•°æ®çš„å°è£…ã€çŠ¶æ€çš„ä¿æŒã€å¼‚æ­¥ç¼–ç¨‹ä»¥åŠæé«˜ä»£ç çš„çµæ´»æ€§ä¸æ¨¡å—åŒ–ã€‚</p><h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><p>å¦‚æœä½ èƒ½ç†è§£ä¸‹é¢ä¸¤æ®µä»£ç çš„è¿è¡Œç»“æœï¼Œåº”è¯¥å°±ç®—ç†è§£é—­åŒ…çš„è¿è¡Œæœºåˆ¶äº†ã€‚</p><p>ä»£ç ç‰‡æ®µä¸€ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;The Window&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> object = &#123;</span><br><span class="line">ã€€ã€€name : <span class="string">&quot;My Object&quot;</span>,</span><br><span class="line"></span><br><span class="line">ã€€ã€€getNameFunc : <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;;</span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(object.<span class="title function_">getNameFunc</span>()())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»£ç äºŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;The Window&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> object = &#123;</span><br><span class="line">ã€€ã€€name : <span class="string">&quot;My Object&quot;</span>,</span><br><span class="line"></span><br><span class="line">ã€€ã€€getNameFunc : <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        that = <span class="variable language_">this</span>;</span><br><span class="line">ã€€ã€€ã€€  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€  <span class="keyword">return</span> that.<span class="property">name</span>;</span><br><span class="line">ã€€ã€€ã€€  &#125;;</span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(object.<span class="title function_">getNameFunc</span>()());</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures">é—­åŒ…</a></li><li><a href="https://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html">å­¦ä¹ Javascripté—­åŒ…ï¼ˆClosureï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨docker-composeå¤‡ä»½Postgres Dockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2024/07/10/back-end/back-end-how-to-backup-postgres-docker-container/"/>
      <url>/2024/07/10/back-end/back-end-how-to-backup-postgres-docker-container/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨docker-composeå¤‡ä»½Postgres-Dockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ"><a href="#ä½¿ç”¨docker-composeå¤‡ä»½Postgres-Dockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä½¿ç”¨docker-composeå¤‡ä»½Postgres Dockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ"></a>ä½¿ç”¨docker-composeå¤‡ä»½Postgres Dockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ</h1><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><p>ä½¿ç”¨<code>pg_dumpall</code>å‘½ä»¤å¤‡ä»½Postgresæ•°æ®åº“ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="built_in">exec</span> &lt;postgres_service&gt; pg_dumpall -U postgres &gt; dump_`<span class="built_in">date</span> +%Y-%m-%d<span class="string">&quot;_&quot;</span>%H_%M_%S`.sql</span><br></pre></td></tr></table></figure><ol><li><code>docker-compose exec &lt;postgres_service&gt;</code> åœ¨åä¸º<code>&lt;postgres_service&gt;</code>çš„Postgreså®¹å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚</li><li><code>-U postgres</code> æŒ‡å®šæ•°æ®åº“çš„ç”¨æˆ·åã€‚Dockerçš„é»˜è®¤ç”¨æˆ·åæ˜¯<code>postgres</code>ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·åï¼Œè¯·è¿›è¡Œä¿®æ”¹ã€‚</li></ol><h2 id="æ¢å¤"><a href="#æ¢å¤" class="headerlink" title="æ¢å¤"></a>æ¢å¤</h2><p>å°†<code>dump_</code>date +%Y-%m-%dâ€<em>â€œ%H</em>%M_%S<code>.sql</code>æ–‡ä»¶æ”¾ç½®åœ¨<code>backup</code>æ–‡ä»¶å¤¹ä¸­ã€‚</p><p>ç„¶åä½¿ç”¨Dockerå·å°†<code>backup</code>æ–‡ä»¶å¤¹ç»‘å®šåˆ°Postgreså®¹å™¨ä¸Šï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">    - ./backup:/backup</span><br></pre></td></tr></table></figure><p>åˆ é™¤ç°æœ‰çš„Postgreså®¹å™¨å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down &amp;&amp; docker-compose up -d</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ•°æ®åº“å¯¼å…¥å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="built_in">exec</span> postgres psql -f /backup/dump_xxx.sql postgres -U postgres</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://wdt.im/posts/docker-compose-postgres-backup-restore/">ä½¿ç”¨docker-composeå¤‡ä»½å’Œæ¢å¤Postgresæ•°æ®åº“</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨10åˆ†é’Ÿå†…ä½¿ç”¨LangChain</title>
      <link href="/2024/06/09/ai/how-to-use-langchain-in-10-minutes/"/>
      <url>/2024/06/09/ai/how-to-use-langchain-in-10-minutes/</url>
      
        <content type="html"><![CDATA[<h1 id="å¦‚ä½•åœ¨10åˆ†é’Ÿå†…ä½¿ç”¨LangChain"><a href="#å¦‚ä½•åœ¨10åˆ†é’Ÿå†…ä½¿ç”¨LangChain" class="headerlink" title="å¦‚ä½•åœ¨10åˆ†é’Ÿå†…ä½¿ç”¨LangChain"></a>å¦‚ä½•åœ¨10åˆ†é’Ÿå†…ä½¿ç”¨LangChain</h1><p><a href="https://www.langchain.com/">LangChain</a>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„Pythonå’ŒJavascript&#x2F;Typescriptåº“ï¼Œå®ƒå¯ä»¥è®©ä½ å¿«é€Ÿåœ°åŸå‹åŒ–å¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨ã€‚å®ƒå…è®¸ä½ å°†LLMä»»åŠ¡é“¾åœ¨ä¸€èµ·ï¼ˆå› æ­¤å¾—åï¼‰ï¼Œç”šè‡³å¯ä»¥è®©ä½ å¿«é€Ÿè½»æ¾åœ°è¿è¡Œ<i>è‡ªä¸»ä»£ç†(autonomous agents)</i>ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»‹ç»chainçš„åŸºç¡€çŸ¥è¯†ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç«‹å³å¼€å§‹ä½ æœ€æ–°çš„LLMé¡¹ç›®ã€‚</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡ä¸»è¦è®¨è®ºäº†LangChainçš„ä½¿ç”¨å’Œä¼˜åŠ¿ã€‚LangChainæ˜¯ä¸€ä¸ªå¯¹äºå¸Œæœ›å¿«é€Ÿåˆ›å»ºå¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨çš„äººæ¥è¯´éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚å®ƒå¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…åˆ›å»ºé“¾ã€å®šä¹‰æç¤ºï¼Œç”šè‡³å°†å¤šä¸ªLLMè°ƒç”¨é“¾æ¥åœ¨ä¸€èµ·ä»¥åˆ›å»ºåŠ¨æ€çš„TikTokè„šæœ¬ã€‚</p><p>LangChainçš„ä¼˜åŠ¿åœ¨äºå…¶ç®€å•æ€§å’Œçµæ´»æ€§ã€‚æ— è®ºä½ æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…è¿˜æ˜¯åˆšåˆšèµ·æ­¥ï¼ŒLangChainçš„ç›´è§‚è®¾è®¡éƒ½è®©ä½ èƒ½å¤Ÿåƒä»æœªæœ‰è¿‡çš„é‚£æ ·åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚ä»ç”Ÿæˆåˆ›æ„å†…å®¹åˆ°è¿è¡Œè‡ªä¸»ä»£ç†ï¼Œå¯èƒ½æ€§æ˜¯æ— ç©·æ— å°½çš„ã€‚</p><p>æ­¤å¤–ï¼Œå¦‚æœä½ æ­£åœ¨å¯»æ‰¾å°†AIé›†æˆåˆ°ä½ ç°æœ‰çš„å·¥ä½œæµç¨‹æˆ–äº§å“ä¸­ï¼ŒTimeSurge Labså¯ä»¥æä¾›å¸®åŠ©ã€‚ä»–ä»¬ä¸“æ³¨äºAIå’¨è¯¢ã€å¼€å‘ã€å†…éƒ¨å·¥å…·å’ŒLLMæ‰˜ç®¡ï¼Œä»–ä»¬çš„å›¢é˜Ÿè‡´åŠ›äºæ„å»ºAIçš„æœªæ¥ï¼Œå¹¶å¸®åŠ©ä½ çš„ä¸šåŠ¡åœ¨è¿™ä¸ªå¿«é€Ÿå˜åŒ–çš„è¡Œä¸šä¸­è“¬å‹ƒå‘å±•ã€‚</p><blockquote><p>è¯¥éƒ¨åˆ†ä½¿ç”¨AIè‡ªåŠ¨ç”Ÿæˆ</p></blockquote><h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><ol><li>Python 3.9ï¼ˆ3.10åŠä»¥ä¸Šç‰ˆæœ¬ä¸LangChainçš„ä¸€äº›æ¨¡å—å­˜åœ¨ä¸€äº›é—®é¢˜ï¼‰ã€‚ </li><li>ä¸€ä¸ªOpenAI APIå¯†é’¥</li></ol><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªPythonè™šæ‹Ÿç¯å¢ƒï¼Œå¹¶é€šè¿‡è¿™ç§æ–¹å¼å®‰è£…ä¾èµ–é¡¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> myproject</span><br><span class="line"><span class="built_in">cd</span> myproject</span><br><span class="line"><span class="comment"># or python3, python3.9, etc depending on your setup</span></span><br><span class="line">python -m venv <span class="built_in">env</span></span><br><span class="line"><span class="built_in">source</span> <span class="built_in">env</span>/bin/activate</span><br></pre></td></tr></table></figure><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å®‰è£…ä¾èµ–é¡¹ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å®‰è£…LangChainå’ŒOpenAIã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨python-dotenvæ¥å°†OpenAI APIå¯†é’¥åŠ è½½åˆ°ç¯å¢ƒä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain openai python-dotenv</span><br></pre></td></tr></table></figure><p>LangChainæ˜¯ä¸€ä¸ªéå¸¸å¤§çš„åº“ï¼Œæ‰€ä»¥ä¸‹è½½å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿã€‚åœ¨ä¸‹è½½çš„åŒæ—¶ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º.envçš„æ–°æ–‡ä»¶ï¼Œå¹¶å°†ä½ çš„APIå¯†é’¥ç²˜è´´è¿›å»ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPENAI_API_KEY=Your-api-key-here</span><br></pre></td></tr></table></figure><p>ä¸€æ—¦å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€æ¡chainäº†ã€‚</p><h2 id="æ¦‚å¿µå¿«é€Ÿå…¥é—¨"><a href="#æ¦‚å¿µå¿«é€Ÿå…¥é—¨" class="headerlink" title="æ¦‚å¿µå¿«é€Ÿå…¥é—¨"></a>æ¦‚å¿µå¿«é€Ÿå…¥é—¨</h2><p>åœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›åŸºç¡€çš„æ¦‚å¿µã€‚</p><ol><li><b>Chain</b>: å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªä¸LLMï¼ˆè¯­è¨€æ¨¡å‹ï¼‰äº¤äº’æˆ–åœ¨åˆ—è¡¨ä¸­è¿›è¡Œå¤šæ¬¡LLMè°ƒç”¨çš„è¡ŒåŠ¨åˆ—è¡¨ã€‚ä¸€ä¸ªé“¾ç”±ä¸‰ä¸ªç®€å•çš„éƒ¨åˆ†ç»„æˆã€‚<br> a. <a href="https://python.langchain.com/docs/modules/model_io/prompts/prompt_templates/">æç¤ºæ¨¡æ¿</a> - è¿™æ ·ä½ å¯ä»¥å¿«é€Ÿæ”¹å˜è¾“å…¥è€Œä¸æ”¹å˜æç¤ºã€‚<br> b. <a href="https://python.langchain.com/v0.1/docs/modules/model_io/llms/">LLM</a> - å®é™…è¿è¡Œä½ çš„æç¤ºçš„AIã€‚<br> c. <a href="https://python.langchain.com/v0.1/docs/modules/model_io/output_parsers/">è¾“å‡ºè§£æå™¨</a> - å°†è¾“å‡ºè½¬æ¢æˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œé€šå¸¸åªæ˜¯å¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li></ol><h2 id="ç¼–å†™Chain"><a href="#ç¼–å†™Chain" class="headerlink" title="ç¼–å†™Chain"></a>ç¼–å†™Chain</h2><p> å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªç”ŸæˆTikTokè„šæœ¬çš„é“¾ï¼ˆæ¯•ç«Ÿæˆ‘æ˜¯ä¸€ä¸ª<a href="https://www.urbandictionary.com/define.php?term=Zoomer">Zoomer</a>ï¼‰ç”¨äºä¸€ä¸ªæ•™è‚²é¢‘é“ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªTikTokçš„æè¿°ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æç¤ºæ¨¡æ¿ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç¨åé‡ç”¨æç¤ºã€‚</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prompts.py</span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate</span><br><span class="line"></span><br><span class="line">description_prompt = PromptTemplate.from_template(</span><br><span class="line">    <span class="string">&quot;Write me a description for a TikTok about &#123;topic&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><p> è¿™å¯ä»¥åœ¨chainä¸­ä½¿ç”¨ã€‚åœ¨æˆ‘ä»¬å®šä¹‰é“¾ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºchainå®šä¹‰ä¸€ä¸ªLLMã€‚LangChainå»ºè®®å¤§å¤šæ•°ç”¨æˆ·åº”è¯¥ä½¿ç”¨ChatOpenAIç±»ï¼Œä»¥è·å¾—ChatGPT APIçš„æˆæœ¬æ•ˆç›Šå’Œç®€å•æ€§ã€‚</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># chain.py</span></span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="keyword">from</span> prompts <span class="keyword">import</span> description_prompt</span><br><span class="line"></span><br><span class="line"><span class="comment"># loads the .env file</span></span><br><span class="line">load_dotenv()</span><br><span class="line"></span><br><span class="line">llm = ChatOpenAI(model_name=<span class="string">&quot;gpt-3.5-turbo&quot;</span>)</span><br></pre></td></tr></table></figure><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºchainäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">description_chain = LLMChain(llm=llm, prompt=description_prompt, verbose=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<b>.predict</b>æ¥è°ƒç”¨æ–°çš„chainã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">output = description_chain.predict(topic=<span class="string">&quot;Cats are cool&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯è¾“å‡ºç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ğŸ˜» Unleash your inner feline aficionado! From their enchanting eyes to their purrfectly mysterious ways, cats are the epitome of coolness. ğŸ¾ Watch as they effortlessly own their spaces, teaching us the art of relaxation and play. Whether they<span class="string">&#x27;re mastering acrobatics or curling up for a catnap, their cool vibes are undeniable. ğŸ˜ Join the cat craze and embrace the awesomeness of these four-legged trendsetters! ğŸ±ğŸ’« #CatsRule #CoolCats #FelineVibes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸­æ–‡ç¿»è¯‘ï¼šğŸ˜» é‡Šæ”¾ä½ å†…å¿ƒçš„çŒ«å’ªçˆ±å¥½è€…ï¼ä»ä»–ä»¬è¿·äººçš„çœ¼ç›åˆ°ä»–ä»¬å®Œç¾çš„ç¥ç§˜æ–¹å¼ï¼ŒçŒ«å’ªæ˜¯é…·çš„è±¡å¾ã€‚ğŸ¾ è§‚å¯Ÿä»–ä»¬å¦‚ä½•æ¯«ä¸è´¹åŠ›åœ°æ‹¥æœ‰è‡ªå·±çš„ç©ºé—´ï¼Œæ•™æˆ‘ä»¬æ”¾æ¾å’Œç©è€çš„è‰ºæœ¯ã€‚æ— è®ºä»–ä»¬æ˜¯åœ¨æŒæ¡æ‚æŠ€è¿˜æ˜¯å·èµ·æ¥æ‰“ä¸ªçŒ«è§‰ï¼Œä»–ä»¬çš„é…·åŠ²æ˜¯æ— æ³•å¦è®¤çš„ã€‚ğŸ˜ åŠ å…¥çŒ«å’ªç‹‚çƒ­ï¼Œæ‹¥æŠ±è¿™äº›å››è¶³æ½®æµå¼•é¢†è€…çš„é…·ç‚«ï¼ğŸ±ğŸ’« #çŒ«å’ªç»Ÿæ²» #é…·çŒ« #çŒ«å’ªæ°›å›´</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæè¿°ï¼Œæˆ‘ä»¬éœ€è¦è®©å®ƒå†™ä¸€ä¸ªè„šæœ¬ã€‚è¿™å°±æ˜¯chainçš„ä½œç”¨ - æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¨å¾®ä¸åŒçš„æç¤ºå†æ¬¡ä¾æ¬¡è°ƒç”¨LLMã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä¸ºä¸‹ä¸€ä¸ªchainå®šä¹‰ä¸€ä¸ªæ–°çš„æç¤ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add to prompts.py</span></span><br><span class="line"></span><br><span class="line">script_prompt = PromptTemplate.from_template(</span><br><span class="line">    <span class="string">&quot;Write me a script for a TikTok given the following description: &#123;description&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä½ ç°åœ¨çš„chain.pyåº”è¯¥æ˜¯è¿™æ ·å­çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chain.py</span></span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="comment"># this line changed!!!!!</span></span><br><span class="line"><span class="keyword">from</span> prompts <span class="keyword">import</span> description_prompt, script_prompt</span><br><span class="line"></span><br><span class="line"><span class="comment"># loads the .env file</span></span><br><span class="line">load_dotenv()</span><br><span class="line"></span><br><span class="line">llm = ChatOpenAI(model_name=<span class="string">&quot;gpt-3.5-turbo&quot;</span>)</span><br><span class="line"></span><br><span class="line">description_chain = LLMChain(llm=llm, prompt=description_prompt, verbose=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">output = description_chain.predict(topic=<span class="string">&quot;Cats are cool&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># new code below this line</span></span><br><span class="line">script_chain = LLMChain(llm=llm, prompt=script_prompt)</span><br><span class="line">script = script_chain.predict(description=output, verbose=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># åŸæ–‡æ˜¯script = description_chain.predict(description=output, verbose=True)ï¼Œåº”è¯¥æ˜¯é”™è¯¯</span></span><br><span class="line"><span class="built_in">print</span>(script)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ–°çš„è¾“å‡ºç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[Opening shot: A close-up of a cat<span class="string">&#x27;s mesmerizing eyes, slowly blinking.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;ğŸ˜» Unleash your inner feline aficionado!&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Cut to a sleek cat walking confidently through a room, tail swaying gracefully.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;From their enchanting eyes to their purrfectly mysterious ways...&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Transition to a montage of cats lounging in different relaxed poses.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;Cats are the epitome of coolness. ğŸ¾&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Show a cat effortlessly jumping onto a high shelf, landing with precision.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;Watch as they effortlessly own their spaces...&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Cut to a person lying on the couch while a cat playfully bats at a string toy.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;Teaching us the art of relaxation and play.&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Show a cat doing a graceful mid-air flip while chasing a feather toy.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;Whether they&#x27;</span>re mastering acrobatics...<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Transition to a cozy scene of a cat curled up in a sunlit spot, eyes half-closed.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;</span>Or curling up <span class="keyword">for</span> a catnap...<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Cut to a group of cats with various personalities and fur patterns.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;</span>Their cool vibes are undeniable.<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Show a person petting a content cat, both sharing a moment of connection.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;</span>ğŸ˜ Join the cat craze <span class="keyword">and</span> embrace the awesomeness...<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Cut to a playful cat chasing its tail, accompanied by a cheerful laugh.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;</span>...of these four-legged trendsetters!<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[End with a shot of a cat sitting regally, gazing confidently into the camera.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;</span>ğŸ±ğŸ’« <span class="comment">#CatsRule #CoolCats #FelineVibes&quot;</span></span><br><span class="line"></span><br><span class="line">[Fade out <span class="keyword">with</span> a final glimpse of a cat<span class="string">&#x27;s eyes.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Narrator (Voiceover): &quot;Because when it comes to cool, cats wrote the book.&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[End screen: &quot;Follow for more feline fun!&quot;]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Background music fades out as the TikTok video concludes.]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸­æ–‡ç¿»è¯‘ï¼š[åˆ‡æ¢åˆ°ä¸€ä¸ªç©è€çš„çŒ«è¿½é€å®ƒçš„å°¾å·´çš„é•œå¤´ï¼Œä¼´éšç€ä¸€é˜µæ¬¢å¿«çš„ç¬‘å£°ã€‚]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ—ç™½ï¼ˆé…éŸ³ï¼‰ï¼š&quot;...è¿™äº›å››è¶³çš„æ½®æµå¼•é¢†è€…ï¼&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ä»¥ä¸€åªçŒ«åå¾—åƒçš‡æ—ä¸€æ ·ï¼Œè‡ªä¿¡åœ°å‡è§†ç€æ‘„åƒæœºçš„é•œå¤´ç»“æŸã€‚]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ—ç™½ï¼ˆé…éŸ³ï¼‰ï¼š&quot;ğŸ±ğŸ’« #çŒ«å’ªç»Ÿæ²» #é…·çŒ« #çŒ«å’ªæ°›å›´&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ä»¥çŒ«çœ¼çš„æœ€åä¸€ç¥æ·¡å‡ºã€‚]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ—ç™½ï¼ˆé…éŸ³ï¼‰ï¼š&quot;å› ä¸ºå½“è°ˆåˆ°é…·ï¼ŒçŒ«å’ªå†™ä¸‹äº†è§„åˆ™ã€‚&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ç»“æŸç”»é¢ï¼š&quot;å…³æ³¨æ›´å¤šçš„çŒ«å’ªä¹è¶£ï¼&quot;]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[éšç€TikTokè§†é¢‘çš„ç»“æŸï¼ŒèƒŒæ™¯éŸ³ä¹æ¸æ¸æ·¡å‡ºã€‚]</span></span><br></pre></td></tr></table></figure><p>åƒè¿™æ ·ä½¿ç”¨å®ƒä»¬æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦å°†å®ƒä»¬é“¾åœ¨ä¸€èµ·å‘¢ï¼Ÿè¿™å°±æ˜¯<a href="https://python.langchain.com/docs/modules/chains/foundational/sequential_chains">Sequential Chains</a>çš„ä½œç”¨ã€‚è¿™äº›å…è®¸ä½ å°†å¤šä¸ªé“¾ç»‘å®šåˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­ï¼Œå®ƒä»¬æŒ‰ç…§å®šä¹‰çš„é¡ºåºæ‰§è¡Œã€‚æœ‰ä¸¤ç§ç±»å‹çš„é¡ºåºé“¾ï¼Œæˆ‘ä»¬åªå…³æ³¨ç®€å•çš„é¡ºåºé“¾ã€‚å°†Chainå¯¼å…¥è¡Œç¼–è¾‘ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain, SimpleSequentialChain</span><br></pre></td></tr></table></figure><p>å°†LLMé“¾ç§»åŠ¨åˆ°æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œåˆ é™¤printè¯­å¥å’Œ.predictè°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chain.py</span></span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain, SimpleSequentialChain</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="comment"># this line changed!!!!!</span></span><br><span class="line"><span class="keyword">from</span> prompts <span class="keyword">import</span> description_prompt, script_prompt</span><br><span class="line"></span><br><span class="line"><span class="comment"># loads the .env file</span></span><br><span class="line">load_dotenv()</span><br><span class="line"></span><br><span class="line">llm = ChatOpenAI(model_name=<span class="string">&quot;gpt-3.5-turbo&quot;</span>)</span><br><span class="line"></span><br><span class="line">description_chain = LLMChain(llm=llm, prompt=description_prompt)</span><br><span class="line">script_chain = LLMChain(llm=llm, prompt=script_prompt)</span><br><span class="line"></span><br><span class="line">tiktok_chain = SimpleSequentialChain(chains=[description_chain, script_chain], verbose=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">script = tiktok_chain.run(<span class="string">&quot;cats are cool&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(script)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">Title: <span class="comment">#CoolCatsRule</span></span><br><span class="line"></span><br><span class="line">INT. LIVING ROOM - DAY</span><br><span class="line"></span><br><span class="line">A trendy, upbeat song begins playing as the camera pans across a stylishly decorated living room. Various cat-themed decorations can be seen, setting the perfect atmosphere <span class="keyword">for</span> showcasing the undeniable coolness of cats.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. BEDROOM - DAY</span><br><span class="line"></span><br><span class="line">A YOUNG WOMAN, <span class="keyword">in</span> her early twenties, stands <span class="keyword">in</span> front of a full-length mirror. She wears trendy clothes and holds a CAT, <span class="built_in">who</span> seems equally as cool, <span class="keyword">in</span> her arms.</span><br><span class="line"></span><br><span class="line">YOUNG WOMAN</span><br><span class="line">(looking into the mirror)</span><br><span class="line">Ready to show the world why cats rule!</span><br><span class="line"></span><br><span class="line">The young woman gently places the <span class="built_in">cat</span> on the ground as the camera zooms <span class="keyword">in</span> on the feline.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. KITCHEN - DAY</span><br><span class="line"></span><br><span class="line">A CAT sits on the kitchen counter, effortlessly balancing on one paw <span class="keyword">while</span> wearing sunglasses. The camera pans around it, capturing its cool demeanor.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. BACKYARD - DAY</span><br><span class="line"></span><br><span class="line">A CAT lounges <span class="keyword">in</span> a hammock, wearing a tiny hat and reading a book. The camera captures its relaxed and sophisticated vibe.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. LIVING ROOM - DAY</span><br><span class="line"></span><br><span class="line">The young woman sits on the couch, surrounded by a group of COOL CATS. Each <span class="built_in">cat</span> showcases their unique coolness, like one wearing a leather jacket and another playing a tiny electric guitar.</span><br><span class="line"></span><br><span class="line">YOUNG WOMAN</span><br><span class="line">(points to the cats)</span><br><span class="line">See? Cats rule!</span><br><span class="line"></span><br><span class="line">The camera zooms <span class="keyword">in</span> on the cats, showing their undeniable feline awesomeness.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. LIVING ROOM - DAY</span><br><span class="line"></span><br><span class="line">The young woman and her cool cats gather around a table, <span class="built_in">where</span> they enjoy a mini-cat party. There are cat-themed snacks, funky drinks, and even a DJ <span class="built_in">cat</span> scratching vinyl records.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. LIVING ROOM - DAY</span><br><span class="line"></span><br><span class="line">The young woman holds up a sign saying <span class="string">&quot;#CoolCatsRule&quot;</span> as the cats pose beside her. The camera pans out to reveal a fun, energetic dance routine as they all groove to the beat.</span><br><span class="line"></span><br><span class="line">CUT TO:</span><br><span class="line"></span><br><span class="line">INT. LIVING ROOM - DAY</span><br><span class="line"></span><br><span class="line">The young woman and her cool cats strike a final pose, with the camera capturing their undeniable coolness.</span><br><span class="line"></span><br><span class="line">YOUNG WOMAN</span><br><span class="line">(looking at the camera)</span><br><span class="line">Remember, folks, cats rule!</span><br><span class="line"></span><br><span class="line">The screen fades out with the hashtag <span class="comment">#CoolCatsRule displayed prominently.</span></span><br><span class="line"></span><br><span class="line">FADE OUT.</span><br><span class="line"></span><br><span class="line">ä¸­æ–‡ç¿»è¯‘ï¼šå®¤å†…ã€‚å®¢å… - ç™½å¤©</span><br><span class="line"></span><br><span class="line">å¹´è½»å¥³å­ä¸¾èµ·ä¸€ä¸ªå†™ç€<span class="string">&quot;#CoolCatsRule&quot;</span>çš„ç‰Œå­ï¼ŒçŒ«å’ªä»¬åœ¨å¥¹æ—è¾¹æ‘†å¥½å§¿åŠ¿ã€‚æ‘„åƒæœºæ‹‰è¿œï¼Œå±•ç¤ºå‡ºä¸€ä¸ªå……æ»¡æ´»åŠ›çš„èˆè¹ˆï¼Œä»–ä»¬éƒ½åœ¨éšç€èŠ‚å¥æ‘‡æ‘†ã€‚</span><br><span class="line"></span><br><span class="line">åˆ‡æ¢åˆ°ï¼š</span><br><span class="line"></span><br><span class="line">å®¤å†…ã€‚å®¢å… - ç™½å¤©</span><br><span class="line"></span><br><span class="line">å¹´è½»å¥³å­å’Œå¥¹é…·çŒ«ä»¬æ‘†å‡ºæœ€åçš„å§¿åŠ¿ï¼Œæ‘„åƒæœºæ•æ‰åˆ°ä»–ä»¬æ— å¯å¦è®¤çš„é…·åŠ²ã€‚</span><br><span class="line"></span><br><span class="line">å¹´è½»å¥³å­ (çœ‹ç€æ‘„åƒæœº) è®°ä½ï¼Œå¤§å®¶ï¼ŒçŒ«å’ªæ‰æ˜¯çœŸæ­£çš„ä¸»å®°ï¼</span><br><span class="line"></span><br><span class="line">å±å¹•ä»¥<span class="comment">#CoolCatsRuleçš„æ ‡ç­¾æ˜¾çœ¼åœ°æ·¡å‡ºã€‚</span></span><br><span class="line"></span><br><span class="line">æ·¡å‡º</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>LangChainå¯¹äºä»»ä½•å¸Œæœ›å¿«é€ŸåŸå‹åŒ–å¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨çš„äººæ¥è¯´éƒ½æ˜¯ä¸€ä¸ªæ¸¸æˆè§„åˆ™æ”¹å˜è€…ã€‚åœ¨çŸ­çŸ­å‡ åˆ†é’Ÿå†…ï¼Œæˆ‘ä»¬å·²ç»èµ°è¿‡äº†åˆ›å»ºchainã€å®šä¹‰æç¤ºï¼Œç”šè‡³å°†å¤šä¸ªLLMè°ƒç”¨é“¾åœ¨ä¸€èµ·ä»¥åˆ›å»ºåŠ¨æ€çš„TikTokè„šæœ¬çš„è¿‡ç¨‹ã€‚</p><p>LangChainçš„åŠ›é‡åœ¨äºå…¶ç®€å•æ€§å’Œçµæ´»æ€§ã€‚æ— è®ºä½ æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…è¿˜æ˜¯åˆšåˆšèµ·æ­¥ï¼ŒLangChainçš„ç›´è§‚è®¾è®¡éƒ½è®©ä½ èƒ½å¤Ÿåƒä»æœªæœ‰è¿‡çš„é‚£æ ·åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚ä»ç”Ÿæˆåˆ›æ„å†…å®¹åˆ°è¿è¡Œè‡ªä¸»ä»£ç†ï¼Œå¯èƒ½æ€§æ˜¯æ— ç©·æ— å°½çš„ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆç­‰å¾…å‘¢ï¼Ÿç«‹å³æ·±å…¥LangChainï¼Œé‡Šæ”¾ä½ çš„é¡¹ç›®ä¸­çš„AIæ½œåŠ›ã€‚å¦‚æœä½ æ­£åœ¨å¯»æ‰¾å°†AIé›†æˆåˆ°ä½ ç°æœ‰çš„å·¥ä½œæµç¨‹æˆ–äº§å“ä¸­ï¼ŒTimeSurge Labsåœ¨è¿™é‡Œæä¾›å¸®åŠ©ã€‚æˆ‘ä»¬ä¸“æ³¨äºAIå’¨è¯¢ã€å¼€å‘ã€å†…éƒ¨å·¥å…·å’ŒLLMæ‰˜ç®¡ï¼Œæˆ‘ä»¬çš„çƒ­æƒ…çš„AIä¸“å®¶å›¢é˜Ÿè‡´åŠ›äºæ„å»ºAIçš„æœªæ¥ï¼Œå¹¶å¸®åŠ©ä½ çš„ä¸šåŠ¡åœ¨è¿™ä¸ªå¿«é€Ÿå˜åŒ–çš„è¡Œä¸šä¸­è“¬å‹ƒå‘å±•ã€‚ä»Šå¤©å°±<a href="https://timesurgelabs.com/#contact">è”ç³»æˆ‘ä»¬</a>!</p><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>æœ¬æ–‡ç¿»è¯‘è‡ª<a href="https://dev.to/timesurgelabs/how-to-use-langchain-in-10-minutes-56e2">How To Use LangChain in 10 Minutes</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> LangChain </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨bazelæ„å»ºspring booté¡¹ç›®</title>
      <link href="/2024/02/11/back-end/use-bazel-build-and-run-spring-boot/"/>
      <url>/2024/02/11/back-end/use-bazel-build-and-run-spring-boot/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ ¹æ®å®˜ç½‘çš„å®šä¹‰ï¼ŒBazelæ˜¯ç±»ä¼¼äºMakeï¼ŒMavenå’ŒGradleçš„å¼€æºæ„å»ºå’Œæµ‹è¯•å·¥å…·ã€‚å®ƒä½¿ç”¨äººç±»å¯è¯»çš„é«˜çº§æ„å»ºè¯­è¨€<a href="https://github.com/bazelbuild/starlark">Starlark</a>(ä¸€ç§åŸºäºpythonçš„æ–¹è¨€)ã€‚ Bazelæ”¯æŒå¤šç§è¯­è¨€çš„é¡¹ç›®ï¼Œå¹¶ä¸ºå¤šç§å¹³å°æ„å»ºè¾“å‡ºã€‚ </p><p>ä»æˆ‘ä¸ªäººè§’åº¦æ¥çœ‹ï¼Œbazelæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”å¤æ‚çš„æ„å»ºç³»ç»Ÿï¼Œé€šè¿‡<code>build rule</code>çš„æ¦‚å¿µï¼Œæ”¯æŒå¤šç§è¯­è¨€ã€ä¸åŒå¹³å°ï¼Œæ”¯æŒæ„å»ºC&#x2F;C++,Java,Android,IOS,Golang,Nodejs,Dockeré¡¹ç›®</p><p>æœ¬æ–‡çš„ç›®çš„æ˜¯ä½¿ç”¨bazelå»æ„å»ºå¹¶è¿è¡Œä¸€ä¸ªspring booté¡¹ç›®ã€‚</p><h1 id="é…ç½®bazelç¼–è¯‘javaé¡¹ç›®"><a href="#é…ç½®bazelç¼–è¯‘javaé¡¹ç›®" class="headerlink" title="é…ç½®bazelç¼–è¯‘javaé¡¹ç›®"></a>é…ç½®bazelç¼–è¯‘javaé¡¹ç›®</h1><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»º<code>.bazelrc</code>æ–‡ä»¶ï¼Œè®¾ç½®bazelä½¿ç”¨java17æ„å»ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build --java_language_version=17 --java_runtime_version=17 --tool_java_language_version=17 --tool_java_runtime_version=17</span><br><span class="line"><span class="built_in">test</span>  --java_language_version=17 --java_runtime_version=17 --tool_java_language_version=17 --tool_java_runtime_version=17</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸­åˆ›å»º<code>workspace</code>æ–‡ä»¶ï¼Œå¹¶å¼•å…¥ç›¸å…³çš„javaä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;, &quot;http_archive&quot;)</span><br><span class="line"></span><br><span class="line">RULES_JVM_EXTERNAL_TAG = &quot;6.0&quot;</span><br><span class="line">RULES_JVM_EXTERNAL_SHA = &quot;c44568854d8bb92fe0f7dd6b1e8957ae65e45e32a058727fcf62aaafbd36f17b&quot;</span><br><span class="line"></span><br><span class="line">http_archive(</span><br><span class="line">    name = &quot;rules_jvm_external&quot;,</span><br><span class="line">    strip_prefix = &quot;rules_jvm_external-%s&quot; % RULES_JVM_EXTERNAL_TAG,</span><br><span class="line">    sha256 = RULES_JVM_EXTERNAL_SHA,</span><br><span class="line">    urls = [</span><br><span class="line">        &quot;https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip&quot; % RULES_JVM_EXTERNAL_TAG,</span><br><span class="line">        &quot;https://mirror.ghproxy.com/https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip&quot; % RULES_JVM_EXTERNAL_TAG,</span><br><span class="line">    ]</span><br><span class="line">   </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">load(&quot;@rules_jvm_external//:repositories.bzl&quot;, &quot;rules_jvm_external_deps&quot;)</span><br><span class="line"></span><br><span class="line">rules_jvm_external_deps()</span><br><span class="line"></span><br><span class="line">load(&quot;@rules_jvm_external//:setup.bzl&quot;, &quot;rules_jvm_external_setup&quot;)</span><br><span class="line"></span><br><span class="line"># rules_jvm_external_setup()</span><br><span class="line"></span><br><span class="line">load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;maven&quot;)</span><br><span class="line">load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;maven_install&quot;)</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ä½¿ç”¨<code>maven_install</code>å¯¼å…¥spring booté¡¹ç›®çš„ç›¸å…³ä¾èµ–ã€‚<br>è¿™é‡Œçš„shiroä¾èµ–è¢«æˆ‘å•ç‹¬æ‹å‡ºæ¥åšç‰¹æ®Šå¤„ç†å»å…¼å®¹java17</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">shiros = [</span><br><span class="line">    maven.artifact(</span><br><span class="line">        group = &quot;org.apache.shiro&quot;,</span><br><span class="line">        artifact = &quot;shiro-spring&quot;,</span><br><span class="line">        version = &quot;1.13.0&quot;,</span><br><span class="line">        classifier = &quot;jakarta&quot;,</span><br><span class="line">        exclusions = [</span><br><span class="line">            maven.exclusion(</span><br><span class="line">                  group = &quot;org.apache.shiro&quot;,</span><br><span class="line">                  artifact = &quot;shiro-core&quot;,</span><br><span class="line">            ),</span><br><span class="line">            maven.exclusion(</span><br><span class="line">                  group = &quot;org.apache.shiro&quot;,</span><br><span class="line">                  artifact = &quot;shiro-web&quot;,</span><br><span class="line">            ),</span><br><span class="line">        ]</span><br><span class="line">    ),</span><br><span class="line">    maven.artifact(</span><br><span class="line">        group = &quot;org.apache.shiro&quot;,</span><br><span class="line">        artifact = &quot;shiro-core&quot;,</span><br><span class="line">        version = &quot;1.13.0&quot;,</span><br><span class="line">        classifier = &quot;jakarta&quot;,</span><br><span class="line">    ),</span><br><span class="line">    maven.artifact(</span><br><span class="line">        group = &quot;org.apache.shiro&quot;,</span><br><span class="line">        artifact = &quot;shiro-web&quot;,</span><br><span class="line">        version = &quot;1.13.0&quot;,</span><br><span class="line">        classifier = &quot;jakarta&quot;,</span><br><span class="line">    ),</span><br><span class="line">   </span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">maven_install(</span><br><span class="line">    artifacts = [</span><br><span class="line">        &quot;org.springframework.boot:spring-boot:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-loader-tools:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-loader:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter-web:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter-jdbc:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter-quartz:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter-aop:3.2.2&quot;,</span><br><span class="line"></span><br><span class="line">        #&quot;org.springframework.boot:spring-boot-configuration-processor:3.2.2&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;io.springfox:springfox-boot-starter:3.0.0&quot;,</span><br><span class="line">        &quot;com.auth0:java-jwt:3.19.4&quot;,</span><br><span class="line">        &quot;org.postgresql:postgresql:42.4.0&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;jakarta.servlet:jakarta.servlet-api:6.0.0&quot;,  </span><br><span class="line">        &#x27;javax.annotation:javax.annotation-api:1.3.2&#x27;,</span><br><span class="line"></span><br><span class="line">        &quot;org.springframework.boot:spring-boot-devtools:3.2.2&quot;,</span><br><span class="line">        &quot;org.springframework.boot:spring-boot-starter-test:3.2.2&quot;</span><br><span class="line">         </span><br><span class="line">    ] + shiros,</span><br><span class="line">    fetch_sources = True,</span><br><span class="line">    repositories = [</span><br><span class="line">        &quot;https://maven.aliyun.com/repository/public/&quot;,</span><br><span class="line">        &quot;https://maven.aliyun.com/nexus/content/groups/public/&quot;,</span><br><span class="line">        &quot;http://uk.maven.org/maven2&quot;,</span><br><span class="line">        &quot;https://maven.google.com&quot;,</span><br><span class="line">        &quot;https://repo1.maven.org/maven2&quot;,</span><br><span class="line">    ],</span><br><span class="line">    # maven_install_json = &quot;//:maven_install.json&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>maven_install_json = &quot;//:maven_install.json&quot;</code>ç›®å‰æ˜¯è¢«æ³¨è§†æ‰çš„ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªåŠ¨ç”Ÿæˆæ”¹æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel run @maven//:pin </span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸä¹‹åéœ€è¦åœ¨<code>workspace</code>ä¸­ç»™<code>maven_install</code>æ·»åŠ <code>maven_install_json</code>å±æ€§, å¹¶å°†åŠ è½½<code>@maven//:defs.bzl</code>ä¸­çš„<code>pinned_maven_install</code>é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">maven_install(</span><br><span class="line">    artifacts = # ...,</span><br><span class="line">    repositories = # ...,</span><br><span class="line">    maven_install_json = &quot;@//:maven_install.json&quot;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">load(&quot;@maven//:defs.bzl&quot;, &quot;pinned_maven_install&quot;)</span><br><span class="line">pinned_maven_install()</span><br></pre></td></tr></table></figure><p>åœ¨æ›´æ–°mavenä¾èµ–çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¾èµ–æ›´æ–°<code>maven_install.json</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel run @unpinned_maven//:pin</span><br></pre></td></tr></table></figure><p><code>maven_install_json</code>æ˜¯å¯ä»¥ä¸ç”¨é…ç½®çš„ï¼Œä½†æ˜¯æˆ‘æ¨èå°½é‡é…ç½®ã€‚å®ƒæœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œå¯é‡å¤æ€§å’Œé€Ÿåº¦ï¼ˆreproducibility and speedï¼‰ã€‚</p><p>åœ¨æ ¹ç›®å½•åˆ›å»º<code>BUILD.bazel</code>è¿›è¡Œç¼–è¯‘javaé¡¹ç›®çš„å‡†å¤‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">oad(&quot;@rules_java//java:defs.bzl&quot;, &quot;java_binary&quot;, &quot;java_library&quot;, &quot;java_test&quot;)</span><br><span class="line"></span><br><span class="line">package(default_visibility = [&quot;//visibility:public&quot;])</span><br><span class="line"></span><br><span class="line">java_library(</span><br><span class="line">    name = &quot;jobs-lib&quot;,</span><br><span class="line">    srcs = glob([</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/api/advice/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/api/controller/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/api/interceptor/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/base/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/base/**/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/config/**/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/pojo/**/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/security/**/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/service/**/*.java&quot;,</span><br><span class="line">        &quot;src/main/java/org/daming/jobs/task/**/*.java&quot;,</span><br><span class="line">    ]),</span><br><span class="line">    resources = glob([&quot;src/main/resources/**&quot;]),</span><br><span class="line">    deps = [</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_starter_web&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_starter_jdbc&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_starter_quartz&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_starter_aop&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@maven//:io_springfox_springfox_boot_starter&quot;,</span><br><span class="line">        &quot;@maven//:io_springfox_springfox_core&quot;,</span><br><span class="line">        &quot;@maven//:io_springfox_springfox_spi&quot;,</span><br><span class="line">        &quot;@maven//:io_springfox_springfox_oas&quot;,</span><br><span class="line">        &quot;@maven//:io_springfox_springfox_spring_web&quot;,</span><br><span class="line">        &quot;@maven//:io_swagger_swagger_annotations&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@maven//:com_auth0_java_jwt&quot;,</span><br><span class="line">        &quot;@maven//:org_postgresql_postgresql&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_devtools&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_loader&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_loader_tools&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_boot_spring_boot_autoconfigure&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_aop&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_beans&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_core&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_context&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_expression&quot;,</span><br><span class="line">        &quot;@maven//:org_springframework_spring_web&quot;,</span><br><span class="line"></span><br><span class="line">        # &quot;@maven//:org_apache_shiro_shiro_spring_boot_starter&quot;,</span><br><span class="line">        &quot;@maven//:org_apache_shiro_shiro_core_jakarta&quot;,</span><br><span class="line">        &quot;@maven//:org_apache_shiro_shiro_spring_jakarta&quot;,</span><br><span class="line">        &quot;@maven//:org_apache_shiro_shiro_web_jakarta&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@maven//:org_slf4j_slf4j_api&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@maven//:org_quartz_scheduler_quartz&quot;,</span><br><span class="line">        &quot;@maven//:org_aspectj_aspectjweaver&quot;,</span><br><span class="line">        &quot;@maven//:org_apache_tomcat_embed_tomcat_embed_core&quot;,</span><br><span class="line">        &quot;@maven//:jakarta_servlet_jakarta_servlet_api&quot;,  </span><br><span class="line">        &quot;@maven//:jakarta_annotation_jakarta_annotation_api&quot;,</span><br><span class="line">        &quot;@maven//:jakarta_xml_bind_jakarta_xml_bind_api&quot;,</span><br><span class="line">        &quot;@maven//:com_fasterxml_jackson_core_jackson_core&quot;,</span><br><span class="line">        &quot;@maven//:com_fasterxml_jackson_core_jackson_databind&quot;</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">java_binary(</span><br><span class="line">    name = &quot;jobs&quot;,</span><br><span class="line">    main_class = &quot;org.daming.jobs.JobsApplication&quot;,</span><br><span class="line">    runtime_deps = [&quot;:jobs-lib&quot;],</span><br><span class="line">    deploy_manifest_lines = &#123;</span><br><span class="line">        &quot;Main-Class&quot;: &quot;org.daming.jobs.JobsApplication&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ‰§è¡Œbazelå‘½ä»¤å»æ„å»ºä¸€ä¸ªjavaé¡¹ç›®äº†:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ„å»º</span><br><span class="line">bazel build //:jobs</span><br><span class="line"></span><br><span class="line"># æ„å»ºå¹¶è¿è¡Œ</span><br><span class="line">bazel run //:jobs</span><br></pre></td></tr></table></figure><p>ç„¶åä½ ä¼šå‘ç°æ„å»ºæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è¿è¡Œä¼šæŠ¥é”™:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">jobs</span> git:(master) âœ— java -jar bazel-bin/jobs.jar            </span><br><span class="line">no main manifest attribute, <span class="keyword">in</span> bazel-bin/jobs.jar</span><br></pre></td></tr></table></figure><p>ç”±äºSpringbootçš„ä»£ç éœ€è¦ä½¿ç”¨Springboot loaderè¿›è¡Œå¯åŠ¨ï¼ŒSpringbootç¨‹åºçš„æ‰“åŒ…é€»è¾‘ä¸æ™®é€šçš„Javaç¨‹åºä¸åŒã€‚è¿™æ„å‘³ç€ï¼ŒBazelåŸç”Ÿçš„ java_binary æ— æ³•æ­£å¸¸å¯åŠ¨Springbootç¨‹åºã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™bazelé…ç½®springç›¸å…³æ”¯æŒã€‚</p><h1 id="é…ç½®rule-springå»æ„å»ºè¿è¡Œspring-boot"><a href="#é…ç½®rule-springå»æ„å»ºè¿è¡Œspring-boot" class="headerlink" title="é…ç½®rule_springå»æ„å»ºè¿è¡Œspring boot"></a>é…ç½®rule_springå»æ„å»ºè¿è¡Œspring boot</h1><p>æˆ‘ä»¬ä½¿ç”¨<a href="https://github.com/salesforce/rules_spring">salesforceçš„rules_spring</a>å®šä¹‰å¥½äº†çš„ruleå»å¸®åŠ©æˆ‘ä»¬æ„å»ºspring booté¡¹ç›®ã€‚</p><p>æˆ‘ä»¬åœ¨<code>workspace</code>æ·»åŠ <code>rules_spring</code>çš„è§„åˆ™æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http_archive(</span><br><span class="line">    name = &quot;rules_spring&quot;,</span><br><span class="line">    sha256 = &quot;7bb891ccb2f53ca188a769b3a3777be1c38348e18091afea05320f3003b3e886&quot;,</span><br><span class="line">    urls = [</span><br><span class="line">        &quot;https://github.com/salesforce/rules_spring/releases/download/2.3.1/rules-spring-2.3.1.zip&quot;,</span><br><span class="line">        &quot;https://mirror.ghproxy.com/https://github.com/salesforce/rules_spring/releases/download/2.3.1/rules-spring-2.3.1.zip&quot;,</span><br><span class="line">    ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>BUILD.bazel</code>ä¸­é—´ä¸­å¯¼å…¥<code>rules_spring</code>çš„ç›¸å…³è§„åˆ™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@rules_spring//springboot:springboot.bzl&quot;, &quot;springboot&quot;)</span><br><span class="line"></span><br><span class="line">springboot(  </span><br><span class="line">    name = &quot;springboot&quot;,  </span><br><span class="line">    # specify the main class</span><br><span class="line">    boot_app_class = &quot;org.daming.jobs.JobsApplication&quot;,</span><br><span class="line">    # refrence the library</span><br><span class="line">    java_library = &quot;:jobs-lib&quot;,</span><br><span class="line">    # https://github.com/salesforce/rules_spring/issues/177</span><br><span class="line">    boot_launcher_class = &#x27;org.springframework.boot.loader.launch.JarLauncher&#x27;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç”±äº<code>spring boot 3.2.0</code>ä¹‹åä½¿ç”¨æ–°çš„å¯åŠ¨å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡ŒæŒ‡å®šäº†<code>boot_launcher_class</code>ã€‚ å¦‚æœä½ ä½¿ç”¨çš„ç‰ˆæœ¬ä½äº3.2.0ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç¼–è¯‘è¿è¡Œspring booté¡¹ç›®äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ„å»º</span><br><span class="line">bazel build //:springboot</span><br><span class="line"></span><br><span class="line"># è¿è¡Œ</span><br><span class="line">bazel run //:springboot</span><br></pre></td></tr></table></figure><p>è¿è¡Œéƒ¨åˆ†è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Application    Name: </span><br><span class="line">Application Version: </span><br><span class="line">Spring Boot Version: 3.2.2 (v3.2.2)</span><br><span class="line">2024-02-11 21:49:17.449 INFO [main] org.springframework.boot.StartupInfoLogger:50 Starting JobsApplication using Java 17 with PID 67028 (/private/var/tmp/_bazel_gming001/7a71463ee80a3358d2f71ab2db616aea/execroot/__main__/bazel-out/darwin_arm64-fastbuild/bin/springboot.jar started by gming001 in /private/var/tmp/_bazel_gming001/7a71463ee80a3358d2f71ab2db616aea/execroot/__main__/bazel-out/darwin_arm64-fastbuild/bin/springboot.runfiles/__main__)</span><br><span class="line">2024-02-11 21:49:17.451 INFO [main] org.springframework.boot.SpringApplication:654 No active profile set, falling back to 1 default profile: &quot;default&quot;</span><br><span class="line">2024-02-11 21:49:17.501 INFO [main] org.springframework.boot.logging.DeferredLog:252 For additional web related logging consider setting the &#x27;logging.level.web&#x27; property to &#x27;DEBUG&#x27;</span><br><span class="line">2024-02-11 21:49:17.846 WARN [main] org.springframework.context.support.AbstractApplicationContext:632 Exception encountered during context initialization - cancelling refresh attempt: java.lang.TypeNotPresentException: Type javax.servlet.http.HttpServletRequest not present</span><br><span class="line">2024-02-11 21:49:17.856 INFO [main] org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLogger:82 </span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="é—ç•™çš„é—®é¢˜"><a href="#é—ç•™çš„é—®é¢˜" class="headerlink" title="é—ç•™çš„é—®é¢˜"></a>é—ç•™çš„é—®é¢˜</h1><p>æœ‰ä¸¤ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¦‚ä½•è¿è¡Œçš„å•å…ƒæµ‹è¯•ï¼Œè¿™ä¸ªè¿˜æ²¡ç ”ç©¶ï¼Œä¸è¿‡è¿™ä¸ªä¸æ€¥ã€‚è¿˜æœ‰ä¸€ä¸ªæ˜¯è¿™ä¸ªé¡¹ç›®å®é™…ä¸Šè·‘ä¸èµ·æ¥ï¼Œä¼šæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.TypeNotPresentException: Type javax.servlet.http.HttpServletRequest not present</span><br></pre></td></tr></table></figure><p>æˆ‘åŸæœ¬ä»¥ä¸ºæ˜¯bazelçš„é…ç½®é—®é¢˜ï¼Œç»“æœæˆ‘å‘ç°ç›´æ¥mavenä¹Ÿè·‘ä¸èµ·æ¥ã€‚ã€‚ã€‚</p><p>æˆ‘æƒ³äº†æƒ³äº†åº”è¯¥æ˜¯springfoxæ²¡æœ‰å»é€‚é…spring boot3çš„é—®é¢˜ï¼Œä¸æƒ³é™çº§spring bootçš„ç‰ˆæœ¬è¯ï¼Œåªèƒ½<a href="https://www.cnblogs.com/xiao2/p/15621730.html">ä»springfoxè¿ç§»åˆ°springdoc</a></p><h1 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h1><p>æœ¬æ–‡ä½¿ç”¨çš„æºä»£ç éƒ½å¯ä»¥åœ¨<a href="https://github.com/damingerdai/jobs">jobs</a>çœ‹åˆ°ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://bazel.google.cn/about">bazelç®€ä»‹</a></li><li><a href="https://github.com/salesforce/rules_spring/issues/177">Add support for new Boot Loader in Spring Boot 3.2.0</a></li><li><a href="https://showme.codes/zh-cn/2024-01-19-bazel-springboot/#%e5%88%9b%e5%bb%bamaven%e5%b7%a5%e7%a8%8b%e7%bb%93%e6%9e%84">Bazelä½¿ç”¨æ¡ˆä¾‹ï¼šæ„å»ºSpringbootå·¥ç¨‹</a></li><li><a href="https://zhuanlan.zhihu.com/p/372134347">åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›® (ä¸Š)</a></li><li><a href="https://github.com/apache/shiro/issues/891">spring boot 3.0+</a></li><li><a href="https://www.cnblogs.com/xiao2/p/15621730.html">ä»springfoxè¿ç§»åˆ°springdoc</a></li><li><a href="https://junctionbox.ca/2020/06/19/bazel-java-starter.html">New Java Project With Bazel</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> spring boot </tag>
            
            <tag> java </tag>
            
            <tag> bazel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Podmançš„hello worldå…¥é—¨</title>
      <link href="/2024/01/21/software/podman-hello-world/"/>
      <url>/2024/01/21/software/podman-hello-world/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><a href="https://podman.io/">Podnam</a>æ˜¯ä¸€ä¸ªç¬¦åˆOCIï¼Œç”¨äºåœ¨ LinuxÂ® ç³»ç»Ÿä¸Šå¼€å‘ã€æä¾›äº†ä¸ Docker ç­‰ç±»ä¼¼çš„åŠŸèƒ½æ¥ç®¡ç†å®¹å™¨ã€‚ç®¡ç†å’Œè¿è¡Œå®¹å™¨å¼€æºå·¥å…·ã€‚ Podman æœ€åˆç”± Red HatÂ® å·¥ç¨‹å¸ˆä¸å¼€æºç¤¾åŒºä¸€èµ·å¼€å‘ã€‚Podmanä½¿ç”¨ libpod åº“ç®¡ç†æ•´ä¸ªå®¹å™¨ç”Ÿæ€ç³»ç»Ÿã€‚</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>å¦‚æœä½ ä½¿ç”¨Macos, å¯ä»¥ä½¿ç”¨homebrewå®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install podman</span><br></pre></td></tr></table></figure><p>å®‰è£…ä¹‹åå°±å¯ä»¥åˆ›å»ºå’Œå¯åŠ¨Podnamè™šæ‹Ÿæœºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">podman machine init</span><br><span class="line">podman machine start</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨Debian æˆ–è€… ubuntuï¼Œ å¯ä»¥ä½¿ç”¨apt-getå‘½ä»¤å®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install runc -y</span><br><span class="line">sudo apt-get -y install podman</span><br></pre></td></tr></table></figure><p>Â å…¶ä»–ç³»ç»Ÿå¯èƒ½å‚è€ƒ<a href="https://podman.io/docs/installation">podmanå®‰è£…é¡µé¢</a></p><blockquote><p>æ³¨æ„ï¼šå¯¹äº Windows å’Œ Macï¼Œpodman éœ€è¦ä¸€ä¸ªè™šæ‹Ÿæœºæ¥éƒ¨ç½²å®¹å™¨ã€‚</p></blockquote><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒPodman é…ç½®æœ‰ä¸¤ä¸ªå®¹å™¨æ³¨å†Œè¡¨ã€‚</p><ul><li><a href="https://quay.io/">quay.io</a></li><li><a href="https://hub.docker.com/">docker.io</a></li></ul><p>æˆ‘ä»¬å¯ä»¥åœ¨Â·&#x2F;etc&#x2F;containers&#x2F;registries.confÂ·çœ‹åˆ°</p><p>ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬æ„å»ºåŸºäºDockerfileçš„æ™¯è±¡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ²¡æœ‰æ˜ç¡®å®¹å™¨æ³¨å†Œè¡¨çš„æ—¶å€™é»˜è®¤æ‹‰å–docer.ioçš„æ³¨å†Œè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Â·&#x2F;etc&#x2F;containers&#x2F;registries.confÂ·æˆ–è€…Â·$HOME&#x2F;.config&#x2F;containers&#x2F;registries.confÂ·è®¾ç½®unqualified-search-registries</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unqualified-search-registries = [<span class="string">&quot;docker.io&quot;</span>]</span><br></pre></td></tr></table></figure><h1 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h1><p>æ¯ä¸ªç³»ç»Ÿç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„å®¹å™¨å­˜å‚¨åœ°å€ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‚¨å°è¯•ä»ä¸åŒçš„ç”¨æˆ·ç™»å½•ä¸­æå–é•œåƒï¼Œå®ƒå°†ä»è¿œç¨‹æ³¨å†Œè¡¨è€Œä¸æ˜¯æœ¬åœ°æ˜ åƒä¸­æå–é•œåƒã€‚</p><h1 id="å®¹å™¨ç®¡ç†"><a href="#å®¹å™¨ç®¡ç†" class="headerlink" title="å®¹å™¨ç®¡ç†"></a>å®¹å™¨ç®¡ç†</h1><p>æ‹‰å–å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">podman pull docker.io/nginx</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">podman  run --name docker-nginx -p 8080:80 docker.io/nginx</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ç»‘å®š1024ä¸€ä¸‹çš„ç«¯å£ï¼Œä½ éœ€è¦ä½¿ç”¨rootæƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo podman run --name docker-nginx -p 80:80 docker.io/nginx</span><br></pre></td></tr></table></figure><p>å¯¹äºrootç”¨æˆ·ï¼Œå®¹å™¨å°†ä¼šå­˜å‚¨åœ¨Â·&#x2F;var&#x2F;lib&#x2F;containers&#x2F;storagÂ·çš„æ–‡ä»¶å¤¹ä¸­ã€‚<br>å¯¹äºérootç”¨æˆ·ï¼Œå®¹å™¨å°†ä¼šå­˜å‚¨åœ¨Â·$HOME&#x2F;.local&#x2F;share&#x2F;containers&#x2F;storageÂ·çš„æ–‡ä»¶å¤¹ä¸­ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://www.redhat.com/en/topics/containers/what-is-podman">What is Podman?</a></li><li><a href="https://zhuanlan.zhihu.com/p/582580502">Podman åˆå­¦è€…æŒ‡å—ï¼ˆä¸Šï¼‰</a></li><li><a href="https://github.com/containers/podman/issues/16096">Podman â€œError: no registries found in registries.conf, a registry must be providedâ€ while logging&#x2F;pulling from docker.io</a></li><li><a href="https://devopscube.com/podman-tutorial-beginners/">What is Podman?</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> podman </tag>
            
            <tag> å®¹å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023å¹´åº¦æ€»ç»“</title>
      <link href="/2024/01/06/summary/2023/"/>
      <url>/2024/01/06/summary/2023/</url>
      
        <content type="html"><![CDATA[<h1 id="2023å¹´åº¦æ€»ç»“"><a href="#2023å¹´åº¦æ€»ç»“" class="headerlink" title="2023å¹´åº¦æ€»ç»“"></a>2023å¹´åº¦æ€»ç»“</h1><p>2023å¹´å°±è¿™æ ·å­è«åå…¶å¦™çš„è¿‡äº†ï¼Œåˆæ˜¯ç¨€é‡Œç³Šæ¶‚çš„ä¸€å¹´ã€‚è¿™ä¸€å¹´ï¼Œå’Œæœ€çˆ±çš„äººå»äº†ä¸€è¶Ÿè¥¿è—ï¼Œåœ†äº†å¥¹å¿ƒå¿ƒå¿µå¿µçš„æ¢¦æƒ³ï¼›è¿™ä¸€å¹´ï¼Œåäº†30å¤šå°æ—¶çš„ç«è½¦ï¼Œè·¨è¶Šåƒé‡Œå»è§è¯ä¸€æ®µç¾å¥½çš„çˆ±æƒ…ï¼›è¿™ä¸€å¹´ï¼Œå‚åŠ äº†åŠ å…¥PWCä»¥æ¥ç¬¬äºŒæ¬¡çš„çº¿ä¸‹å¹´ä¼šï¼Œç–«æƒ…æ€»ç®—æ˜¯è¿‡å»äº†ã€‚</p><h1 id="ç¾å¥½çš„è¥¿è—"><a href="#ç¾å¥½çš„è¥¿è—" class="headerlink" title="ç¾å¥½çš„è¥¿è—"></a>ç¾å¥½çš„è¥¿è—</h1><p>å…¶å®æ˜¯å…ˆä»ä¸Šæµ·åˆ°æˆéƒ½å‡ºå‘ï¼Œåœ¨æˆéƒ½å¸¦äº†ä¸¤å¤©ï¼Œé™ªå¥¹é‚£åªå«åšèŠ±èŠ±çš„å¤§ç†ŠçŒ«ã€‚ å…¶å®19å¹´æ—¶å€™æˆ‘å»è¿‡æˆéƒ½å¤§ç†Šè²“ç¹è‚²ç ”ç©¶åŸºåœ°ï¼Œé‚£ä¸ªæ—¶å€™è¿˜æ²¡æœ‰èŠ±èŠ±ï¼Œä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçš„æ¸¸å®¢ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘å»çš„æ˜¯æ·¡å­£ï¼Œä¸è¿‡æ€»ç®—æ˜¯æ»¡è¶³å¥¹çš„å¿ƒæ„¿äº†ã€‚åƒäº†å½“åœ°çš„ç‰¹è‰²ï¼Œä¸‰å¤§ç‚®ï¼Œé¸¡è±†èŠ±ï¼Œå…”è…¿ï¼Œéº»å©†è±†è…ï¼Œå…¶å®é‚£ä¸ªé™ˆéº»å©†çš„é‚£ä¸ªå¤«å¦»è‚ºç‰‡è¿˜æ˜¯å¾ˆæœ‰ç‰¹è‰²çš„ï¼Œä¸è¾£ï¼Œæœ‰ç‚¹ç”œï¼Œå’Œç´«ç‡•ç™¾å‘³é¸¡çš„é‚£ä¸ªå‹æ ¹å°±ä¸ä¸€æ ·çš„ã€‚</p><p>æˆ‘ä»¬æ˜¯æŠ¥äº†ä¸€ä¸ªæ—…è¡Œå›¢ï¼Œå››ä¸ªäººï¼Œä¸€ä¸ªå¸æœºã€‚é™¤äº†æˆ‘ä»¬ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå±±ä¸œå°å“¥ï¼Œä¸€ä¸ªå››å·å°ä¼™ã€‚å±±ä¸œå°å“¥æ˜¯çœŸçš„å¾ˆç¤¾ç‰›ï¼Œå’Œä»€ä¹ˆäººéƒ½èƒ½èŠèµ·æ¥ï¼Œå–œæ¬¢æ—…æ¸¸ï¼Œæœ‹å‹åœˆä¸‰å¤©ä¸¤å¤´å‡ºå»ç©ï¼Œæ™’å„åœ°çš„ç¾æ™¯ã€‚å››å·å°ä¼™æ˜¯æ‹¿åˆ°ç¾å›½ä¸€å®¶åšå£«çš„offeräº†ï¼Œæƒ³åœ¨å‡ºå›½å‰èƒ½å¤Ÿå¥½å¥½æ”¾æ¾ä¸€ä¸‹ã€‚å››ä¸ªäººä¸€ä¸ªå¸æœºï¼Œå°±è¿™æ ·å­ä»æˆéƒ½æ²¿ç€318å›½é“å‡ºå‘äº†ã€‚</p><p>å»äº†å¾ˆå¤šåœ°æ–¹ï¼Œä½†æ˜¯æˆ‘æ²¡è®°ä½ï¼Œå› ä¸ºè¿™ä¸æ˜¯æˆ‘çƒ­çˆ±çš„ï¼Œåƒäº†å¾ˆå¤šç¾é£Ÿï¼Œæˆ‘è®°ä½äº†å®ƒä»¬çš„å‘³é“ï¼Œæ°¸è¿œä¸ä¼šå¿˜è®°ã€‚</p><p>åˆ°äº†æ‹‰è¨ï¼Œæˆ‘ä»¬å»çœ‹äº†å°æ˜­å¯ºï¼Œå¸ƒè¾¾æ‹‰å®«ã€‚åƒäº†å½“åœ°ç‰¦ç‰›è‚‰ï¼Œå–äº†å½“åœ°çš„ç‰¦ç‰›å¥¶åšçš„å¥¶èŒ¶ã€‚çœŸçš„æ˜¯ç¾æ»‹æ»‹çš„æ—¥å­å•Šã€‚</p><video src="/video/2023/panda.mp4" type="video/mp4" controls="controls" width="100%" height="100%"></video><p><img src="/images/2023/panda.jpg" alt="å¤§ç†ŠçŒ«"><br><img src="/images/2023/DSC05017_1.JPG" alt="æˆ‘å’Œå¥¹"><br><img src="/images/2023/mmexport1682507532968.jpg" alt="å¸ƒè¾¾æ‹‰å®«"></p><h1 id="PWCçº¿ä¸‹å¹´ä¼š"><a href="#PWCçº¿ä¸‹å¹´ä¼š" class="headerlink" title="PWCçº¿ä¸‹å¹´ä¼š"></a>PWCçº¿ä¸‹å¹´ä¼š</h1><p>æˆ‘æ˜¯19å¹´åŠ å…¥PWCçš„ã€‚PWCçš„å¹´ä¼šå…¶å®æ˜¯è´¢å¹´çš„æ„æ€ï¼Œæ‰€ä»¥é€šå¸¸æ˜¯5æœˆä»½åŠå¹´ä¼šã€‚20å¹´æ”¶åˆ°ç–«æƒ…çš„å½±å“ï¼Œæ­¤åçš„å¹´ä¼šéƒ½æ˜¯çº¿ä¸Šä¸¾è¡Œçš„ï¼Œè™½ç„¶æœ‰å…ƒå®‡å®™çš„ç­‰åŠ æŒï¼Œä½†æ˜¯å¯¹æˆ‘æ¥è€Œå·²å…¶å®å¹¶æ²¡æœ‰å‚ä¸æ„Ÿçš„ã€‚æ”¶åˆ°ç–«æƒ…çš„å½±å“ï¼Œå¾ˆå¤šåŒäº‹å·²ç»æ²¡æœ‰æ¥å…¬å¸é¢å¯¹é¢åŠå…¬äº†ï¼Œæ›¾ç»çš„å›¢é˜Ÿæ—©å°±å„å¥”ä¸œè¥¿ï¼Œç”šè‡³éƒ½ä¸åœ¨ä¸€ä¸ªéƒ¨é—¨çš„äº†ã€‚</p><p>ç»ˆäºï¼Œå£ç½©æ²¡äº†ï¼Œåœ¨åŠ å…¥PWCçš„ç¬¬å››å¹´ä¸­ï¼Œè¿æ¥çš„ç¬¬äºŒæ¬¡çº¿ä¸‹å¹´ä¼šã€‚é…’åº—æ›´é«˜çº§äº†ï¼Œåƒçš„å¾ˆå¥½ï¼Œé£Ÿç‰©ä¹Ÿç²¾è‡´ï¼Œä½†æ˜¯å‘¢ï¼Œæˆ‘è¿˜æ˜¯æ„Ÿè§‰19å¹´é‚£æ¬¡å¹´ä¼šåƒçš„æ›´æƒ¬æ„ç‚¹ã€‚</p><p><img src="/images/2023/pwc.jpg" alt="pwcå¹´ä¼š"></p><h1 id="å˜‰å³ªå…³ä¹‹è¡Œ"><a href="#å˜‰å³ªå…³ä¹‹è¡Œ" class="headerlink" title="å˜‰å³ªå…³ä¹‹è¡Œ"></a>å˜‰å³ªå…³ä¹‹è¡Œ</h1><p>å˜‰å³ªå…³ä¹‹è¡Œå•çº¯çš„æ˜¯å› ä¸ºå¤§å­¦åŒå­¦ç»“å©šï¼Œä¾¿é€‰æ‹©åäº†30å¤šå°æ—¶çš„ç«è½¦ï¼Œå…ˆå»è¥¿å®‰å’Œå¥½å‹ä¼šå’Œï¼Œå†å»å˜‰å³ªå…³ã€‚å˜‰å³ªå…³é£æ™¯ä¸é”™ï¼Œå¯æƒœå¾ˆéš¾å†æœ‰æœºä¼šå»äº†ã€‚</p><p><img src="/images/2023/jiayuguan.jpg" alt="å˜‰å³ªå…³"></p><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><p>æˆ‘ä»¬è¿˜å»æ¥äº†è¿ªå£«å°¼</p><p><img src="/images/2023/dishini01.jpg" alt="è¿ªå£«å°¼01"><br><img src="/images/2023/dishini02.jpg" alt="è¿ªå£«å°¼02"></p><p>å‚åŠ å¥¹çš„å¤§å­¦åŒå­¦çš„å©šç¤¼</p><p><img src="/images/2023/nanjing-wedding.jpg" alt="å—äº¬å©šç¤¼"></p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>Time files over us, but leaves its shadow behind.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ multipassç¬”è®°</title>
      <link href="/2023/12/14/software/multipass-learning/"/>
      <url>/2023/12/14/software/multipass-learning/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Multipass æ˜¯ä¸€ä¸ªè½»é‡è™šæ‹Ÿæœºç®¡ç†å™¨ï¼Œæ˜¯ç”± Ubuntu è¿è¥å…¬å¸ Canonical æ‰€æ¨å‡ºçš„å¼€æºé¡¹ç›®ã€‚è¿è¡Œç¯å¢ƒæ”¯æŒ Linuxã€Windowsã€macOSã€‚åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œä½¿ç”¨çš„æ˜¯ä¸åŒçš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚åœ¨ Linux ä¸Šä½¿ç”¨çš„æ˜¯ KVMã€Window ä¸Šä½¿ç”¨ Hyper-Vã€macOS ä¸­ä½¿ç”¨ HyperKit ä»¥æœ€å°å¼€é”€è¿è¡Œ VMï¼Œæ”¯æŒåœ¨ç¬”è®°æœ¬æ¨¡æ‹Ÿå°å‹äº‘ã€‚</p><p>åŒæ—¶ï¼ŒMultipass æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢æ¥å¯åŠ¨å’Œç®¡ç† Linux å®ä¾‹ã€‚ä¸‹è½½ä¸€ä¸ªå…¨æ–°çš„é•œåƒéœ€è¦å‡ ç§’é’Ÿçš„æ—¶é—´ï¼Œå¹¶ä¸”åœ¨å‡ åˆ†é’Ÿå†…å°±å¯ä»¥å¯åŠ¨å¹¶è¿è¡Œ VMã€‚</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>åœ¨windowç¯å¢ƒä¸‹è¿›è¡Œéƒ¨ç½²ï¼Œä¸‹è½½æœ€æ–°å®‰è£…åŒ…ï¼š<a href="https://github.com/canonical/multipass/releases/">https://github.com/canonical/multipass/releases/</a></p><h1 id="åˆ›å»ºvm"><a href="#åˆ›å»ºvm" class="headerlink" title="åˆ›å»ºvm"></a>åˆ›å»ºvm</h1><p>åˆ›å»ºå®ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">multipass launch -n k3s-master -c 2 -m 4G -d 10G</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å®ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">multipass list</span><br><span class="line"></span><br><span class="line">Name                    State             IPv4             Image</span><br><span class="line">k3s-master              Running           172.19.151.166   Ubuntu 22.04 LTS</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å®ä¾‹çŠ¶æ€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Name:           k3s-master</span><br><span class="line">State:          Running</span><br><span class="line">IPv4:           172.19.151.166</span><br><span class="line">Release:        Ubuntu 22.04.3 LTS</span><br><span class="line">Image hash:     6d6af17f28c8 (Ubuntu 22.04 LTS)</span><br><span class="line">CPU(s):         2</span><br><span class="line">Load:           0.00 0.00 0.00</span><br><span class="line">Disk usage:     1.6GiB out of 9.6GiB</span><br><span class="line">Memory usage:   213.8MiB out of 3.8GiB</span><br><span class="line">Mounts:         --</span><br></pre></td></tr></table></figure><p>è¿›å…¥shellç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">multipass shell k3s-maste</span><br><span class="line"></span><br><span class="line">Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-91-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Thu Dec 14 20:45:28 CST 2023</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Processes:             100</span><br><span class="line">  Usage of /:   17.2% of 9.51GB   Users logged <span class="keyword">in</span>:       1</span><br><span class="line">  Memory usage: 6%                IPv4 address <span class="keyword">for</span> eth0: 172.19.151.166</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line"> * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s</span><br><span class="line">   just raised the bar <span class="keyword">for</span> easy, resilient and secure K8s cluster deployment.</span><br><span class="line"></span><br><span class="line">   https://ubuntu.com/engage/secure-kubernetes-at-the-edge</span><br><span class="line"></span><br><span class="line">Expanded Security Maintenance <span class="keyword">for</span> Applications is not enabled.</span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line">Enable ESM Apps to receive additional future security updates.</span><br><span class="line">See https://ubuntu.com/esm or run: sudo pro status</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Thu Dec 14 20:26:30 2023 from 172.19.144.1</span><br><span class="line">To run a <span class="built_in">command</span> as administrator (user <span class="string">&quot;root&quot;</span>), use <span class="string">&quot;sudo &lt;command&gt;&quot;</span>.</span><br><span class="line">See <span class="string">&quot;man sudo_root&quot;</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure><h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h1><ol><li><a href="https://www.mobaijun.com/posts/3701652676.html">ã€å·¥å…·ç³»åˆ—ã€‘è½»é‡çº§è™šæ‹Ÿæœº Multipass ä½¿ç”¨æ•™ç¨‹</a></li><li><a href="https://www.cnblogs.com/hewei-blogs/articles/17569105.html">è½»é‡è™šæ‹Ÿæœº Multipass çš„éƒ¨ç½²å’Œä½¿ç”¨</a></li><li><a href="https://jackkuo.org/post/multipass_tutorial/">Multipass - å¦‚ Docker èˆ¬çš„è™›æ“¬æ©Ÿ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> multipass </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HorizontalPodAutoscalerå…¥é—¨å®è·µ</title>
      <link href="/2023/09/27/software/k8s/horizontal-pod-autoscaler-getting-started/"/>
      <url>/2023/09/27/software/k8s/horizontal-pod-autoscaler-getting-started/</url>
      
        <content type="html"><![CDATA[<h1 id="HorizontalPodAutoscaler"><a href="#HorizontalPodAutoscaler" class="headerlink" title="HorizontalPodAutoscaler"></a>HorizontalPodAutoscaler</h1><p>åœ¨Kubernetesä¸­ï¼ŒHorizontalPodAutoscaler è‡ªåŠ¨æ›´æ–°å·¥ä½œè´Ÿè½½èµ„æºï¼ˆä¾‹å¦‚Deploymentæˆ–è€…StatefulSetï¼‰ï¼Œç›®çš„æ˜¯è‡ªåŠ¨æ‰©ç¼©å·¥ä½œè´Ÿè½½ä»¥æ»¡è¶³éœ€æ±‚ã€‚æ°´å¹³æ‰©ç¼©æ„å‘³ç€å¯¹å¢åŠ çš„è´Ÿè½½çš„å“åº”æ˜¯éƒ¨ç½²æ›´å¤šçš„ Podã€‚</p><p>æœ¬æ–‡ç›®çš„æ˜¯é€šè¿‡Docker Desktopä¸Šçš„Kuberneteså®ä¾‹å»å®è·µpodçš„æ°´å¹³æ‰©å±•ã€‚</p><p>æœ¬æ–‡é»˜è®¤Docker Desktopä¸Šçš„Kuberneteså·²ç»å®‰è£…å®Œæˆã€‚å¦‚æœéœ€è¦å¸®åŠ©ï¼Œå¯ä»¥é˜…è¯»<a href="https://damingerdai.github.io/2021/01/14/software/k8s/how-to-install-docker-desktop-k8s/">Docker Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°</a>ã€‚</p><h1 id="å®‰è£…-Metrics-server"><a href="#å®‰è£…-Metrics-server" class="headerlink" title="å®‰è£… Metrics server"></a>å®‰è£… Metrics server</h1><p>ç”±äºDocker Desktopä¸Šçš„Kubernetesé»˜è®¤å¹¶æ²¡æœ‰å®‰è£…Metrics serverï¼Œè€ŒHorizontalPodAutoscalerä¾èµ–é€šè¿‡Metrics serverè·å–åˆ°çš„æ•°æ®ï¼Œ å› æ­¤éœ€è¦æå‰å®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl top node </span><br><span class="line">error: Metrics API not available</span><br></pre></td></tr></table></figure><p>ä»<a href="https://github.com/kubernetes-sigs/metrics-server/releases">Metrics serverçš„releaseé¡µé¢</a>è·å–æœ€æ–°çš„<code>components.yaml</code>æ–‡ä»¶ï¼Œ</p><p>ç„¶åæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f components.yaml</span><br></pre></td></tr></table></figure><p>é•œåƒçš„æ‹‰å–å’Œè¿è¡Œéœ€è¦ä¸€ç‚¹æ—¶é—´ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹è¿è¡Œæƒ…å†µï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl  get pod -n kube-system | grep metrics</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœ</span></span><br><span class="line">metrics-server-75f45b4dd4-fbxd2          1/1     Running   0               3h25m</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹nodeèµ„æºæƒ…å†µï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubectl top node</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœ</span></span><br><span class="line">NAME             CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   </span><br><span class="line">docker-desktop   1901m        47%    6250Mi          80% </span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹podèµ„æºæƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kubectl top pods -A</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœ</span></span><br><span class="line">NAMESPACE           NAME                                     CPU(cores)   MEMORY(bytes)             </span><br><span class="line">kube-system         coredns-5d78c9869d-dq2s7                 4m           16Mi            </span><br><span class="line">kube-system         coredns-5d78c9869d-g5xhx                 2m           21Mi            </span><br><span class="line">kube-system         etcd-docker-desktop                      20m          72Mi            </span><br><span class="line">kube-system         kube-apiserver-docker-desktop            32m          271Mi           </span><br><span class="line">kube-system         kube-controller-manager-docker-desktop   11m          64Mi            </span><br><span class="line">kube-system         kube-proxy-qdc55                         1m           25Mi            </span><br><span class="line">kube-system         kube-scheduler-docker-desktop            5m           32Mi            </span><br><span class="line">kube-system         metrics-server-75f45b4dd4-fbxd2          6m           23Mi            </span><br><span class="line">kube-system         storage-provisioner                      4m           15Mi            </span><br><span class="line">kube-system         vpnkit-controller                        1m           14Mi  </span><br></pre></td></tr></table></figure><h1 id="é…ç½®HorizontalPodAutoscaler"><a href="#é…ç½®HorizontalPodAutoscaler" class="headerlink" title="é…ç½®HorizontalPodAutoscaler"></a>é…ç½®HorizontalPodAutoscaler</h1><p>è¿™é‡Œä»¥æˆ‘çš„ä¸ªäººå¼€æºé¡¹ç›®<a href="https://github.com/damingerdai/hoteler">hoteler</a>ä¸ºä¾‹, å°†ä¸‹é¢çš„å†…å®¹å†™å…¥<code>hpa.yaml</code>æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">autoscaling/v2</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">HorizontalPodAutoscaler</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hoteler-api-hpa</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">hoteler-namespace</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">hoteler-api-hpa</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">maxReplicas:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">minReplicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">scaleTargetRef:</span></span><br><span class="line">    <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hoteler-api</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Resource</span></span><br><span class="line">      <span class="attr">resource:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">cpu</span></span><br><span class="line">        <span class="attr">target:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">Utilization</span></span><br><span class="line">          <span class="attr">averageUtilization:</span> <span class="number">50</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Resource</span></span><br><span class="line">      <span class="attr">resource:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">memory</span></span><br><span class="line">        <span class="attr">target:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">Utilization</span></span><br><span class="line">          <span class="attr">averageUtilization:</span> <span class="number">50</span></span><br></pre></td></tr></table></figure><p><code>minReplicas: 1</code>è¡¨ç¤ºæœ€å°ä¸€ä¸ªpodå®ä¾‹ï¼Œ<code>maxReplicas: 5</code>åˆ™è¯´æ˜æœ€å¤šæ‰©å±•åˆ°5ä¸ªpodå®ä¾‹ã€‚</p><p><code>metrics</code>ä¸‹é¢å®šä¹‰ä¸¤ä¸ªÂ·ResourceÂ·ï¼Œ ç¬¬ä¸€ä¸ªResourceè§„å®šå½“cpuèµ„æºå ç”¨ç‡è¶…è¿‡50%å°±ä¼šè¿›è¡Œæ‰©å®¹ï¼Œç¬¬äºŒä¸ªResourceåˆ™è§„å®šäº†å½“å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡50%ä¹‹åæ‰ä¼šè¡Œå°†æ‰©å®¹ã€‚ è¿™ä¸¤ä¸ªResourceæ˜¯ç‹¬ç«‹è®¡ç®—æ‰€éœ€è¦çš„å‰¯æœ¬æ•°é‡ï¼Œå–æœ€å¤§å€¼ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol><li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscaling</a></li><li><a href="https://srerun.com/article/2021/5/6/39.html">k8sçš„HPAå®‰è£…æµ‹è¯•</a></li><li><a href="https://juejin.cn/post/7104907264779583501">å®‰è£… Metrics server</a></li><li><a href="https://dev.to/docker/enable-kubernetes-metrics-server-on-docker-desktop-5434">Enable Kubernetes Metrics Server on Docker Desktop</a></li><li><a href="https://www.qikqiak.com/post/k8s-hpa-usage/">Kubernetes HPA ä½¿ç”¨è¯¦è§£</a></li><li><a href="https://stackoverflow.com/questions/54302592/how-kubernetes-hpa-with-2-or-more-metrics-behaves-especially-the-no-of-replica">How kubernetes HPA with 2 or more metrics behaves - especially the no.of replicas calculation?</a></li><li><a href="https://github.com/damingerdai/hoteler/pull/749">feat: ä½¿ç”¨k8sçš„HorizontalPodAutoscalerè¿›è¡Œæ°´å¹³çš„èµ„æºç¼©æ”¾</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> docker </tag>
            
            <tag> Docker Desktop </tag>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨bazelå»æ„å»ºåŸºäºexpresså’Œtypescriptçš„nodejsé¡¹ç›®</title>
      <link href="/2023/08/10/front-end/how-to-use-bazel-to-build-nodejs-typescript-expressjs/"/>
      <url>/2023/08/10/front-end/how-to-use-bazel-to-build-nodejs-typescript-expressjs/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Bazel æ˜¯ä¸€æ¬¾ç±»ä¼¼äº Makeã€Maven å’Œ Gradleçš„å¼€æºæ„å»ºå’Œæµ‹è¯•å·¥å…·ã€‚å®ƒä½¿ç”¨å¯è¯»çš„é«˜çº§æ„å»ºè¯­è¨€ï¼Œæ”¯æŒå¤šç§å˜æˆè¯­è¨€ç¼–å†™çš„é¡¹ç›®ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¸ºå¤šä¸ªå¹³å°è¿›è¡Œæ„å»ºã€‚Bazel æ”¯æŒæ„å»ºåŒ…å«å¤šä¸ªä»“åº“ã€å¤§é‡å¼€å‘äººå‘˜çš„å¤§å‹ä»£ç åº“ã€‚</p><p>è¯¦ç»†ä»‹ç»å¯è§<a href="https://bazel.build/">Bazelå®˜ç½‘</a>ã€‚</p><h2 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><p>æœ¬æ–‡çš„ç›®çš„æ˜¯ä½¿ç”¨bazel5å»æ„å»ºä¸€ä¸ªå®Œæ•´çš„nodejsåç«¯é¡¹ç›®ï¼Œå¹¶ä¸è´Ÿè´£bazelç›¸å…³çŸ¥è¯†çš„ä»‹ç»ã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é¦–å…ˆåœ¨<code>package.json</code>æ–‡ä»¶ä¸­Â·devDependenciesÂ·éƒ¨åˆ†æ·»åŠ ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;@bazel/bazelisk&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.7.5&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;@bazel/buildifier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;@bazel/ibazel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.16.0&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;@bazel/typescript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.8.1&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†æ‰§è¡Œå®‰è£…ä¾èµ–å‘½ä»¤ã€‚</p><p>åˆ›å»º<code>.bazelignore</code>æ–‡ä»¶å¹¶å†™å…¥ä¸‹é¢çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.git</span><br><span class="line">node_modules</span><br><span class="line">dist</span><br></pre></td></tr></table></figure><p>åˆ›å»º<code>.bazelrc</code>æ–‡ä»¶å¹¶å†™å…¥ä¸‹é¢çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"># Enable debugging tests with --config=debug</span><br><span class="line">test:debug --test_arg=--node_options=--inspect-brk --test_output=streamed --test_strategy=exclusive --test_timeout=9999 --nocache_test_results</span><br><span class="line"></span><br><span class="line"># Do not attempt to de-flake locally.</span><br><span class="line"># On CI we might set this to `3` to run with deflaking.</span><br><span class="line">test --flaky_test_attempts=1</span><br><span class="line"></span><br><span class="line">###############################</span><br><span class="line"># Filesystem interactions     #</span><br><span class="line">###############################</span><br><span class="line"></span><br><span class="line"># Create symlinks in the project:</span><br><span class="line"># - dist/bin for outputs</span><br><span class="line"># - dist/testlogs, dist/genfiles</span><br><span class="line"># - bazel-out</span><br><span class="line"># NB: bazel-out should be excluded from the editor configuration.</span><br><span class="line"># The checked-in /.vscode/settings.json does this for VSCode.</span><br><span class="line"># Other editors may require manual config to ignore this directory.</span><br><span class="line"># In the past, we say a problem where VSCode traversed a massive tree, opening file handles and</span><br><span class="line"># eventually a surprising failure with auto-discovery of the C++ toolchain in</span><br><span class="line"># MacOS High Sierra.</span><br><span class="line"># See https://github.com/bazelbuild/bazel/issues/4603</span><br><span class="line">build --symlink_prefix=dist/</span><br><span class="line"></span><br><span class="line"># Turn off legacy external runfiles</span><br><span class="line">build --nolegacy_external_runfiles</span><br><span class="line">run --nolegacy_external_runfiles</span><br><span class="line">test --nolegacy_external_runfiles</span><br><span class="line"></span><br><span class="line"># Turn on --incompatible_strict_action_env which was on by default</span><br><span class="line"># in Bazel 0.21.0 but turned off again in 0.22.0. Follow</span><br><span class="line"># https://github.com/bazelbuild/bazel/issues/7026 for more details.</span><br><span class="line"># This flag is needed to so that the bazel cache is not invalidated</span><br><span class="line"># when running bazel via `yarn bazel`.</span><br><span class="line"># See https://github.com/angular/angular/issues/27514.</span><br><span class="line">build --incompatible_strict_action_env</span><br><span class="line">run --incompatible_strict_action_env</span><br><span class="line">test --incompatible_strict_action_env</span><br><span class="line"></span><br><span class="line"># Do not build runfile trees by default. If an execution strategy relies on runfile</span><br><span class="line"># symlink teee, the tree is created on-demand. See: https://github.com/bazelbuild/bazel/issues/6627</span><br><span class="line"># and https://github.com/bazelbuild/bazel/commit/03246077f948f2790a83520e7dccc2625650e6df</span><br><span class="line">build --nobuild_runfile_links</span><br><span class="line"></span><br><span class="line">build --enable_runfiles</span><br><span class="line"></span><br><span class="line">###############################</span><br><span class="line"># Release support             #</span><br><span class="line"># Turn on these settings with #</span><br><span class="line">#  --config=release           #</span><br><span class="line">###############################</span><br><span class="line"></span><br><span class="line"># Releases should always be stamped with version control info</span><br><span class="line"># This command assumes node on the path and is a workaround for</span><br><span class="line"># https://github.com/bazelbuild/bazel/issues/4802</span><br><span class="line">build:release --workspace_status_command=&quot;yarn -s ng-dev release build-env-stamp --mode=release&quot;</span><br><span class="line">build:release --stamp</span><br><span class="line"></span><br><span class="line"># Building AIO against local Angular deps requires stamping</span><br><span class="line"># versions in Angular packages due to CLI version checks.</span><br><span class="line">build:aio_local_deps --stamp</span><br><span class="line">build:aio_local_deps --workspace_status_command=&quot;yarn -s --cwd aio local-workspace-status&quot;</span><br><span class="line"></span><br><span class="line"># Snapshots should also be stamped with version control information.</span><br><span class="line">build:snapshot-build --workspace_status_command=&quot;yarn -s ng-dev release build-env-stamp --mode=snapshot&quot;</span><br><span class="line">build:snapshot-build --stamp</span><br><span class="line"></span><br><span class="line">##########################################################</span><br><span class="line"># AIO architect build configuration                      #</span><br><span class="line"># See aio/angular.json for available configurations.     #</span><br><span class="line"># To build with a partiular configuration:               #</span><br><span class="line">#   bazel build //aio:build --aio_build_config=&lt;config&gt;  #</span><br><span class="line"># Default config is `stable``.                           #</span><br><span class="line">##########################################################</span><br><span class="line">build --flag_alias=aio_build_config=//aio:flag_aio_build_config</span><br><span class="line"></span><br><span class="line">####################################</span><br><span class="line"># AIO first party dep substitution #</span><br><span class="line"># Turn on with                     #</span><br><span class="line">#  --config=aio_local_deps         #</span><br><span class="line">####################################</span><br><span class="line"></span><br><span class="line">build:aio_local_deps --//aio:flag_aio_local_deps</span><br><span class="line"></span><br><span class="line">###############################</span><br><span class="line"># Output                      #</span><br><span class="line">###############################</span><br><span class="line"></span><br><span class="line"># A more useful default output mode for bazel query</span><br><span class="line"># Prints eg. &quot;ng_module rule //foo:bar&quot; rather than just &quot;//foo:bar&quot;</span><br><span class="line">query --output=label_kind</span><br><span class="line"></span><br><span class="line"># By default, failing tests don&#x27;t print any output, it goes to the log file</span><br><span class="line">test --test_output=errors</span><br><span class="line"></span><br><span class="line">################################</span><br><span class="line"># Settings for CircleCI        #</span><br><span class="line">################################</span><br><span class="line"></span><br><span class="line"># Bazel flags for CircleCI are in /.circleci/bazel.linux.rc and /.circleci/bazel.windows.rc</span><br><span class="line"></span><br><span class="line">##################################</span><br><span class="line"># Remote Build Execution support #</span><br><span class="line"># Turn on these settings with    #</span><br><span class="line">#  --config=remote               #</span><br><span class="line">##################################</span><br><span class="line"></span><br><span class="line"># The following --define=EXECUTOR=remote will be able to be removed</span><br><span class="line"># once https://github.com/bazelbuild/bazel/issues/7254 is fixed</span><br><span class="line">build:remote --define=EXECUTOR=remote</span><br><span class="line"></span><br><span class="line"># Set a higher timeout value, just in case.</span><br><span class="line">build:remote --remote_timeout=600</span><br><span class="line"></span><br><span class="line"># Bazel detects maximum number of jobs based on host resources.</span><br><span class="line"># Since we run remotely, we can increase this number significantly.</span><br><span class="line">common:remote --jobs=200</span><br><span class="line"></span><br><span class="line">build:remote --google_default_credentials</span><br><span class="line"></span><br><span class="line"># Limit the number of test jobs for on an AIO local deps build. The example tests running</span><br><span class="line"># concurrently pushes the circleci executor RAM usage to its limits.</span><br><span class="line">test:aio_local_deps --jobs=24</span><br><span class="line"></span><br><span class="line"># Force remote exeuctions to consider the entire run as linux</span><br><span class="line">build:remote --cpu=k8</span><br><span class="line">build:remote --host_cpu=k8</span><br><span class="line"></span><br><span class="line"># Toolchain and platform related flags</span><br><span class="line">build:remote --crosstool_top=@npm//@angular/build-tooling/bazel/remote-execution/cpp:cc_toolchain_suite</span><br><span class="line">build:remote --extra_toolchains=@npm//@angular/build-tooling/bazel/remote-execution/cpp:cc_toolchain</span><br><span class="line">build:remote --extra_execution_platforms=@npm//@angular/build-tooling/bazel/remote-execution:platform</span><br><span class="line">build:remote --host_platform=@npm//@angular/build-tooling/bazel/remote-execution:platform</span><br><span class="line">build:remote --platforms=@npm//@angular/build-tooling/bazel/remote-execution:platform</span><br><span class="line"></span><br><span class="line"># Remote instance and caching</span><br><span class="line">build:remote --remote_instance_name=projects/internal-200822/instances/primary_instance</span><br><span class="line">build:remote --project_id=internal-200822</span><br><span class="line">build:remote --remote_cache=remotebuildexecution.googleapis.com</span><br><span class="line">build:remote --remote_executor=remotebuildexecution.googleapis.com</span><br><span class="line"></span><br><span class="line"># Use HTTP remote cache</span><br><span class="line">build:remote-cache --remote_cache=https://storage.googleapis.com/angular-team-cache</span><br><span class="line">build:remote-cache --remote_accept_cached=true</span><br><span class="line">build:remote-cache --remote_upload_local_results=true</span><br><span class="line">build:remote-cache --google_default_credentials</span><br><span class="line"></span><br><span class="line"># Ensure that tags like &quot;no-remote-exec&quot; get propagated to actions created by rules,</span><br><span class="line"># even if the rule implementation does not explicitly pass them to the execution requirements.</span><br><span class="line"># https://bazel.build/reference/command-line-reference#flag--experimental_allow_tags_propagation</span><br><span class="line">common --experimental_allow_tags_propagation</span><br><span class="line"></span><br><span class="line"># Disable network access in the sandbox by default. To enable network access</span><br><span class="line"># for a particular target, use:</span><br><span class="line">#</span><br><span class="line"># load(&quot;@npm//@angular/build-tooling/bazel/remote-execution:index.bzl&quot;, &quot;ENABLE_NETWORK&quot;)</span><br><span class="line"># my_target(</span><br><span class="line">#   ...,</span><br><span class="line">#   exec_properties = ENABLE_NETWORK,   # Enables network in remote exec</span><br><span class="line">#   tags = [&quot;requires-network&quot;]         # Enables network in sandbox</span><br><span class="line"># )</span><br><span class="line">build --nosandbox_default_allow_network</span><br><span class="line"></span><br><span class="line">##################################</span><br><span class="line"># Saucelabs tests settings       #</span><br><span class="line"># Turn on these settings with    #</span><br><span class="line">#  --config=saucelabs            #</span><br><span class="line">##################################</span><br><span class="line"></span><br><span class="line"># For saucelabs tests we don&#x27;t want to enable flaky test attempts. Karma has its own integrated</span><br><span class="line"># retry mechanism and we do not want to retry unnecessarily if Karma already tried multiple times.</span><br><span class="line">test:saucelabs --flaky_test_attempts=1</span><br><span class="line"></span><br><span class="line">################</span><br><span class="line"># Flag Aliases #</span><br><span class="line">################</span><br><span class="line"></span><br><span class="line"># --ng_perf will ask the Ivy compiler to produce performance results for each build.</span><br><span class="line">build --flag_alias=ng_perf=//packages/compiler-cli:ng_perf</span><br><span class="line"></span><br><span class="line">####################################################</span><br><span class="line"># User bazel configuration</span><br><span class="line"># NOTE: This needs to be the *last* entry in the config.</span><br><span class="line">####################################################</span><br><span class="line"></span><br><span class="line"># Load any settings which are specific to the current user. Needs to be *last* statement</span><br><span class="line"># in this config, as the user configuration should be able to overwrite flags from this file.</span><br><span class="line">try-import %workspace%/.bazelrc.user</span><br></pre></td></tr></table></figure><p>åˆ›å»º<code>.bazelversion</code>ç”¨äºæŒ‡å®šbazelç‰ˆæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5.0.0</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ä½¿ç”¨bazel5çš„ä»»æ„ç‰ˆæœ¬ï¼Œç†è®ºä¸Šéƒ½æ”¯æŒï¼Œä½†æ˜¯ä¸è¦ä½¿ç”¨bazel6çš„ç‰ˆæœ¬</p></blockquote><p>æ–°å»º<code>WORKSPACE</code>ç”¨äºå®šä¹‰bazelçš„å·¥ä½œåŒºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">workspace(</span><br><span class="line">   name = &quot;express-postgres-ts-starter&quot;,</span><br><span class="line">    managed_directories = &#123;</span><br><span class="line">        &quot;@npm&quot;: [&quot;node_modules&quot;],</span><br><span class="line">    &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å¯¼å…¥<code>http_archive</code>ç”¨äºè·å–bazelçš„åº“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;, &quot;http_archive&quot;)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨äº†<code>.yarn</code>æ–‡ä»¶å¤¹ç”¨äºé™åˆ¶yarnçš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡åˆ›å»º<code>yarn.bzl</code>è§£å†³ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">YARN_PATH = &quot;.yarn/releases/yarn-1.22.19.cjs&quot;</span><br><span class="line">YARN_LABEL = &quot;//:&quot; + YARN_PATH</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>WORKSPACE</code>å¯¼å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;//:yarn.bzl&quot;, &quot;YARN_LABEL&quot;)</span><br></pre></td></tr></table></figure><p>å¼•å…¥bazelçš„nodesjä¾èµ–åº“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">http_archive(</span><br><span class="line">    name = &quot;build_bazel_rules_nodejs&quot;,</span><br><span class="line">    sha256 = &quot;5dd1e5dea1322174c57d3ca7b899da381d516220793d0adef3ba03b9d23baa8e&quot;,</span><br><span class="line">    urls = [</span><br><span class="line">        &quot;https://github.com/bazelbuild/rules_nodejs/releases/download/5.8.3/rules_nodejs-5.8.3.tar.gz&quot;,</span><br><span class="line">        &quot;https://ghproxy.com/https://github.com/bazelbuild/rules_nodejs/releases/download/5.8.3/rules_nodejs-5.8.3.tar.gz&quot;</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">load(&quot;@build_bazel_rules_nodejs//:repositories.bzl&quot;, &quot;build_bazel_rules_nodejs_dependencies&quot;)</span><br><span class="line"></span><br><span class="line">build_bazel_rules_nodejs_dependencies()</span><br><span class="line"></span><br><span class="line">http_archive(</span><br><span class="line">    name = &quot;rules_pkg&quot;,</span><br><span class="line">    sha256 = &quot;62eeb544ff1ef41d786e329e1536c1d541bb9bcad27ae984d57f18f314018e66&quot;,</span><br><span class="line">    urls = [</span><br><span class="line">        &quot;https://mirror.bazel.build/github.com/bazelbuild/rules_pkg/releases/download/0.6.0/rules_pkg-0.6.0.tar.gz&quot;,</span><br><span class="line">        &quot;https://github.com/bazelbuild/rules_pkg/releases/download/0.6.0/rules_pkg-0.6.0.tar.gz&quot;,</span><br><span class="line">        &quot;https://ghproxy.com/https://github.com/bazelbuild/rules_pkg/releases/download/0.6.0/rules_pkg-0.6.0.tar.gz&quot;,</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># Fetch Aspect lib for utilities like write_source_files</span><br><span class="line"># NOTE: We cannot move past version 1.23.2 of aspect_bazel_lib because it requires us to move to bazel 6.0.0 which</span><br><span class="line">#       breaks our usage of managed_directories</span><br><span class="line">http_archive(</span><br><span class="line">    name = &quot;aspect_bazel_lib&quot;,</span><br><span class="line">    sha256 = &quot;4b2e774387bae6242879820086b7b738d49bf3d0659522ea5d9363be01a27582&quot;,</span><br><span class="line">    strip_prefix = &quot;bazel-lib-1.23.2&quot;,</span><br><span class="line">    urls = [</span><br><span class="line">        &quot;https://github.com/aspect-build/bazel-lib/archive/refs/tags/v1.23.2.tar.gz&quot;,</span><br><span class="line">        &quot;https://ghproxy.com/https://github.com/aspect-build/bazel-lib/archive/refs/tags/v1.23.2.tar.gz&quot;,</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>é…ç½®nodejså·¥å…·é“¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@rules_nodejs//nodejs:repositories.bzl&quot;, &quot;nodejs_register_toolchains&quot;)</span><br><span class="line"></span><br><span class="line">nodejs_register_toolchains(</span><br><span class="line">    name = &quot;nodejs&quot;,</span><br><span class="line">    node_version = &quot;18.10.0&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨arm macä¸Šä¸æ”¯æŒnodejs20çš„ç‰ˆæœ¬ï¼Œä¸ç¡®å®šå…¶ä»–å¹³å°æ—¶å€™æ˜¯å¦æ”¯æŒnodejs20</p></blockquote><p>é…ç½®<code>yarn_install</code>ä¸‹è½½ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@build_bazel_rules_nodejs//:index.bzl&quot;, &quot;yarn_install&quot;)</span><br><span class="line"></span><br><span class="line">yarn_install(</span><br><span class="line">    name = &quot;npm&quot;,</span><br><span class="line">data = [</span><br><span class="line">        YARN_LABEL,</span><br><span class="line">        &quot;//:.yarnrc&quot;,</span><br><span class="line">&quot;//:patches/trim-newlines+5.0.0.patch&quot;</span><br><span class="line">],</span><br><span class="line">exports_directories_only = False,</span><br><span class="line">symlink_node_modules = True,</span><br><span class="line">    package_json = &quot;//:package.json&quot;,</span><br><span class="line">yarn = YARN_LABEL,</span><br><span class="line">    yarn_lock = &quot;//:yarn.lock&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>åˆ›å»º<code>BUILD.bazel</code>, å¹¶å®šä¹‰ä¸ºå…¬å¼€çš„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package(default_visibility = [&quot;//visibility:public&quot;])</span><br></pre></td></tr></table></figure><p>å¯¼å…¥<code>ts_project</code>å’Œ<code>nodejs_binary</code>ç”¨äºæ„å»ºtypescriptå’Œnodejsï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;@npm//@bazel/typescript:index.bzl&quot;, &quot;ts_project&quot;)</span><br><span class="line">load(&quot;@build_bazel_rules_nodejs//:index.bzl&quot;, &quot;nodejs_binary&quot;)</span><br></pre></td></tr></table></figure><p>å®šä¹‰<code>SRCS</code>å˜é‡ç”¨äºå£°æ˜æ‰€æœ‰éœ€è¦å‚ä¸ç¼–è¯‘çš„tsæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SRCS = glob(</span><br><span class="line">[</span><br><span class="line">&quot;src/**/*.ts&quot;,</span><br><span class="line">],</span><br><span class="line">exclude = [</span><br><span class="line">&quot;src/**/*.spec.ts&quot;</span><br><span class="line">]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>ts_project</code>å°†tsç¼–è¯‘æˆjsï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">ts_project(</span><br><span class="line">    name = &quot;server-ts&quot;,</span><br><span class="line">    srcs = [&quot;server.ts&quot; ] + SRCS,</span><br><span class="line">    resolve_json_module = True,</span><br><span class="line">    source_map = True,</span><br><span class="line">    tsconfig = &quot;//:tsconfig.json&quot;,</span><br><span class="line">    visibility = [&quot;//visibility:public&quot;],</span><br><span class="line">    deps = [</span><br><span class="line">        &quot;@npm//@apollo/server&quot;,</span><br><span class="line">        &quot;@npm//@graphql-tools/merge&quot;,</span><br><span class="line">        &quot;@npm//body-parser&quot;,</span><br><span class="line">        &quot;@npm//compression&quot;,</span><br><span class="line">        &quot;@npm//cookie-parser&quot;,</span><br><span class="line">        &quot;@npm//dotenv&quot;,</span><br><span class="line">        &quot;@npm//exceljs&quot;,</span><br><span class="line">        &quot;@npm//express&quot;,</span><br><span class="line">        &quot;@npm//express-fileupload&quot;,</span><br><span class="line">        &quot;@npm//express-joi-validation&quot;,</span><br><span class="line">        &quot;@npm//express-session&quot;,</span><br><span class="line">        &quot;@npm//graphql&quot;,</span><br><span class="line">        &quot;@npm//graphql-tag&quot;,</span><br><span class="line">        &quot;@npm//helmet&quot;,</span><br><span class="line">        &quot;@npm//joi&quot;,</span><br><span class="line">        &quot;@npm//jsonwebtoken&quot;,</span><br><span class="line">        &quot;@npm//knex&quot;,</span><br><span class="line">        &quot;@npm//lodash&quot;,</span><br><span class="line">        &quot;@npm//minio&quot;,</span><br><span class="line">        &quot;@npm//morgan&quot;,</span><br><span class="line">        &quot;@npm//pg&quot;,</span><br><span class="line">        &quot;@npm//pg-boss&quot;,</span><br><span class="line">        &quot;@npm//redis&quot;,</span><br><span class="line">        &quot;@npm//socket.io&quot;,</span><br><span class="line">        &quot;@npm//winston&quot;,</span><br><span class="line"></span><br><span class="line">        &quot;@npm//@types/express&quot;,</span><br><span class="line">        &quot;@npm//@types/express-fileupload&quot;,</span><br><span class="line">        &quot;@npm//@types/express-session&quot;,</span><br><span class="line">        &quot;@npm//@types/jest&quot;,</span><br><span class="line">        &quot;@npm//@types/node&quot;,</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥ç¼–è¯‘äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn bazel build //... </span><br></pre></td></tr></table></figure><p>æœ€åå¯ä»¥åœ¨<code>dist/bin</code>çœ‹åˆ°ä¸€ä¸ª<code>server.js</code>, æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œ<code>node dist/bin/server.js</code>è¿è¡Œæˆ‘ä»¬çš„nodejsé¡¹ç›®äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://bazel.build/">Bazelå®˜ç½‘</a></li><li><a href="https://zhuanlan.zhihu.com/p/411563404">Bazel å­¦ä¹ ç¬”è®° (ä¸€) å¿«é€Ÿå¼€å§‹</a></li><li><a href="https://zhuanlan.zhihu.com/p/402311730">ä½¿ç”¨Bazelç¼–è¯‘TypeScript</a></li><li><a href="https://github.com/angular/angular">angular</a></li><li><a href="https://github.com/damingerdai/express-postgres-ts-starter/pull/462">feat: add bazel support</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bazel </tag>
            
            <tag> typescript </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/07/03/hello-world/"/>
      <url>/2023/07/03/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨k3séƒ¨ç½²PostgreSQLç”¨äºå¼€å‘</title>
      <link href="/2023/04/14/back-end/how-to-user-k3s-deploy-postgresql-for-dev/"/>
      <url>/2023/04/14/back-end/how-to-user-k3s-deploy-postgresql-for-dev/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>PostgreSQLæ˜¯ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„å¼€æºæ•°æ®åº“ã€‚<br>æœ¬æ–‡çš„ç›®çš„æ˜¯ä½¿ç”¨k3sæœ¬åœ°éƒ¨ç½²PostgreSQLç”¨äºæœ¬åœ°å¼€å‘ä½¿ç”¨ï¼Œä¸å…·å¤‡ç›´æ¥ä¸Šç”Ÿäº§çš„èƒ½åŠ›ã€‚</p><h2 id="å®‰è£…PostgreSQL"><a href="#å®‰è£…PostgreSQL" class="headerlink" title="å®‰è£…PostgreSQL"></a>å®‰è£…PostgreSQL</h2><p>é¦–å…ˆå‡†å¤‡<code>config.yaml</code>ç”¨äºå®šä¹‰PostgreSQLçš„é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgres-config</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">postgres</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">POSTGRES_USER:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">  <span class="attr">POSTGRES_DB:</span> <span class="string">postgres</span></span><br></pre></td></tr></table></figure><p>ç”³è¯·PersistentVolumeç”¨äºæ•°æ®æŒä¹…åŒ–çš„å­˜å‚¨ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgres-pv-volume</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">manual</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">5Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">hostPath:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&quot;/mnt/data&quot;</span></span><br></pre></td></tr></table></figure><p>ç”³è¯·PersistentVolumeClaimç”¨äºæ•°æ®æŒä¹…åŒ–</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgres-pv-claim</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">local</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">manual</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">2Gi</span></span><br></pre></td></tr></table></figure><p>æ•°æ®åº“æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„æœåŠ¡ï¼Œæˆ‘è®¤ä¸ºStatefulSetæ¯”Podæ›´ä¸ºåˆé€‚ï¼Œæ‰€ä»¥ä½¿ç”¨StatefulSetåˆ›å»ºPostgreSQLå®ä¾‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;postgres&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">postgres</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">postgres:15.0</span></span><br><span class="line">          <span class="attr">envFrom:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">configMapRef:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">postgres-config</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5432</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">postgres</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">postgres-data</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/var/lib/PostgreSQL/data</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">postgres-data</span></span><br><span class="line">          <span class="attr">persistentVolumeClaim:</span></span><br><span class="line">            <span class="attr">claimName:</span> <span class="string">postgres-pv-claim</span></span><br></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ªServiceè®©k3sé‡Œçš„å…¶ä»–podå¯ä»¥è®¿é—®æ•°æ®åº“</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">postgres</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5432</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">postgres</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œkubectl applyå‘½ä»¤å»åˆ›å»ºå„ç§èµ„æºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f config.yaml</span><br><span class="line">kubectl apply -f pv.yaml</span><br><span class="line">kubectl apply -f pvc.yaml</span><br><span class="line">kubectl apply -f statefulset.yaml</span><br></pre></td></tr></table></figure><blockquote><p>è¯·å°½é‡æŒ‰ç…§é¡ºåºæ‰§è¡Œå‘½ä»¤</p></blockquote><p>æŸ¥çœ‹ä¸€ä¸‹æ•ˆæœ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods </span><br><span class="line"></span><br><span class="line">NAME         READY   STATUS    RESTARTS   AGE</span><br><span class="line">postgres-0   1/1     Running   0          17h</span><br><span class="line"></span><br><span class="line">----</span><br><span class="line">kubectl get services</span><br><span class="line"></span><br><span class="line">NAME       TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE</span><br><span class="line">postgres   ClusterIP   X.X.X.X   &lt;none&gt;        5432/TCP   17h</span><br></pre></td></tr></table></figure><p><code>X.X.X.X</code>æ˜¯ä½ k3sçš„é›†ç¾¤å†…éƒ¨ç½‘å€ï¼Œå› äººè€Œå¼‚</p><h2 id="é…ç½®PgBouncer"><a href="#é…ç½®PgBouncer" class="headerlink" title="é…ç½®PgBouncer"></a>é…ç½®PgBouncer</h2><p>PostgreSQLæ˜¯ä½¿ç”¨å¤šè¿›ç¨‹çš„æ¨¡å¼å»åˆ›å»ºè¿æ¥ï¼Œæ‰€ä»¥åˆ›å»ºè¿æ¥çš„æˆæœ¬æ¯”è¾ƒé«˜ï¼Œå› æ­¤æ¨èä½¿ç”¨PgBouncerä½œä¸ºPostgreSQLçš„è¿æ¥æ± ç”¨äºæé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚</p><p>å°†ä¸Šæ–‡ä¸­çš„PostgreSQLä»£ç†åˆ°æœ¬åœ°:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward postgres-0 5432:5432</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»»æ„æ–¹å¼ç™»å½•åˆ°PostgreSQLæ•°æ®åº“ï¼Œæ‰§è¡Œä¸€ä¸‹sqlå‘½ä»¤:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> concat(<span class="string">&#x27;&quot;&#x27;</span>, usename, <span class="string">&#x27;&quot; &quot;&#x27;</span>, passwd, <span class="string">&#x27;&quot;&#x27;</span>) <span class="keyword">FROM</span> pg_shadow;</span><br></pre></td></tr></table></figure><p>å°†è·å¾—çš„ç»“æœå†™å…¥userlist.txtæ–‡ä»¶ä¸­</p><blockquote><p>è¯¥æ­¥éª¤ä¸å¯ä»¥çœç•¥ï¼Œå› ä¸ºä¸åŒçš„æ•°æ®åº“å®ä¾‹å¯¼å‡ºçš„passwdæ˜¯ä¸ä¸€æ ·çš„ï¼ï¼ï¼</p></blockquote><p>å‡†å¤‡pgbouncer.iniï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[databases]</span></span><br><span class="line"><span class="attr">postgres</span> = host=postgres port=<span class="number">5432</span> dbname=postgres user=postgres password=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="section">[pgbouncer]</span></span><br><span class="line"><span class="attr">listen_addr</span> = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"><span class="attr">listen_port</span> = <span class="number">5432</span></span><br><span class="line"><span class="attr">admin_users</span> = postgres</span><br><span class="line"><span class="attr">stats_users</span> = postgres</span><br><span class="line"><span class="attr">auth_file</span> = /etc/pgbouncer/userlist.txt</span><br><span class="line"><span class="attr">auth_type</span> = scram-sha-<span class="number">256</span> </span><br><span class="line"><span class="attr">pool_mode</span> = session</span><br><span class="line"><span class="attr">ignore_startup_parameters</span> = extra_float_digits</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log settings</span></span><br><span class="line"><span class="comment"># admin_users = postgres</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Connection sanity checks, timeouts</span></span><br><span class="line"><span class="attr">server_tls_sslmode</span> = prefer</span><br><span class="line"></span><br><span class="line"><span class="comment"># TLS settings</span></span><br><span class="line"><span class="attr">client_tls_sslmode</span> = disable</span><br></pre></td></tr></table></figure><p>åˆ›å»ºpgbouncer.yamlç”¨äºå®šä¹‰pgbouncerçš„é…ç½®ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">KUBE_NAMESPACE=<span class="string">&quot;default&quot;</span></span><br><span class="line"><span class="built_in">cd</span> `<span class="built_in">dirname</span> <span class="variable">$0</span>`</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> *.ini</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">basename</span>=<span class="string">&quot;<span class="subst">$(basename $file)</span>&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$basname</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$file</span></span><br><span class="line">  kubectl create secret generic <span class="string">&quot;<span class="variable">$&#123;basename%.*&#125;</span>&quot;</span>-config --namespace=<span class="string">&quot;<span class="variable">$KUBE_NAMESPACE</span>&quot;</span> --from-file=<span class="string">&quot;<span class="variable">$file</span>&quot;</span>  --from-file=userlist.txt -o yaml --dry-run=client | <span class="built_in">tee</span> <span class="string">&quot;<span class="variable">$&#123;basename%.*&#125;</span>.yaml&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>å®šä¹‰Deployment:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgbouncer</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">pgbouncer</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">10</span>  <span class="comment"># removes old replicasets for deployment rollbacks</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">0</span>  <span class="comment"># Avoid Terminating and ContainerCreating at the same time</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">pgbouncer</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">pgbouncer</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pgbouncer</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">rmccaffrey/pgbouncer:1.18.1</span></span><br><span class="line">          <span class="comment">#imagePullPolicy: Always</span></span><br><span class="line">          <span class="attr">resources:</span></span><br><span class="line">            <span class="attr">requests:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">&quot;100Mi&quot;</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;0.5&quot;</span></span><br><span class="line">            <span class="attr">limits:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">&quot;200Mi&quot;</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5432</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">configfiles</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">&quot;/etc/pgbouncer&quot;</span></span><br><span class="line">              <span class="attr">readOnly:</span> <span class="literal">true</span>  <span class="comment"># writes update the secret!</span></span><br><span class="line">          <span class="attr">livenessProbe:</span></span><br><span class="line">            <span class="attr">tcpSocket:</span></span><br><span class="line">              <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">            <span class="attr">periodSeconds:</span> <span class="number">60</span></span><br><span class="line">          <span class="attr">lifecycle:</span></span><br><span class="line">            <span class="attr">preStop:</span></span><br><span class="line">              <span class="attr">exec:</span></span><br><span class="line">                <span class="comment"># Allow existing queries clients to complete within 120 seconds</span></span><br><span class="line">                <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;killall -INT pgbouncer &amp;&amp; sleep 120&quot;</span>]</span><br><span class="line">          <span class="attr">securityContext:</span></span><br><span class="line">            <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">capabilities:</span></span><br><span class="line">              <span class="attr">drop:</span> [<span class="string">&#x27;all&#x27;</span>]</span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">configfiles</span></span><br><span class="line">          <span class="attr">secret:</span></span><br><span class="line">            <span class="attr">secretName:</span> <span class="string">pgbouncer-config</span></span><br></pre></td></tr></table></figure><p>å®šä¹‰Service:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgbouncer</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">pgbouncer</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5432</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">pgbouncer</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºèµ„æºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f pgbouncer.yaml</span><br><span class="line">kubectl apply -f deployment.yaml</span><br><span class="line">kubectl apply -f service.yaml</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ•ˆæœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kubectl get services</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">NAME        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE</span><br><span class="line">postgres    ClusterIP   X.X.X.X        &lt;none&gt;        5432/TCP   17h</span><br><span class="line">pgbouncer   ClusterIP   X.X.X.X        &lt;none&gt;        5432/TCP   50s</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨port-forwardä»£ç†åˆ°æœ¬åœ°è¿›è¡Œæµ‹è¯•pgbounceræ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward service/pgbouncer 5432:5432</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å®ç°äº†ä½¿ç”¨k3séƒ¨ç½²PostgreSQLå’ŒPgBouncerï¼Œå¯ä»¥ç”¨äºä¸€èˆ¬çš„æœ¬åœ°å¼€å‘åå¢ƒä½¿ç”¨ï¼Œä¹Ÿåœ¨docker destkopä¸Šæµ‹è¯•é€šè¿‡ï¼Œä½†æ˜¯æ²¡æœ‰åœ¨minikubeä¸Šæµ‹è¯•è¿‡ã€‚</p><p>ä»¥ä¸Šèµ„æºå¯ä»¥åœ¨<a href="https://github.com/damingerdai/health-master/tree/main/deplyoments/db">health-master-deployments-db</a>å’Œ<a href="https://github.com/damingerdai/health-master/tree/main/deplyoments/pgbouncer">health-master-deployments-pgbouncer</a>ä¸Šè·å–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> PostgreSQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯</title>
      <link href="/2023/02/26/back-end/windows_docker_port_in_use_issues/"/>
      <url>/2023/02/26/back-end/windows_docker_port_in_use_issues/</url>
      
        <content type="html"><![CDATA[<h1 id="è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯"><a href="#è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯" class="headerlink" title="è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯"></a>è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯</h1><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åœ¨ä½¿ç”¨docker-composeå¯åŠ¨mysqlçš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span>: An attempt was made to access a socket <span class="keyword">in</span> a way forbidden by its access permissions.</span><br></pre></td></tr></table></figure><p>ç„¶åæŸ¥äº†ä¸€ä¸‹æ˜¯å¦å­˜åœ¨åº”ç”¨å ç”¨äº†3306çš„ç«¯å£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr 3306</span><br></pre></td></tr></table></figure><p>ç»“æœå¾ˆå°´å°¬ï¼Œå¹¶æ²¡æœ‰ã€‚ã€‚ã€‚</p><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯<code>Hyper-V</code>ä¼šä¿ç•™éƒ¨åˆ†tcpç«¯å£å¯¼è‡´æˆ‘ä»¬è‡ªå·±æ— æ³•ä½¿ç”¨è¿™äº›ç«¯å£, ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ä¿ç•™çš„ç«¯å£ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">netsh interface ipv4 show excludedportrange protocol=tcp</span><br><span class="line"></span><br><span class="line">åè®® tcp ç«¯å£æ’é™¤èŒƒå›´</span><br><span class="line"></span><br><span class="line">å¼€å§‹ç«¯å£    ç»“æŸç«¯å£</span><br><span class="line"><span class="literal">----------</span>    <span class="literal">--------</span></span><br><span class="line">      <span class="number">1026</span>        <span class="number">1125</span></span><br><span class="line">      <span class="number">1126</span>        <span class="number">1225</span></span><br><span class="line">      <span class="number">1226</span>        <span class="number">1325</span></span><br><span class="line">      <span class="number">1326</span>        <span class="number">1425</span></span><br><span class="line">      <span class="number">1426</span>        <span class="number">1525</span></span><br><span class="line">      <span class="number">1538</span>        <span class="number">1637</span></span><br><span class="line">      <span class="number">2327</span>        <span class="number">2426</span></span><br><span class="line">      <span class="number">2427</span>        <span class="number">2526</span></span><br><span class="line">      <span class="number">2527</span>        <span class="number">2626</span></span><br><span class="line">      <span class="number">2627</span>        <span class="number">2726</span></span><br><span class="line">      <span class="number">2727</span>        <span class="number">2826</span></span><br><span class="line">      <span class="number">2827</span>        <span class="number">2926</span></span><br><span class="line">      <span class="number">6344</span>        <span class="number">6567</span></span><br><span class="line">     <span class="number">50000</span>       <span class="number">50059</span>     *</span><br><span class="line">     <span class="number">50070</span>       <span class="number">50070</span>     *</span><br><span class="line"></span><br><span class="line">* - ç®¡ç†çš„ç«¯å£æ’é™¤ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>è§£å†³æ–¹æ¡ˆå¾ˆå¤šï¼Œä½†æ˜¯æœ€æ¨èçš„è¯¥å¸‚ä¿®æ”¹æ°¸ä¹…æ’é™¤ä¿ç•™ç«¯å£ï¼š</p><p>é¦–é€‰å…³é—­docker, ç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€powershellï¼Œ è¾“å…¥ä»¥ä¸‹å‘½ä»¤ç”¨äºå…³é—­Hyper-V:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism.exe /Online /Disable-Feature:Microsoft-Hyper-V</span><br></pre></td></tr></table></figure><blockquote><p>è¯¥æ“ä½œå¯èƒ½éœ€è¦é‡å¯</p></blockquote><p>ç„¶åå°†3306ç«¯å£æ°¸ä¹…æ’é™¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh int ipv4 add excludedportrange protocol=tcp startport=3306 numberofports=1 store=persistent</span><br></pre></td></tr></table></figure><p>æœ€åé‡å¯Hyper-V:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism.exe /Online /Enable-Feature:Microsoft-Hyper-V /All</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://www.cnblogs.com/uncmd/p/16056993.html">è§£å†³Windowsä¸‹Dockerå¯åŠ¨å®¹å™¨æ—¶ï¼Œç«¯å£è¢«å ç”¨é”™è¯¯</a></li><li><a href="https://www.cnblogs.com/fansys/articles/13375989.html">ä¿®æ”¹Hyper-VåŠ¨æ€ç«¯å£èŒƒå›´</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> windows </tag>
            
            <tag> docker desktop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä½¿ç”¨pg_dumpä¸­é‡åˆ°çš„sslé—®é¢˜</title>
      <link href="/2023/02/25/back-end/pg_dump_ssl_issues/"/>
      <url>/2023/02/25/back-end/pg_dump_ssl_issues/</url>
      
        <content type="html"><![CDATA[<h1 id="è®°å½•ä½¿ç”¨pg-dumpä¸­é‡åˆ°çš„sslé—®é¢˜"><a href="#è®°å½•ä½¿ç”¨pg-dumpä¸­é‡åˆ°çš„sslé—®é¢˜" class="headerlink" title="è®°å½•ä½¿ç”¨pg_dumpä¸­é‡åˆ°çš„sslé—®é¢˜"></a>è®°å½•ä½¿ç”¨pg_dumpä¸­é‡åˆ°çš„sslé—®é¢˜</h1><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åœ¨ä½¿ç”¨<code>pg_dump</code>è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>SSL connection is required. Please specify SSL options and retry.</li><li>SSL error: unsafe legacy renegotiation disabled</li></ol><h2 id="SSL-optioné—®é¢˜"><a href="#SSL-optioné—®é¢˜" class="headerlink" title="SSL optioné—®é¢˜"></a>SSL optioné—®é¢˜</h2><p>è¿™æ˜¯å› ä¸ºpostgresqléœ€è¦ä½¿ç”¨TLS&#x2F;SSL connectionsï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡<code>PGSSLMODE</code>ä¸º<code>required</code>å°±å¯ä»¥äº†ã€‚</p><p>é’ˆå¯¹Linuxæˆ–è€…Macosç”¨æˆ·ï¼Œä½¿ç”¨:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PGSSLMODE=require</span><br></pre></td></tr></table></figure><p>é’ˆå¯¹Windowsç”¨æˆ·ï¼Œä½¿ç”¨:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PGSSLMODE=require</span><br></pre></td></tr></table></figure><h2 id="unsafe-legacy-renegotiation-disabled"><a href="#unsafe-legacy-renegotiation-disabled" class="headerlink" title="unsafe legacy renegotiation disabled"></a>unsafe legacy renegotiation disabled</h2><p>è¿™æ˜¯å› ä¸ºsslåè®®å­˜åœ¨ä¸€ä¸ªæ¼æ´ï¼Œåæ¥å‡çº§çš„æ—¶å€™æä¾›äº†ä¸€ä¸ªå¼€å…³é»˜è®¤å…³é—­è¿™ä¸ªäº†æ¼æ´ï¼Œè¿™ä¸ªè§£å†³æ–¹æ³•å­˜åœ¨ä¸€å®šå®‰å…¨éšæ‚£ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p><p>åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„<code>openssl.cnf</code>,å¹¶å†™å…¥ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">openssl_conf</span> = openssl_init</span><br><span class="line"></span><br><span class="line"><span class="section">[openssl_init]</span></span><br><span class="line"><span class="attr">ssl_conf</span> = ssl_sect</span><br><span class="line"></span><br><span class="line"><span class="section">[ssl_sect]</span></span><br><span class="line"><span class="attr">system_default</span> = system_default_sect</span><br><span class="line"></span><br><span class="line"><span class="section">[system_default_sect]</span></span><br><span class="line"><span class="attr">Options</span> = UnsafeLegacyRenegotiation</span><br></pre></td></tr></table></figure><p>å°†è¯¥configæ–‡ä»¶çš„è·¯å¾„å†™å…¥åä¸º<code>OPENSSL_CONF</code>çš„ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> OPENSSL_CONF=/path/to/custom/openssl.cnf</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://learn.microsoft.com/en-us/azure/postgresql/migrate/how-to-migrate-using-dump-and-restore">Migrate your PostgreSQL database by using dump and restore</a></li><li><a href="https://stackoverflow.com/questions/71603314/ssl-error-unsafe-legacy-renegotiation-disabled">SSL error unsafe legacy renegotiation disabled</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssl </tag>
            
            <tag> pg_dump </tag>
            
            <tag> postgresql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€äº›æµ‹è¯•å¸çš„æ°´é¾™å¤´</title>
      <link href="/2023/01/07/web3/some-token-faucet/"/>
      <url>/2023/01/07/web3/some-token-faucet/</url>
      
        <content type="html"><![CDATA[<h1 id="è®°å½•ä¸€äº›æµ‹è¯•å¸çš„æ°´é¾™å¤´"><a href="#è®°å½•ä¸€äº›æµ‹è¯•å¸çš„æ°´é¾™å¤´" class="headerlink" title="è®°å½•ä¸€äº›æµ‹è¯•å¸çš„æ°´é¾™å¤´"></a>è®°å½•ä¸€äº›æµ‹è¯•å¸çš„æ°´é¾™å¤´</h1><p>è®°å½•ä¸€äº›å¸¸ç”¨çš„åŒºå—é“¾æ°´é¾™å¤´ï¼Œä»¥é˜²å¿˜è®°</p><h2 id="Goerli"><a href="#Goerli" class="headerlink" title="Goerli"></a>Goerli</h2><p><a href="https://goerli-faucet.slock.it/">Goerli Testnet Faucet</a>: ä¸å¤ªè®°å¾—å½“åˆæ˜¯æ€ä¹ˆçŸ¥é“äº†ï¼Œä½†æ˜¯ä¼¼ä¹æ°¸è¿œå¤±è´¥â€¦</p><p><a href="https://goerlifaucet.com/">GOERLI FAUCET</a>, æ¯å¤©å¯ä»¥è·å–0.1 ETH(ä»¥å‰æ˜¯å¯ä»¥æ¯å¤©é¢†å–0.25ETH), éœ€è¦ä½¿ç”¨<a href="https://www.alchemy.com/">Alchemy</a>è´¦å·.</p><p><a href="https://goerli-faucet.pk910.de/">Mining Faucet</a>, ä½¿ç”¨cpuçš„ç®—åŠ›å»æŒ–çŸ¿ï¼Œé—®é¢˜ä¸å¤§ï¼Œå¯ä»¥ä½¿ç”¨ã€‚</p><h2 id="polygon"><a href="#polygon" class="headerlink" title="polygon"></a>polygon</h2><p><a href="https://faucet.polygon.technology/">polygon faucet</a>, æ”¯æŒå¤šä¸ªæµ‹è¯•ç½‘ç»œï¼Œä½†æ˜¯Goerliçš„ETHæ²¡æ‹¿åˆ°</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://hackmd.io/@m061i6/HJQQ4G5-j">å…è²»å–å¾—Goerliæ¸¬è©¦å¹£</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web3 </tag>
            
            <tag> Goerli </tag>
            
            <tag> polygon </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k3sä½¿ç”¨Letâ€˜s Encrypté…ç½®httpså…¥å£éƒ¨ç½²</title>
      <link href="/2022/09/03/back-end/k3s-uses-letsencrypt-and-traefik-to-deploy-the-https/"/>
      <url>/2022/09/03/back-end/k3s-uses-letsencrypt-and-traefik-to-deploy-the-https/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡è®°å½•k3sä½¿ç”¨letsencrypté…ç½®sslè¯ä¹¦å’Œç»­ç­¾ã€‚</p><p>æœ¬æ–‡ä½¿ç”¨çš„k3sç‰ˆæœ¬ä¸ºï¼š v1.23.6+k3s1ã€‚</p><h2 id="å®‰è£…-cert-manager"><a href="#å®‰è£…-cert-manager" class="headerlink" title="å®‰è£… cert-manager"></a>å®‰è£… cert-manager</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å®˜ç½‘æä¾›çš„é…ç½®æ–‡ä»¶ä¸€é”®å®‰è£…</span></span><br><span class="line"><span class="comment"># å¦‚æœæ‹‰å– github èµ„æºæœ‰å›°éš¾ï¼Œå¯ä»¥ä»ç½‘ç»œé€šç•…çš„ä½ç½®ä¸‹è½½å¥½ç²˜è´´è¿‡å»</span></span><br><span class="line">$ kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.9.1/cert-manager.yaml</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œk3s</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pods -n cert-manager</span><br><span class="line">NAME                                       READY   STATUS    RESTARTS   AGE</span><br><span class="line">cert-manager-6544c44c6b-tlhw8              1/1     Running   0          51s</span><br><span class="line">cert-manager-cainjector-5687864d5f-rldsg   1/1     Running   0          51s</span><br><span class="line">cert-manager-webhook-785bb86798-g4g7g      1/1     Running   0          51s</span><br></pre></td></tr></table></figure><h2 id="éƒ¨ç½²-Issuing-Certificates"><a href="#éƒ¨ç½²-Issuing-Certificates" class="headerlink" title="éƒ¨ç½² Issuing Certificates"></a>éƒ¨ç½² Issuing Certificates</h2><p>åˆ›å»ºletsencrypt.yamlæ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">cert-manager.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterIssuer</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">cert-manager</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">letsencrypt</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">acme:</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">&lt;YOUR</span> <span class="string">EMAIL&gt;</span> <span class="comment"># replace this</span></span><br><span class="line">    <span class="attr">privateKeySecretRef:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">prod-issuer-account-key</span></span><br><span class="line">    <span class="attr">server:</span> <span class="string">https://acme-v02.api.letsencrypt.org/directory</span></span><br><span class="line">    <span class="attr">solvers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">http01:</span></span><br><span class="line">          <span class="attr">ingress:</span></span><br><span class="line">            <span class="attr">class:</span> <span class="string">traefik</span></span><br><span class="line">        <span class="attr">selector:</span> &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯·è‡ªè¡Œæ›¿æ¢<YOUR email>ä¸ºä¸ªäººçš„é‚®ä»¶åœ°å€</YOUR></p></blockquote><p>éƒ¨ç½²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f letsencrypt.yaml</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡æ­£å¸¸:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl describe clusterissuer letsencrypt</span><br><span class="line">Name:         letsencrypt</span><br><span class="line">Namespace:    </span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  &lt;none&gt;</span><br><span class="line">API Version:  cert-manager.io/v1</span><br><span class="line">Kind:         ClusterIssuer</span><br><span class="line">...</span><br><span class="line">Spec:</span><br><span class="line">  Acme:</span><br><span class="line">    Email:            user@example.com</span><br><span class="line">    Preferred Chain:  </span><br><span class="line">    Private Key Secret Ref:</span><br><span class="line">      Name:  prod-issuer-account-key</span><br><span class="line">    Server:  https://acme-v02.api.letsencrypt.org/directory</span><br><span class="line">    Solvers:</span><br><span class="line">      http01:</span><br><span class="line">        Ingress:</span><br><span class="line">          Class:  traefik</span><br><span class="line">      Selector:</span><br><span class="line">Status:</span><br><span class="line">  Acme:</span><br><span class="line">    Last Registered Email:  mingguobin@live.com</span><br><span class="line">    Uri:                    https://acme-v02.api.letsencrypt.org/acme/acct/715199687</span><br><span class="line">  Conditions:</span><br><span class="line">    Last Transition Time:  2022-09-03T12:20:23Z</span><br><span class="line">    Message:               The ACME account was registered with the ACME server</span><br><span class="line">    Observed Generation:   1</span><br><span class="line">    Reason:                ACMEAccountRegistered</span><br><span class="line">    Status:                True</span><br><span class="line">    Type:                  Ready</span><br><span class="line">Events:                    &lt;none&gt;</span><br></pre></td></tr></table></figure><h2 id="ç»™Ingressé…ç½®ssl"><a href="#ç»™Ingressé…ç½®ssl" class="headerlink" title="ç»™Ingressé…ç½®ssl"></a>ç»™Ingressé…ç½®ssl</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">hoteler-namespace</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">cert-manager.io/cluster-issuer:</span> <span class="string">letsencrypt</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hoteler-web</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">tls:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">secretName:</span> <span class="string">hoteler-web-tls</span></span><br><span class="line">    <span class="attr">hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">hoteler.damingerdai.com</span></span><br><span class="line">  <span class="comment"># ingressClassName: traefik</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">hoteler.damingerdai.com</span></span><br><span class="line">    <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">hoteler-web</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>æ”¹åŠ¨å¦‚ä¸‹ï¼š</p><ol><li>æ·»åŠ annotationsçš„metadata</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">annotations:</span></span><br><span class="line">  <span class="attr">cert-manager.io/cluster-issuer:</span> <span class="string">letsencrypt</span></span><br></pre></td></tr></table></figure><ol start="2"><li>æ·»åŠ tls</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tls:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">secretName:</span> <span class="string">hoteler-web-tls</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hoteler.damingerdai.com</span></span><br></pre></td></tr></table></figure><p>secretNameå¯ä»¥æŒ‰ç…§è‡ªå·±çš„ä¹ æƒ¯æ¥å–ï¼Œcert-managerä¼šè‡ªåŠ¨åˆ›å»º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f ingress.yaml -n hoteler-namespace</span><br><span class="line">$ kubectl get ingress -n hoteler-namespace</span><br><span class="line">hoteler-web                 &lt;none&gt;   hoteler.damingerdai.com         204.44.75.77   80, 443   115d</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°hoteler-webé™¤äº†80ç«¯å£ï¼Œè¿˜æ–°åŠ äº†443ç«¯å£</p><h2 id="æŸ¥çœ‹è¯ä¹¦çŠ¶æ€"><a href="#æŸ¥çœ‹è¯ä¹¦çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹è¯ä¹¦çŠ¶æ€"></a>æŸ¥çœ‹è¯ä¹¦çŠ¶æ€</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl describe certificate -n hoteler-namespace</span></span><br><span class="line">...</span><br><span class="line">Status:</span><br><span class="line">  Conditions:</span><br><span class="line">    Last Transition Time:  2022-09-03T12:27:15Z</span><br><span class="line">    Message:               Certificate is up to date and has not expired</span><br><span class="line">    Observed Generation:   1</span><br><span class="line">    Reason:                Ready</span><br><span class="line">    Status:                True</span><br><span class="line">    Type:                  Ready</span><br><span class="line">  Not After:               2022-12-02T11:27:13Z</span><br><span class="line">  Not Before:              2022-09-03T11:27:14Z</span><br><span class="line">  Renewal Time:            2022-11-02T11:27:13Z</span><br><span class="line">  Revision:                1</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason     Age   From                                       Message</span><br><span class="line">  ----    ------     ----  ----                                       -------</span><br><span class="line">  Normal  Issuing    30m   cert-manager-certificates-trigger          Issuing certificate as Secret does not exist</span><br><span class="line">  Normal  Generated  30m   cert-manager-certificates-key-manager      Stored new private key in temporary Secret resource &quot;hoteler-web-tls-pfxrp&quot;</span><br><span class="line">  Normal  Requested  30m   cert-manager-certificates-request-manager  Created new CertificateRequest resource &quot;hoteler-web-tls-v24f6&quot;</span><br><span class="line">  Normal  Issuing    29m   cert-manager-certificates-issuing          The certificate has been successfully issued</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/back-end/hoteler-web-certificate.png" alt="Hoteler Web"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://www.frytea.com/technology/k8s/k3s-uses-letsencrypt-and-traefik-to-deploy-the-https/">k3s ä½¿ç”¨ Letsencrypt å’Œ Traefik å®Œæˆ https å…¥å£éƒ¨ç½²</a></li><li><a href="http://t.zoukankan.com/dream2true-p-13064701.html">K3Sä¸Dockerå¸¸ç”¨å‘½ä»¤</a></li><li><a href="https://cert-manager.io/docs/tutorials/acme/nginx-ingress/">Securing NGINX-ingress</a></li><li><a href="https://github.com/cert-manager/cert-manager/issues/2319">Documenting â€œcontext deadline exceededâ€ errors relating to the webhook</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> ssl </tag>
            
            <tag> k3s </tag>
            
            <tag> letsencrypt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»™Ingressä¸Šé…ç½®sslè¯ä¹¦</title>
      <link href="/2022/06/18/back-end/add-ssl-for-ingress/"/>
      <url>/2022/06/18/back-end/add-ssl-for-ingress/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»™Ingressä¸Šé…ç½®sslè¯ä¹¦"><a href="#ç»™Ingressä¸Šé…ç½®sslè¯ä¹¦" class="headerlink" title="ç»™Ingressä¸Šé…ç½®sslè¯ä¹¦"></a>ç»™Ingressä¸Šé…ç½®sslè¯ä¹¦</h1><h2 id="åˆ›å»ºsecret"><a href="#åˆ›å»ºsecret" class="headerlink" title="åˆ›å»ºsecret"></a>åˆ›å»ºsecret</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl create secret tls [secretName]  --cert=[pemæ–‡ä»¶è·¯å¾„] --key=[keyæ–‡ä»¶è·¯å¾„] --namespace [namespace] -o yaml --dry-run=client &gt; ingress-default-cert.yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kubectl apply -f ingress-default-cert.yaml</span><br></pre></td></tr></table></figure><h2 id="Ingressæ·»åŠ è¯ä¹¦"><a href="#Ingressæ·»åŠ è¯ä¹¦" class="headerlink" title="Ingressæ·»åŠ è¯ä¹¦"></a>Ingressæ·»åŠ è¯ä¹¦</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span>  </span><br><span class="line"><span class="attr">metadata:</span> </span><br><span class="line">    <span class="attr">name:</span> [<span class="string">ingress-name</span>] </span><br><span class="line">    <span class="attr">namespace:</span> [<span class="string">namespace</span>] <span class="comment"># ingressè¦å’Œsecretåœ¨åŒä¸€ä¸ªåç§°ç©ºé—´ä¸‹ </span></span><br><span class="line">    <span class="attr">annotations:</span> </span><br><span class="line">        <span class="attr">kubernetes.io/ingress.class:</span> <span class="string">traefik</span> </span><br><span class="line">        <span class="attr">traefik.frontend.rule.type:</span> <span class="string">PathPrefixStrip</span> </span><br><span class="line">        <span class="comment"># http é‡å®šå‘åˆ° https </span></span><br><span class="line">        <span class="attr">ingress.kubernetes.io/ssl-redirect:</span> <span class="string">&quot;True&quot;</span> </span><br><span class="line"><span class="attr">spec:</span> </span><br><span class="line">    <span class="attr">tls:</span> </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">hosts:</span> </span><br><span class="line">            <span class="bullet">-</span> <span class="string">xxxx.xxxx</span> <span class="comment"># è¿™é‡Œæ˜¯ä¸‹é¢è¦é…ç½®httpsçš„åŸŸå </span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">xxxx.xxxx</span> <span class="comment"># è¿™é‡Œæ˜¯ä¸‹é¢è¦é…ç½®httpsçš„åŸŸå </span></span><br><span class="line">        <span class="attr">secretName:</span> </span><br><span class="line">            [<span class="string">secret-name</span>]<span class="string">:</span> </span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">xxx.xxx.com</span></span><br><span class="line">      <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> [<span class="string">service-name</span>]</span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">8080</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://mars-tian.github.io/2022/01/10/%E4%B8%BAk8s%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6/">ä¸ºk8sé›†ç¾¤é…ç½®SSLè¯ä¹¦</a></li><li><a href="https://ubisoft-potato.github.io/2019/11/03/k3s-pei-zhi-ingress-shi-yong-ssl-zheng-shu/">k3sé…ç½®ingressä½¿ç”¨sslè¯ä¹¦</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> ingress </tag>
            
            <tag> ssl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Angularç‹¬ç«‹ç»„ä»¶ç®€å•ä½“éªŒ</title>
      <link href="/2022/06/09/front-end/angular-standalone-components-app/"/>
      <url>/2022/06/09/front-end/angular-standalone-components-app/</url>
      
        <content type="html"><![CDATA[<h1 id="Angularç‹¬ç«‹ç»„ä»¶ç®€å•ä½“éªŒ"><a href="#Angularç‹¬ç«‹ç»„ä»¶ç®€å•ä½“éªŒ" class="headerlink" title="Angularç‹¬ç«‹ç»„ä»¶ç®€å•ä½“éªŒ"></a>Angularç‹¬ç«‹ç»„ä»¶ç®€å•ä½“éªŒ</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Angular 14ä¸€é¡¹ä»¤äººå…´å¥‹çš„ç‰¹æ€§å°±æ˜¯Angularçš„ç‹¬ç«‹ç»„ä»¶ç»ˆäºæ¥äº†ã€‚</p><p>åœ¨Angular 14ä¸­ï¼Œ å¼€å‘è€…å¯ä»¥å°è¯•ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¼€å‘å„ç§ç»„ä»¶ï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯Angularç‹¬ç«‹ç»„ä»¶çš„APIä»ç„¶æ²¡æœ‰ç¨³å®šä¸‹ï¼Œå°†æ¥å¯èƒ½å­˜åœ¨ä¸€äº›ç ´åæ€§æ›´æ–°ï¼Œæ‰€ä»¥ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p><h2 id="å¦‚ä½•åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶"><a href="#å¦‚ä½•åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶" class="headerlink" title="å¦‚ä½•åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶"></a>å¦‚ä½•åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶</h2><p>å¯¹äºå·²æœ‰çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>@Component()</code>ä¸­æ·»åŠ <em>standalone: true</em>çš„æ ‡è¯†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨æ²¡æœ‰<code>@NgModule()</code>çš„æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨<code>imports</code>å¯¼å…¥å…¶ä»–æ¨¡å—äº†ã€‚<br>å¦‚æœæ˜¯æ–°å»ºç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>ng generate component &lt;name&gt; --standalone</code>çš„å‘½ä»¤ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶, ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component button-list --standalone</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@<span class="title class_">Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-button-list&#x27;</span>,</span><br><span class="line">  <span class="attr">standalone</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">CommonModule</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./button-list.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./button-list.component.scss&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ButtonListComponent</span> implements <span class="title class_">OnInit</span></span><br></pre></td></tr></table></figure><h2 id="åœ¨ç‹¬ç«‹ç»„ä»¶ä¸­å¯¼å…¥å·²æœ‰çš„æ¨¡å—"><a href="#åœ¨ç‹¬ç«‹ç»„ä»¶ä¸­å¯¼å…¥å·²æœ‰çš„æ¨¡å—" class="headerlink" title="åœ¨ç‹¬ç«‹ç»„ä»¶ä¸­å¯¼å…¥å·²æœ‰çš„æ¨¡å—"></a>åœ¨ç‹¬ç«‹ç»„ä»¶ä¸­å¯¼å…¥å·²æœ‰çš„æ¨¡å—</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>imports</code>ä¸­æ·»åŠ å·²æœ‰çš„æ¨¡å—ï¼Œä»¥<code>MatButtonModule</code>ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">imports: [</span><br><span class="line">    CommonModule,</span><br><span class="line">    MatButtonModule,</span><br><span class="line">],</span><br></pre></td></tr></table></figure><p>è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥åœ¨<code>ButtonListComponent</code>ä¸­ä½¿ç”¨<code>MatButtonModule</code>çš„<code>mat-button</code>ç»„ä»¶äº†ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span>&gt;</span>Basic<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span> <span class="attr">color</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>Primary<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span> <span class="attr">color</span>=<span class="string">&quot;accent&quot;</span>&gt;</span>Accent<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span> <span class="attr">color</span>=<span class="string">&quot;warn&quot;</span>&gt;</span>Warn<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span> <span class="attr">disabled</span>&gt;</span>Disabled<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">mat-button</span> <span class="attr">href</span>=<span class="string">&quot;https://damingerdai.github.io&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœå›¾ï¼š</p><p><img src="/images/angular-standalone-components-app/angular-standalone-components-app-button-list.png" alt="angular-standalone-components-app-button-list"></p><h2 id="ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¯åŠ¨Angularåº”ç”¨"><a href="#ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¯åŠ¨Angularåº”ç”¨" class="headerlink" title="ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¯åŠ¨Angularåº”ç”¨"></a>ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¯åŠ¨Angularåº”ç”¨</h2><p>ç¬¬ä¸€æ­¥ï¼Œ å°†<code>AppComponent</code>è®¾ç½®ä¸ºç‹¬ç«‹ç»„ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@<span class="title class_">Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-root&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./app.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./app.component.scss&#x27;</span>],</span><br><span class="line">  <span class="attr">standalone</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppComponent</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œå°†<code>AppModule</code>çš„importsä¸­çš„å¯¼å…¥çš„æ¨¡å—åŠ å…¥åˆ°<code>AppComponent</code>çš„importsä¸­,ä½†æ˜¯æœ‰ä¸¤ä¸ªæ¨¡å—ä¾‹å¤–ï¼š <code>BrowserModule</code>å’Œ<code>BrowserAnimationsModule</code>ã€‚</p><p>å¦‚æœå¯¼å…¥çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´** <code>BrowserModule</code> have already been loaded. If you need access to common directives such as NgIf and NgFor, import the <code>CommonModule</code> instead.**çš„é—®é¢˜ï¼š</p><p><img src="/images/angular-standalone-components-app/angular-app-commonent-browser-module-error.png" alt="angular-app-commonent-browser-module-error"></p><p>ç¬¬ä¸‰æ­¥ï¼Œåˆ é™¤<code>app.module.ts</code>æ–‡ä»¶</p><p>æœ€åä¸€æ­¥ï¼Œ å°†<code>main.ts</code>ä¸­çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; platformBrowserDynamic &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/platform-browser-dynamic&#x27;</span>;</span><br><span class="line"><span class="title function_">platformBrowserDynamic</span>().<span class="title function_">bootstrapModule</span>(<span class="title class_">AppModule</span>)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br></pre></td></tr></table></figure><p>æ”¹ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">bootstrapApplication</span>(<span class="title class_">AppComponent</span>).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br></pre></td></tr></table></figure><p>è¿™æ ·å­æˆ‘ä»¬å°±å®ç°äº†ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶å¯åŠ¨Angularç»„ä»¶äº†ã€‚</p><h2 id="ä¸ºç‹¬ç«‹ç»„ä»¶é…ç½®è·¯ç”±"><a href="#ä¸ºç‹¬ç«‹ç»„ä»¶é…ç½®è·¯ç”±" class="headerlink" title="ä¸ºç‹¬ç«‹ç»„ä»¶é…ç½®è·¯ç”±"></a>ä¸ºç‹¬ç«‹ç»„ä»¶é…ç½®è·¯ç”±</h2><p>æˆ‘è¿™é‡Œåˆ†åˆ«æœ‰ä¸‰ä¸ªç‹¬ç«‹ç»„ä»¶ï¼š <code>HomeComponent</code>, <code>ButtonListComponent</code> å’Œ <code>ChipListComponent</code>ï¼Œ</p><p>ç„¶ååœ¨<code>main.ts</code>ä¸­åˆ›å»º<strong>ROUTES</strong>å¯¹è±¡</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">ROUTES</span>: <span class="title class_">Route</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">pathMatch</span>: <span class="string">&#x27;full&#x27;</span>,</span><br><span class="line">    <span class="attr">redirectTo</span>: <span class="string">&#x27;home&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">HomeComponent</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">    <span class="attr">loadComponent</span>: <span class="function">() =&gt;</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;./app/button-list/button-list.component&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">        <span class="function">(<span class="params">mod</span>) =&gt;</span> mod.<span class="property">ButtonListComponent</span></span><br><span class="line">      ),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;chip&#x27;</span>,</span><br><span class="line">    <span class="attr">loadComponent</span>: <span class="function">() =&gt;</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;./app/chip-list/chip-list.component&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">        <span class="function">(<span class="params">mod</span>) =&gt;</span> mod.<span class="property">ChipListComponent</span></span><br><span class="line">      ),</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>ButtonListComponent</code>å’Œ<code>ChipListComponent</code>ä½¿ç”¨<code>loadComponent</code>å»å®ç°è·¯ç”±æ‡’åŠ è½½ã€‚</p><p>æœ€ååœ¨<code>bootstrapApplication</code>çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­ä½¿ç”¨<code>providers</code>æ³¨å†Œ<code>RouterModule</code>å¥½äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">bootstrapApplication</span>(<span class="title class_">AppComponent</span>, &#123;</span><br><span class="line">  <span class="attr">providers</span>: [</span><br><span class="line">    importProvidersFrom(<span class="title class_">RouterModule</span>.<span class="title function_">forRoot</span>([...<span class="variable constant_">ROUTES</span>])),</span><br><span class="line">  ],</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br></pre></td></tr></table></figure><p>æ•ˆæœå›¾ï¼š</p><p><img src="/images/angular-standalone-components-app/angular-standalone-components-app-button-list.gif" alt="angular-standalone-components-app-button-list"></p><h2 id="é…ç½®ä¾èµ–æ³¨å…¥"><a href="#é…ç½®ä¾èµ–æ³¨å…¥" class="headerlink" title="é…ç½®ä¾èµ–æ³¨å…¥"></a>é…ç½®ä¾èµ–æ³¨å…¥</h2><p>å½“æˆ‘ä»¬æƒ³è¦å¯åŠ¨Angularåº”ç”¨çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦æ³¨å…¥ä¸€äº›å€¼æˆ–è€…æœåŠ¡ã€‚ åœ¨<code>bootstrapApplication</code>, æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>providers</code>æ¥æ³¨å†Œå€¼æˆ–è€…æœåŠ¡ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªè·å–å›¾ç‰‡çš„urlï¼Œéœ€è¦æ³¨å…¥åˆ°<code>PhotoService</code>ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">bootstrapApplication</span>(<span class="title class_">AppComponent</span>, &#123;</span><br><span class="line">  <span class="attr">providers</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">provide</span>: <span class="string">&#x27;photoUrl&#x27;</span>,</span><br><span class="line">      <span class="attr">useValue</span>: <span class="string">&#x27;https://picsum.photos&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;<span class="attr">provide</span>: <span class="title class_">PhotosService</span>, <span class="attr">useClass</span>: <span class="title class_">PhotosService</span> &#125;,</span><br><span class="line">    importProvidersFrom(<span class="title class_">RouterModule</span>.<span class="title function_">forRoot</span>([...<span class="variable constant_">ROUTES</span>])),</span><br><span class="line">    importProvidersFrom(<span class="title class_">HttpClientModule</span>)</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>PhotoService</code>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@<span class="title class_">Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">PhotosService</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    @Inject(<span class="string">&#x27;photoUrl&#x27;</span>) private photoUrl: string,</span></span><br><span class="line"><span class="params">    private http: HttpClient</span></span><br><span class="line"><span class="params">  </span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  public <span class="title function_">getPhotoUrl</span>(<span class="attr">i</span>: number): string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.photoUrl&#125;</span>/200/300?random=<span class="subst">$&#123;i&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><p>æœ¬æ–‡æ‰€ä½¿ç”¨çš„<a href="https://github.com/damingerdai/angular-standalone-components-app">æºä»£ç </a></p><p>çº¿ä¸Š<a href="https://damingerdai.github.io/angular-standalone-components-app/">demo</a></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://blog.angular.io/angular-v14-is-now-available-391a6db736af">Angular v14 is now available!</a></li><li><a href="https://angular.io/guide/standalone-components">Getting started with standalone components</a></li><li><a href="https://material.angular.io/">Angular Material</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> angular </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>drone + gogs + dockerå®ç°æŒç»­è‡ªåŠ¨åŒ–éƒ¨ç½²</title>
      <link href="/2022/05/15/software/install/drone-gogs-docker-devops/"/>
      <url>/2022/05/15/software/install/drone-gogs-docker-devops/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>æˆ‘ä»¬ä½¿ç”¨docker-composeæ¥å®‰è£…gogså’Œdroneã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å‡†å¤‡æ•°æ®åº“ï¼Œgogsæ”¯æŒmysqlï¼Œpostgres, sqlite, sql serverå’ŒTiDBã€‚<br>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨postgre:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:14.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./postgres:/var/lib/postgresql/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">postgres</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">ci-network:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºdockerç½‘ç»œå¹¶å¯åŠ¨æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network create ci-network (ä»…ç¬¬ä¸€æ¬¡è¿è¡Œ)</span><br><span class="line"></span><br><span class="line">docker-compose up postgres</span><br></pre></td></tr></table></figure><h2 id="Gogs"><a href="#Gogs" class="headerlink" title="Gogs"></a>Gogs</h2><p><code>Gogs</code>æ˜¯ä¸€æ¬¾ææ˜“æ­å»ºçš„è‡ªåŠ© Git æœåŠ¡, ä½¿ç”¨goå¼€å‘ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ä»»ä½•goæ”¯æŒçš„å¹³å°ä¸Šéƒ¨ç½²</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>åœ¨docker-compose.yamlä¸Šæ·»åŠ gogs</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gogs:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">gogs/gogs:0.12.6</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">&#x27;gogs&#x27;</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;10022:22&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;13000:3000&#x27;</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./gogs:/data</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">gogs/gogs</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ci-network</span></span><br></pre></td></tr></table></figure><p>gogsä½¿ç”¨22ç«¯å£æä¾›sshï¼Œ ä½¿ç”¨3000æä¾›webé¡µé¢æœåŠ¡ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ†åˆ«æ˜ å°„åˆ°æœ¬åœ°çš„10022å’Œ13000ç«¯å£</p><p>å¯åŠ¨gogsæœåŠ¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up gogs</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€<a href="http://127.0.0.1:13000/install">http://127.0.0.1:13000/install</a></p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-install-ui.png" alt="gogsçš„installé¡µé¢"></p><p>è®¾ç½®postgresqlæ•°æ®åº“ï¼Œ</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-install-ui-postgreq-settings.png" alt="gogsçš„installçš„postgreqlè®¾ç½®"></p><p>è®¾ç½®åº”ç”¨åŸºæœ¬è®¾ç½®</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-install-ui-application-settings.png" alt="gogsçš„installçš„åº”ç”¨è®¾ç½®"></p><p>è·³è¿‡é‚®ä»¶æœåŠ¡è®¾ç½®ï¼Œ å…³é—­Â·å¯ç”¨éªŒè¯ç æœåŠ¡,</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-install-ui-email-settings.png" alt="gogsçš„installçš„é‚®ä»¶è®¾ç½®"></p><p>è®¾ç½®ç®¡ç†å‘˜è´¦å·,</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-install-ui-admin-settings.png" alt="gogsçš„installçš„ç®¡ç†å‘˜è®¾ç½®"></p><p>æœ€åæˆ‘ä»¬å¯ä»¥ç‚¹å‡»å®‰è£…æŒ‰é’®äº†ï¼Œæµè§ˆå™¨å°†ä¼šè·³è½¬åˆ°<code>http://host.docker.internal:3000</code>, ä½†æ˜¯æˆ‘ä»¬å…¶å®ä¸èƒ½è®¿é—®è¿™ä¸ªé“¾æ¥ï¼Œä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œå¯ä»¥ä½¿ç”¨<a href="http://127.0.0.1:13000/">http://127.0.0.1:13000</a></p><h3 id="é…ç½®ssh"><a href="#é…ç½®ssh" class="headerlink" title="é…ç½®ssh"></a>é…ç½®ssh</h3><p>åœ¨<a href="http://127.0.0.1:13000/user/settings/ssh">http://127.0.0.1:13000/user/settings/ssh</a>é¡µé¢ä¸Šè®¾ç½®ä½ çš„SSH å¯†é’¥ï¼š</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-ssh-settings.png" alt="gogsçš„SSHå¯†é’¥é…ç½®"><br><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-ssh-settings-result.png" alt="gogsçš„SSHå¯†é’¥é…ç½®"></p><h3 id="åˆ›å»ºä»“åº“"><a href="#åˆ›å»ºä»“åº“" class="headerlink" title="åˆ›å»ºä»“åº“"></a>åˆ›å»ºä»“åº“</h3><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-create-new-repo-1.png" alt="gogsçš„åˆ›å»ºä»“åº“"><br><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-create-new-repo-2.png" alt="gogsçš„åˆ›å»ºä»“åº“"><br><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-create-new-repo-3.png" alt="gogsçš„åˆ›å»ºä»“åº“"></p><p>è¿™é‡Œæˆ‘ä½¿ç”¨æˆ‘çš„<a href="https://github.com/damingerdai/hoteler-web">hoteler-web</a>ä½œä¸ºdemoï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/damingerdai/hoteler-web.git</span><br><span class="line">git remote add gogs ssh://git@localhost:10022/daming/hoteler-web.git</span><br><span class="line">git push gogs master</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-create-new-repo-4.png" alt="gogsçš„åˆ›å»ºä»“åº“"></p><p>æ¢ä¸€ä¸ªç›®å½•, æŠŠhoteler-webæ‹‰åˆ°æœ¬åœ°ï¼Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone ssh://git@localhost:10022/daming/hoteler-web.git</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-ui-hoteler-web-clone-termial.png" alt="gogsçš„hoteler-webä»“åº“"></p><h2 id="Drone"><a href="#Drone" class="headerlink" title="Drone"></a>Drone</h2><p><code>Drone</code>æ˜¯ä¸€ä¸ªæŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜çš„å¹³å°ï¼Œå¯ä»¥ä¸Dockerå®Œç¾é›†æˆã€‚ç›¸å¯¹äº<code>Jenkins</code>æ¥è¯´æ›´åŠ è½»é‡ï¼Œå¯ä»¥é…åˆè½»é‡çš„Gogsæ¥å®ç°æŒç»­é›†æˆ</p><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">drone-server:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">drone/drone:2.11</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">drone</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">10081</span><span class="string">:80</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">9000</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./drone:/var/lib/drone/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_OPEN=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_SERVER_HOST=drone-server</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_SERVER_PROTO=http</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_LOGS_TRACE=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_LOGS_DEBUG=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_GOGS=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_GOGS_SKIP_VERIFY=false</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_GOGS_SERVER=http://host.docker.internal:13000</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_PROVIDER=gogs</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_DATABASE_DATASOURCE=/var/lib/drone/drone.sqlite</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_DATABASE_DRIVER=sqlite3</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RPC_SECRET=MWckgvhjqg4E3eQ0psgZX4iNCxoQiyU4LLvO4eXFFuHtrTkIy8vwcAc3erB5f9reM</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_SECRET=ALQU2M0KdptXUdTPKcEw</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_USER_CREATE=username:daming,admin:true</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line"><span class="attr">drone-runner-docker:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">drone/drone-runner-docker:1.8.1</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">drone-server</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./pipe/docker_engine://./pipe/docker_engine</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">13001</span><span class="string">:3000</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RPC_HOST=drone-server</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RPC_PROTO=http</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RPC_SECRET=MWckgvhjqg4E3eQ0psgZX4iNCxoQiyU4LLvO4eXFFuHtrTkIy8vwcAc3erB5f9reM</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_LOGS_TRACE=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_LOGS_DEBUG=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RUNNER_CAPCAITY=2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_RUNNER_NAME=docker-runner</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">DRONE_SECRET=ALQU2M0KdptXUdTPKcEw</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up drone-server drone-runner-docker</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<a href="http://127.0.0.1:10081/">http://127.0.0.1:10081</a>ã€‚</p><p>droneæ²¡æœ‰è‡ªå·±çš„è´¦å·ä¿¡æ¯, ç›´æ¥ä½¿ç”¨gogsçš„è´¦å·ä¿¡æ¯å°±å¥½äº†</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ui-login.png" alt="droneç™»å½•é¡µé¢"><br><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ui-register.png" alt="droneæ³¨å†Œé¡µé¢"></p><p>æ¿€æ´»<code>hoteler-web</code>ä»“åº“</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ui-hoteler-web-dashboard.png" alt="droneçš„hoteler-web"><br><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ui-hoteler-web-active-repository.png" alt="droneçš„hoteler-web"></p><p>æˆ‘ä»¬éœ€è¦è®¾ç½®<code>Project Settings</code>ä¸­å¼€å¯<em>Truste</em>é…ç½®ï¼š</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ui-hoteler-web-active-repository-trusted.png" alt="droneçš„hoteler-web"></p><h3 id="é…ç½®drone-yml"><a href="#é…ç½®drone-yml" class="headerlink" title="é…ç½®drone.yml"></a>é…ç½®drone.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">pipeline</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">hoteler-web</span></span><br><span class="line"></span><br><span class="line"><span class="attr">steps:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">node:16</span></span><br><span class="line">    <span class="attr">commands:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">yarn</span> <span class="string">install</span> <span class="string">&amp;&amp;</span> <span class="string">yarn</span> <span class="string">build</span></span><br><span class="line"><span class="attr">trigger:</span></span><br><span class="line">  <span class="attr">branch:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>å¹¶æäº¤åˆ°gogsä»“åº“é‡Œã€‚</p><h3 id="é…ç½®gogsçš„wehook"><a href="#é…ç½®gogsçš„wehook" class="headerlink" title="é…ç½®gogsçš„wehook"></a>é…ç½®gogsçš„wehook</h3><p>åœ¨æµè§ˆå™¨ä¸­è¿›å…¥<a href="http://127.0.0.1:13000/daming/hoteler-web/settings/hooks/1">http://127.0.0.1:13000/daming/hoteler-web/settings/hooks/1</a></p><p>æˆ‘ä»¬æŠŠ<code>http://drone-server/hook</code>æ”¹æˆ<code>http://host.docker.internal:10081/hook</code>, ç‚¹å‡»æ›´æ–°webé’©å­çš„æŒ‰é’®ã€‚</p><p>æœ€åæˆ‘ä»¬å¯ä»¥ç‚¹å‡»æµ‹è¯•æ¨é€çš„æŒ‰é’®ï¼š</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/gogs-web-hook-test.png" alt="droneçš„webhookæµ‹è¯•"></p><p>åœ¨droneæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/software/drone-ci-cd-result.png" alt="droneçš„webhookç»“æœ"></p><blockquote><p>ç¬¬ä¸€æ¬¡ci&#x2F;cdå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ï¼Œå¯¼è‡´å¼€å¯<code>node:16</code>é•œåƒå¤ªæ…¢äº†ï¼Œä¸Šé¢çš„æˆªå›¾å…¶å®æ˜¯ç¬¬äºŒæ¬¡çš„ç»“æœ</p></blockquote><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ol><li><p>droneæ— æ³•cloneçš„gogsçš„åœ°å€é—®é¢˜<br>åœ¨<code>gogs/gogs/conf/app.ini</code>ä¸­å°†<em>EXTERNAL_URL</em>ä¿®æ”¹ä¸º*<a href="http://host.docker.internal:13000/*%EF%BC%88%E4%BB%85%E4%BB%85%E4%BD%9C%E4%B8%BA%E6%9C%AC%E5%9C%B0%E4%BD%BF%E7%94%A8%EF%BC%89">http://host.docker.internal:13000/*ï¼ˆä»…ä»…ä½œä¸ºæœ¬åœ°ä½¿ç”¨ï¼‰</a></p></li><li><p>å®¹å™¨æ— æ³•è®¿é—®localhost<br>windowsæˆ–è€…macç”¨æˆ·å¯ä»¥ä½¿ç”¨host.docker.internalï¼Œå…¶ä»–ç³»ç»Ÿå°šæœªæµ‹è¯•è¿‡ã€‚</p></li></ol><h2 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose.yaml"></a>docker-compose.yaml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:14.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./postgres:/var/lib/postgresql/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">postgres</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line">  <span class="attr">gogs:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">gogs/gogs:0.12.6</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">&#x27;gogs&#x27;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;10022:22&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;13000:3000&#x27;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./gogs:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">gogs/gogs</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line">  <span class="attr">drone-server:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">drone/drone:2.11</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">drone</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">10081</span><span class="string">:80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9000</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./drone:/var/lib/drone/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_OPEN=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_SERVER_HOST=drone-server</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_SERVER_PROTO=http</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_LOGS_TRACE=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_LOGS_DEBUG=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_GOGS=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_GOGS_SKIP_VERIFY=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_GOGS_SERVER=http://host.docker.internal:13000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_PROVIDER=gogs</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_DATABASE_DATASOURCE=/var/lib/drone/drone.sqlite</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_DATABASE_DRIVER=sqlite3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RPC_SECRET=MWckgvhjqg4E3eQ0psgZX4iNCxoQiyU4LLvO4eXFFuHtrTkIy8vwcAc3erB5f9reM</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_SECRET=ALQU2M0KdptXUdTPKcEw</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_USER_CREATE=username:daming,admin:true</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line">  <span class="attr">drone-runner-docker:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">drone/drone-runner-docker:1.8.1</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">drone-server</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./pipe/docker_engine://./pipe/docker_engine</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">13001</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RPC_HOST=drone-server</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RPC_PROTO=http</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RPC_SECRET=MWckgvhjqg4E3eQ0psgZX4iNCxoQiyU4LLvO4eXFFuHtrTkIy8vwcAc3erB5f9reM</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_LOGS_TRACE=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_LOGS_DEBUG=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RUNNER_CAPCAITY=2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_RUNNER_NAME=docker-runner</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DRONE_SECRET=ALQU2M0KdptXUdTPKcEw</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ci-network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">ci-network:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://gogs.io/">gogså®˜ç½‘</a></li><li><a href="https://www.cnblogs.com/shanfeng1000/p/14622319.html">gogså®‰è£…ä¸è¯´æ˜(docker)</a></li><li><a href="https://zhuanlan.zhihu.com/p/108842332">Drone+Gogs+dockerå®ç°æŒç»­è‡ªåŠ¨åŒ–éƒ¨ç½²</a></li><li><a href="https://kanda.me/2019/03/06/building-ci-cd-system-by-drone/">ä½¿ç”¨droneå’Œgogsæ­å»ºè‡ªå·±çš„CI&#x2F;CDç³»ç»Ÿ</a></li><li><a href="https://zhuanlan.zhihu.com/p/81904099">Setup CI&#x2F;CD service with gogs &amp; registry &amp; drone</a></li><li><a href="https://www.cnblogs.com/manastudent/p/15938616.html">Drone æ•™ç¨‹</a></li><li><a href="https://my.oschina.net/keking/blog/3053769">è½»é‡å¿«é€Ÿçš„CIå·¥å…·Droneå¿«é€Ÿå…¥é—¨</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> drone </tag>
            
            <tag> gogs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>K3Så®‰è£…çš„æ—¶å€™é»˜è®¤ä½¿ç”¨docker</title>
      <link href="/2022/05/15/software/k8s/k3s-install-with-docker/"/>
      <url>/2022/05/15/software/k8s/k3s-install-with-docker/</url>
      
        <content type="html"><![CDATA[<h1 id="K3Så®‰è£…çš„æ—¶å€™é»˜è®¤ä½¿ç”¨docker"><a href="#K3Så®‰è£…çš„æ—¶å€™é»˜è®¤ä½¿ç”¨docker" class="headerlink" title="K3Så®‰è£…çš„æ—¶å€™é»˜è®¤ä½¿ç”¨docker"></a>K3Så®‰è£…çš„æ—¶å€™é»˜è®¤ä½¿ç”¨docker</h1><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>k8såœ¨1.20ä¹‹åå°±å¼ƒç”¨dockerçš„è¿è¡Œæ—¶äº†ï¼Œæ‰€ä»¥k3sä¹Ÿå¼€å§‹é»˜è®¤ä½¿ç”¨<a href="https://containerd.io/">containerd</a>ä½œä¸ºé»˜è®¤çš„è¿è¡Œæ—¶ã€‚<br>è¿™å¯¼è‡´ä¸€ä¸ªé—®é¢˜ã€‚é‚£å°±æ˜¯k3sæ— æ³•è®¿é—®æœ¬åœ°dockeré•œåƒã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨containerdçš„é•œåƒï¼Œè€Œä¸æ˜¯dockerã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯åœ¨å®‰è£…æ—¶å°±æŒ‡å®šk3sä½¿ç”¨dockerä½œä¸ºè¿è¡Œç¯å¢ƒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/k3s-uninstall.sh</span><br><span class="line">curl -sfL https://get.k3s.io | sh -s - server --docker</span><br></pre></td></tr></table></figure><p>å›½å†…ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åŠ é€Ÿå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn sh -s - server --docker</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> docker </tag>
            
            <tag> k3s </tag>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨github actionæ¨é€åˆ°dockerçš„é•œåƒä»“åº“</title>
      <link href="/2022/04/16/back-end/github-action-push-docker-image-to-github-packages/"/>
      <url>/2022/04/16/back-end/github-action-push-docker-image-to-github-packages/</url>
      
        <content type="html"><![CDATA[<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><p>è¯·åœ¨githubçš„<a href="https://github.com/settings/tokens">è®¾ç½®é¡µé¢</a>ä¸Šåˆ›å»ºä¸€ä¸ªtokenï¼Œå¹¶ç¡®ä¿æœ‰ä»¥ä¸‹çš„æƒé™ï¼š</p><ul><li>repo</li><li>read:packages</li><li>write:packages</li></ul><blockquote><p>è¯·ä¿å­˜å¥½è¯¥tokenï¼Œå› ä¸ºgithubå°†éšè—è¯¥å€¼</p></blockquote><p>åœ¨githubçš„ä»“åº“çš„secretsè®¾ç½®é¡µé¢(ä¾‹ï¼š<a href="https://github.com/%7Byour_username%7D/%7Byour_repository_name%7D/settings/secrets/actions)%E9%87%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAGHCR_PAT%E7%9A%84secrets">https://github.com/{your_username}/{your_repository_name}/settings/secrets/actions)é‡Œåˆ›å»ºä¸€ä¸ªåä¸ºGHCR_PATçš„secrets</a></p><p><img src="https://raw.githubusercontent.com/damingerdai/damingerdai.github.io/master/assets/back-end/github-action-push-docker-image-to-github-packages-1.png" alt="secretsè®¾ç½®é¡µé¢"></p><h1 id="åˆ›å»ºGitHub-Actionæ–‡ä»¶"><a href="#åˆ›å»ºGitHub-Actionæ–‡ä»¶" class="headerlink" title="åˆ›å»ºGitHub Actionæ–‡ä»¶"></a>åˆ›å»ºGitHub Actionæ–‡ä»¶</h1><p>åœ¨<code>.github/workflow</code>ä¸­åˆ›å»ºä¸€ä¸ª<code>build-and-publish.yml</code>:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Publish</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-push-docker-image:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Docker</span> <span class="string">image</span> <span class="string">and</span> <span class="string">push</span> <span class="string">to</span> <span class="string">repositories</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">code</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">Docker</span> <span class="string">Buildx</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">buildx</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">docker/setup-buildx-action@v1</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Login</span> <span class="string">to</span> <span class="string">Github</span> <span class="string">Packages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">docker/login-action@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">registry:</span> <span class="string">ghcr.io</span></span><br><span class="line">          <span class="attr">username:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.actor</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GHCR_PAT</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">image</span> <span class="string">and</span> <span class="string">push</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Container</span> <span class="string">Registry</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">docker/build-push-action@v2</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">docker_build</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">          <span class="attr">tags:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            # å°†usernmaeå’Œrepositoryæ”¹æˆä½ è‡ªå·±çš„githubè´¦å·å’Œä»“åº“å</span></span><br><span class="line"><span class="string">            ghcr.io/&#123;usernmae&#125;/&#123;repository&#125;:$&#123;&#123; github.sha &#125;&#125;</span></span><br><span class="line"><span class="string">            # å½“ä¸”åªæœ‰è¿è¡Œåœ¨masteråˆ†æ”¯æ—¶æ‰éœ€è¦æ¨é€åˆ°githubå®¹å™¨ä»“åº“</span></span><br><span class="line"><span class="string"></span>          <span class="attr">push:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/master&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Image</span> <span class="string">digest</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">echo</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.docker_build.outputs.digest</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤æ¨é€çš„é•œåƒæ˜¯ç§æœ‰ï¼Œæƒ³è¦å…¬å¼€ï¼Œå¯ä»¥åœ¨<br><code>https://github.com/users/&#123;your_username&#125;/packages/container/&#123;your_repository_name&#125;/settings</code>ä¸‹é¢çš„Danger Zoneä¸­çš„Change package visibilityè®¾ç½®æˆ<em>public</em>è¿˜æ˜¯<em>private</em>ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://event-driven.io/en/how_to_buid_and_push_docker_image_with_github_actions/">How to build and push Docker image with GitHub actions?</a></li><li><a href="https://github.com/damingerdai/hoteler/blob/master/.github/workflows/build-and-publish.yml">Hoteler</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> github action </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼</title>
      <link href="/2022/03/23/back-end/two-easy-ways-to-use-local-docker-images-in-minikube/"/>
      <url>/2022/03/23/back-end/two-easy-ways-to-use-local-docker-images-in-minikube/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼"><a href="#ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼" class="headerlink" title="ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼"></a>ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡å°†åˆ†äº«ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼</p><p><img src="https://miro.medium.com/max/1400/1*Q8RckeLvx7rVFNPTHzx21A.png" alt="Kubernetes"></p><h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><ul><li>å®‰è£…å¹¶è¿è¡Œ<a href="https://www.docker.com/get-started">Docker</a></li><li>å®‰è£…å¹¶è¿è¡Œ<a href="https://minikube.sigs.k8s.io/docs/start/">Minikube</a></li><li><a href="https://kubernetes.io/docs/tasks/tools/">å®‰è£…kubectl</a></li></ul><h2 id="ä½ å°†å­¦åˆ°çš„çŸ¥è¯†"><a href="#ä½ å°†å­¦åˆ°çš„çŸ¥è¯†" class="headerlink" title="ä½ å°†å­¦åˆ°çš„çŸ¥è¯†"></a>ä½ å°†å­¦åˆ°çš„çŸ¥è¯†</h2><p>æœ¬æ–‡å°†æ•™ä¼šå¤§å®¶å¦‚ä½•åœ¨Minikubeä¸­ä½¿ç”¨æœ¬åœ°çš„Dockeré•œåƒã€‚å› ä¸ºKubernetesé»˜è®¤ä»æ³¨å†Œè¡¨ä¸­æå–é•œåƒï¼Œæ‰€ä»¥Kubernetesä¸€èˆ¬æ˜¯ä¸ä¼šä½¿ç”¨æœ¬åœ°é•œåƒï¼Œå¹¶ä¸”åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¹Ÿä¸åº”è¯¥ä½¿ç”¨æœ¬åœ°é•œåƒã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„ä½¿ç”¨æœ¬åœ°é•œåƒï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½éœ€è¦å°†è¿™äº›é•œåƒæ¨é€åˆ°è¿œç¨‹çš„æ³¨å†Œè¡¨ã€ç™»å½•è¿œç¨‹æ³¨å†Œè¡¨å¹¶åœ¨æœ¬åœ°ç”µè„‘ä¸­é‡æ–°æ‹‰å–ï¼Œé‚£ä¹ˆä½¿ç”¨æœ¬åœ°é•œåƒå°†ååˆ†ä¾¿åˆ©ã€‚</p><p>å’Œå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘åœ¨githubä¸­å‡†å¤‡äº†ä¸€ä¸ª<a href="https://github.com/Abszissex/medium-local-docker-image-minikube">ä»“åº“</a>, æ–¹ä¾¿å¤§å®¶æŸ¥çœ‹å®Œæˆçš„ä»£ç åº“ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ç…§æœ¬æ–‡æè¿°çš„æ­¥éª¤è¿›è¡Œæ“ä½œã€‚</p><h2 id="Demoä»‹ç»"><a href="#Demoä»‹ç»" class="headerlink" title="Demoä»‹ç»"></a>Demoä»‹ç»</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/</span><br><span class="line">|- app/</span><br><span class="line">  |- Dockerfile</span><br><span class="line">  |- index.js</span><br><span class="line">  |- package.json</span><br><span class="line">|- deployment.yaml</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„æ–‡ä»¶å¤¹ç»“æ„ä¸­ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»å°†åœ¨æœ¬æ–‡ä¸­ä½¿ç”¨çš„é‡ç‚¹æ–‡ä»¶ï¼š</p><ul><li><p><strong>app&#x2F;Dockerfile</strong> ç”¨äºæ„å»ºåŒ…å«ä¸€ä¸ªNode.js Web æœåŠ¡å™¨çš„æœ¬åœ°Dockeré•œåƒçš„Dockerfileï¼Œæˆ‘ä»¬å°†å…¶éƒ¨ç½²åˆ°Minikube</p></li><li><p><strong>app&#x2F;index.js</strong> Node.js Web æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºä»£ç </p></li><li><p><em><strong>app&#x2F;package.json</strong> æˆ‘ä»¬Node.js Web æœåŠ¡å™¨çš„ä¾èµ–ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œåªä½¿ç”¨äº†</em>*express**ï¼Œä¸€ä¸ªç”¨äºæ­å»ºWebæœåŠ¡å™¨çš„Nodejsåº“</p></li><li><p><strong>deployment.yaml</strong> åœ¨Kubernetesä¸­è¿è¡ŒNode.js Web æœåŠ¡å™¨çš„Deploymenté…ç½®</p></li></ul><p><strong>app</strong>æ–‡ä»¶å¤¹ä¸­çš„å®é™…å†…å®¹å’Œæœ¬æ–‡æ— å…³ã€‚ æˆ‘ä»…ä»…æ˜¯æä¾›ä¸€ä¸ªdemoæ–¹ä¾¿æ¥ä¸‹æ¥çš„æ•™ç¨‹è®²è§£ï¼Œå½“ç„¶ä½¿ç”¨ä½ è‡ªå·±çš„demoä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å¦‚æœä½ æƒ³è¦ä½¿ç”¨<strong>app</strong>è¿™ä¸ªåº”ç”¨ï¼Œè¯·æ³¨æ„æœåŠ¡å™¨å°†åœ¨å®¹å™¨å†…éƒ¨ä¸­ç›‘å¬8080ç«¯å£ã€‚</p><h2 id="Deploymenté…ç½®"><a href="#Deploymenté…ç½®" class="headerlink" title="Deploymenté…ç½®"></a>Deploymenté…ç½®</h2><p><strong>deployment.yaml</strong>çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: myapp</span><br><span class="line">  labels:</span><br><span class="line">    name: myapp</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      name: myapp</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        name: myapp</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: myapp</span><br><span class="line">          image: pz/demo</span><br><span class="line">          imagePullPolicy: Never</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8080</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯<strong>imagePullPolicy</strong>å’Œ<strong>containerPort</strong>è¿™ä¸¤ä¸ªé…ç½®</p><p>é€šè¿‡<strong>containerPort</strong>ï¼Œæˆ‘ä»¬å°†æš´éœ²appæ­£åœ¨ç›‘å¬çš„<em>8080</em>ç«¯å£ï¼Œå› æ­¤æˆ‘ä»¬ç¨åå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®<em><a href="http://127.0.0.1:8080/">http://127.0.0.1:8080</a></em>å»éªŒè¯æ˜¯å¦æ»¡è¶³æˆ‘ä»¬é¢„æœŸé‚£æ ·å·¥ä½œã€‚</p><p>æ›´å…³é”®çš„æ˜¯<strong>imagePullPolicy</strong>ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨æœ¬åœ°Dockeré•œåƒï¼Œ<strong>imagePullPolicy</strong>éœ€è¦è®¾ç½®æˆ<strong>Never</strong>, å¦åˆ™ï¼Œ Kuberneteså°†åœ¨æ³¨å†Œè¡¨ä¸­æ ¹æ®ä½ æä¾›çš„åå­—æ¥æœç´ åŒåé•œåƒã€‚</p><h2 id="æ„å»ºDcokeré•œåƒ"><a href="#æ„å»ºDcokeré•œåƒ" class="headerlink" title="æ„å»ºDcokeré•œåƒ"></a>æ„å»ºDcokeré•œåƒ</h2><p>ä¸ºäº†éªŒè¯Dockeré•œåƒèƒ½å¤ŸæŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸåœ¨Kubernetesä¸­è¿è¡Œï¼Œè®©æˆ‘ä»¬æ¥æ„å»ºå¹¶è¿è¡Œã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼èˆªè¿›å…¥<strong>app</strong>ç›®å½•ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡<strong>docker build -t pz&#x2F;demo .<strong>æ„å»ºDockeré•œåƒï¼Œé€šè¿‡</strong>-t</strong>å‚æ•°å°†é•œåƒåå­—è®¾ç½®ä¸º<strong>pz&#x2F;demo</strong>ã€‚</p><p><img src="https://miro.medium.com/max/1400/1*Q-XZFc-_TRrTfwS_-DtHQw.png" alt="docker images"></p><p>å½“æ„å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>docker run -it â€“rm -p 8080:8080 pz&#x2F;demo</strong>å‘½ä»¤æ¥è¿è¡Œå®¹å™¨ï¼Œå¹¶å°†Dockerçš„8080ç«¯å£æ˜ å°„çš„æœ¬åœ°çš„8080ç«¯å£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®<a href="http://localhost:8080/">localhost:8080</a>ã€‚ å¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°*â€Hello World!â€*ï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘ä»¬çš„å®¹å™¨è¿è¡Œæ­£å¸¸ã€‚</p><p><img src="https://miro.medium.com/max/1224/1*BrzMRioHmZEaR1km1C0EWA.png" alt="localhost:8080"></p><h2 id="åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒ"><a href="#åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒ" class="headerlink" title="åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒ"></a>åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒ</h2><p>å¦‚æœä½ æƒ³é€šè¿‡<strong>kubectl apply -f deployment.yaml</strong>å‘½ä»¤éƒ¨ç½²ä¸Šé¢çš„<strong>deployment.yaml</strong>åˆ°ä½ çš„Minikubeä¸­ï¼Œé‚£å¯åŠ¨çš„Podå°†æ‰¾ä¸åˆ°ä½ åˆšåˆšæ„å»ºçš„Dockeré•œåƒã€‚</p><p>ä½ å¯ä»¥é€šè¿‡<strong>kubectl logs deployment.apps&#x2F;myapp</strong>å‘½ä»¤æ¥æ£€æŸ¥æ—¥å¿—å»æ¥éªŒè¯è¿™ä¸ªé”™è¯¯çš„ç»“æœã€‚</p><p><img src="https://miro.medium.com/max/1400/1*qGB6vXA3rpRnubXQ9Qf3oQ.png" alt="kubectl logs deployment.apps/myapp"></p><p>ä¸Šé¢çš„æ—¥å¿—æ˜¾ç¤ºç”±äºKubernetesæ‹‰å–ä¸åˆ°é•œåƒPodä¸€ç›´ç­‰å¾…é‡å¯ã€‚è¿™å…¶å®æ˜¯å› ä¸ºMinikubeæ²¡æœ‰æ–¹æ³•è·å–ä½ æœ¬åœ°Dockeré•œåƒã€‚</p><p>ä½†æ˜¯å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸¤ä¸ªç®€å•çš„å‘½ä»¤å¯ä»¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨<strong>image load</strong>å‘½ä»¤ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ååˆ©å°†æœ¬åœ°Dockeré•œåƒä»æœ¬åœ°ç”µè„‘ä¸­å¯¼å…¥Minikubeä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">General</span></span><br><span class="line">minikube image load &lt;IMAGE_NAME&gt;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Example</span></span><br><span class="line">minikube image load pz/demo</span><br></pre></td></tr></table></figure><p>åœ¨å¯¼å…¥å®Œæˆä¹‹åï¼Œä½ å¯ä»¥é‡å¯podã€‚ç„¶åä½ å¯ä»¥å‘ç°podå¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</p><p>å…¶å®æˆ‘ä»¬è¿˜å¯ä»¥å˜å¾—æ›´ç®€å•ã€‚ä»¥å‰çš„æ–¹æ³•æ˜¯ä½ éœ€å‘€å…ˆåœ¨æœ¬åœ°æ„å»ºDockeré•œåƒï¼Œç„¶åå°†å…¶ç§»åŠ¨åˆ°Minikubeå®¹å™¨ä¸­ï¼Œè™½ç„¶è€—æ—¶ä¸å¤šï¼Œä½†æ˜¯ç»ˆç©¶è¿˜æ˜¯æµªè´¹äº†ä¸å°‘æ—¶é—´ã€‚</p><p>é€šè¿‡ä½¿ç”¨Minikubeçš„<strong>image build</strong>ï¼Œ æˆ‘ä»¬å¯ä»¥åœ¨Minikubeä¸­ç›´æ¥æ„å»ºé•œåƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">General</span></span><br><span class="line">minikube image build -t &lt;IMAGE_NAME&gt; .</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Example</span></span><br><span class="line">minikube image build -t pz/demo .</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<strong>minikube image build</strong>æ„å»ºå‡ºæ¥çš„é•œåƒå¯ä»¥åœ¨Minikkubeä¸­ç›´æ¥è®¿é—®ï¼ŒåŒæ—¶ä¹Ÿä¸å†éœ€è¦åœ¨<strong>minikube image load</strong>ä¸­çš„ç¬¬äºŒæ­¥å¯¼å…¥æ­¥éª¤ã€‚</p><p>ä½¿ç”¨ä»¥ä¸Šä¸¤ç§ä¹‹ä¸€çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ£€æŸ¥ä¸€ä¸‹Deploymentçš„æ—¥å¿—ï¼š</p><p><img src="https://miro.medium.com/max/1400/1*-yXXk7reYwXm_w3folq6kQ.png" alt="kubectl logs deployment.apps/myapp"></p><p>ä¸ºäº†è¿›ä¸€æ­¥éªŒè¯ä¸€åˆ‡æ˜¯å¦æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å°†æœ¬åœ°8080ç«¯å£è½¬å‘å‘Deploymentçš„8080ç«¯å£ä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward deployment/myapp 8080:8080</span><br></pre></td></tr></table></figure><p>é‡æ–°æ£€æŸ¥æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ¬åœ°æ„å»ºçš„åº”ç”¨åœ¨Minikubeä¸­è¿è¡Œæ­£å¸¸ï¼ŒğŸ‰ğŸ‰ğŸ‰</p><p><img src="https://miro.medium.com/max/1224/1*BrzMRioHmZEaR1km1C0EWA.png" alt="localhost:8080"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡æœ¬æ–‡ï¼Œä½ åº”è¯¥èƒ½å¤Ÿä½¿ç”¨<strong>minikube image load</strong>å’Œ<strong>minikube image buildcommand</strong>å‘½ä»¤åœ¨Minikubeä¸­ä½¿ç”¨æœ¬åœ°é•œåƒäº†.</p><p>æ›´å¤šä¿¡æ¯è¯·å…³æ³¨<a href="https://www.linkedin.com/in/pascal-zwikirsch-3a95a1177/">LinkedIn</a></p><h2 id="åè¨€"><a href="#åè¨€" class="headerlink" title="åè¨€"></a>åè¨€</h2><p>åŸæ–‡ï¼š<a href="https://medium.com/gitconnected/two-easy-ways-to-use-local-docker-images-in-minikube-cd4dcb1a5379">Two easy ways to use local Docker images in Minikube</a></p><p>è¯‘æ–‡ï¼š <a href="https://damingerdai.github.io/back-end/two-easy-ways-to-use-local-docker-images-in-minikube/">ä¸¤ç§åœ¨Minikubeä¸­è¿è¡Œæœ¬åœ°Dockeré•œåƒçš„ç®€å•æ–¹å¼</a></p><p>è¯‘è€…ï¼š<a href="https://damingerdai.github.io/">å¤§æ˜äºŒä»£</a></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> docker </tag>
            
            <tag> minikube </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macç‰ˆminikubeå®‰è£…ç¬”è®°</title>
      <link href="/2022/01/17/software/k8s/how-to-install-minkube-on-mac/"/>
      <url>/2022/01/17/software/k8s/how-to-install-minkube-on-mac/</url>
      
        <content type="html"><![CDATA[<h1 id="Macç‰ˆminikubeå®‰è£…ç¬”è®°"><a href="#Macç‰ˆminikubeå®‰è£…ç¬”è®°" class="headerlink" title="Macç‰ˆminikubeå®‰è£…ç¬”è®°"></a>Macç‰ˆminikubeå®‰è£…ç¬”è®°</h1><p><a href="https://minikube.sigs.k8s.io/docs/start/">minikube</a>æ˜¯ä¸€ä¸ªä¸“æ³¨äºè®©Kubernetesæ›´åŠ å®¹æ˜“å­¦ä¹ å’Œå¼€å‘çš„æœ¬åœ°Kubernetesã€‚<br>åªéœ€è¦<a href="https://www.docker.com/">Docker</a>æˆ–è€…è™šæ‹Ÿæœºç¯å¢ƒï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡<code>minikube start</code>å°±èƒ½å¿«é€Ÿå¯åŠ¨Kubernetesã€‚</p><h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><p>å®‰è£…minikubeéœ€è¦ä»¥ä¸‹è¦æ±‚ï¼š</p><ol><li>è‡³å°‘ä¸¤ä¸ªCPU</li><li>è‡³å°‘2GBå†…å®¹</li><li>è‡³å°‘20GBçš„ç¡¬ç›˜ç©ºé—´</li><li>å®¹å™¨æˆ–è€…è™šæ‹Ÿæœºï¼Œ æ¯”å¦‚<a href="https://www.docker.com/">Docker</a>, <a href="https://github.com/moby/hyperkit">Hyperkit</a>, <a href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/hyper-v-technology-overview">Hyper-V</a>, <a href="https://www.linux-kvm.org/page/Main_Page">KVM</a>, <a href="https://www.parallels.com/">Parallels</a>, <a href="https://podman.io/">Podman</a>, <a href="https://www.virtualbox.org/">VirtualBox</a>, or <a href="https://www.vmware.com/asean/products/fusion.html">VMware Fusion&#x2F;Workstation</a></li></ol><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é’ˆå¯¹macosçš„x86-64çš„å¹³å°çš„ï¼Œå¯ä»¥ä½¿ç”¨homebrewè¿›è¡Œå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install minikube</span><br></pre></td></tr></table></figure><p>å¦‚æœå€¾å‘äºäºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64</span><br><span class="line">sudo install minikube-darwin-amd64 /usr/local/bin/minikube</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯å…¶ä»–å¹³å°çš„æ“ä½œç³»ç»Ÿï¼Œè¯·çœ‹<a href="https://minikube.sigs.k8s.io/docs/start/">minikubeçš„å®˜ç½‘æ•™ç¨‹</a></p><h2 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p>ç®€å•æ¥è¯´ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>minikube start</code>å¯ä»¥ç›´æ¥å¯åŠ¨äº†ï¼Œä½†æ˜¯åœ¨å›½å†…ç”¨äºç‰¹æ®Šçš„ç½‘ç»œé™åˆ¶ï¼Œè¯·ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minikube start --registry-mirror=https://registry.docker-cn.com  --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers</span><br></pre></td></tr></table></figure><h3 id="é©±åŠ¨ï¼ˆDriversï¼‰"><a href="#é©±åŠ¨ï¼ˆDriversï¼‰" class="headerlink" title="é©±åŠ¨ï¼ˆDriversï¼‰"></a>é©±åŠ¨ï¼ˆDriversï¼‰</h3><p>é€šè¿‡é©±åŠ¨ï¼Œminikubeå¯ä»¥æ”¯æŒä¸åŒçš„å®¹å™¨å’Œè™šæ‹Ÿæœºã€‚</p><p>é’ˆå¯¹macosæ¥è¯´ï¼Œæ¨èä½¿ç”¨dockerå’Œhyperkitï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šé¢çš„å‘½ä»¤çš„åŸºç¡€ä¸Šæ·»åŠ <code>--vm-driver=docker</code>æˆ–è€…<code>--vm-driver=hyperkit</code>ã€‚</p><p>å…¶ä»–å¹³å°å¯ä»¥è®¿é—®<a href="https://minikube.sigs.k8s.io/docs/drivers/">Drivers</a>ã€‚</p><h2 id="kubectl"><a href="#kubectl" class="headerlink" title="kubectl"></a>kubectl</h2><p><a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a>æ˜¯Kubernetesçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿ç”¨æˆ·é€šè¿‡ä¸€äº›ç®€å•çš„å‘½ä»¤å»ç®¡ç†Kubernetesã€‚</p><p>å¦‚æœäº‹å…ˆå®‰è£…äº†<a href="https://desktop.docker.com/mac/stable/Docker.dmg">docker desktop</a>, é‚£ä¹ˆ<code>kubectl</code>å·²ç»å®‰è£…å¥½äº†ï¼Œ<br>å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œé‚£å¯ä»¥ä½¿ç”¨homebrewå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install kubectl </span><br></pre></td></tr></table></figure><p>å…¶ä»–å¹³å°å¯ä»¥è®¿é—®<a href="https://kubernetes.io/docs/tasks/tools/#kubectl">kubectl</a></p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>æ–°å»ºç»ˆç«¯ï¼Œè¾“å…¥<code>kubectl get po -A</code>,æ˜¾ç¤ºä»¥ä¸‹ç±»ä¼¼å‘½ä»¤å°±ç®—å¯åŠ¨æˆåŠŸäº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NAMESPACE     NAME                               READY   STATUS    RESTARTS   AGE</span><br><span class="line">kube-system   coredns-7d89d9b6b8-d462h           0/1     Running   0          20s</span><br><span class="line">kube-system   etcd-minikube                      1/1     Running   0          32s</span><br><span class="line">kube-system   kube-apiserver-minikube            1/1     Running   0          35s</span><br><span class="line">kube-system   kube-controller-manager-minikube   1/1     Running   0          32s</span><br><span class="line">kube-system   kube-proxy-gcbpj                   1/1     Running   0          20s</span><br><span class="line">kube-system   kube-scheduler-minikube            1/1     Running   0          31s</span><br><span class="line">kube-system   storage-provisioner                1/1     Running   0          30s</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>ä»¥ä¸‹æ˜¯æœ¬æ–‡æ’°å†™è¿‡ç¨‹ä¸­çš„å‚è€ƒèµ„æ–™ï¼š</p><ol><li><a href="https://minikube.sigs.k8s.io/docs/start/">minikube start</a></li><li><a href="https://kubernetes.io/docs/tasks/tools/#kubectl">kubectl</a></li><li><a href="https://damingerdai.github.io/software/k8s/how-to-install-minkube/">Minkubeå®‰è£…ç¬”è®°</a></li><li><a href="https://developer.aliyun.com/article/221687">Minikube - Kubernetesæœ¬åœ°å®éªŒç¯å¢ƒ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> minikube </tag>
            
            <tag> kubernetes </tag>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022å¹´åº¦æ€»ç»“</title>
      <link href="/2021/12/31/summary/2022/"/>
      <url>/2021/12/31/summary/2022/</url>
      
        <content type="html"><![CDATA[<h1 id="2022å¹´åº¦æ€»ç»“"><a href="#2022å¹´åº¦æ€»ç»“" class="headerlink" title="2022å¹´åº¦æ€»ç»“"></a>2022å¹´åº¦æ€»ç»“</h1><p>2022å¹´çœŸçš„æ˜¯ä¸€ä¸ªè®©äººéš¾ä»¥å¿˜æ€€çš„å¹´ä»½ï¼Œå°¤å…¶åœ¨å…ˆåç»å†äº†ä¸Šæµ·å°åŸã€è€ä¸ˆäººå»ä¸–ã€é¢†è¯ç»“å©šã€‚</p><h2 id="ç–«æƒ…"><a href="#ç–«æƒ…" class="headerlink" title="ç–«æƒ…"></a>ç–«æƒ…</h2><p>è¿˜è®°å¾—2020å¹´ç–«æƒ…åˆšå¼€å§‹çš„æ—¶å€™ï¼Œé‚£æ—¶ä¾¯è‡ªå·±ä¸€ä¸ªäººå¼€è½¦å›ä¸Šæµ·ï¼Œè·¯ä¸Šçš„è½¦è¾†éå¸¸å°‘ï¼Œå¼€è½¦çš„æ„Ÿè§‰çœŸçš„å¯ä»¥è¯´éå¸¸çˆ½ï¼Œå®Œå…¨å¯ä»¥é—­ç€çœ¼å¼€è½¦ï¼Œåæ­£çœ‹ä¸åˆ°è½¦ï¼Œå³ä½¿è¿›äº†ä¸Šæµ·å¸‚åŒºã€‚é‚£ä¸ªæ—¶å€™å•çº¯çš„æƒ³ï¼Œå°‘åˆ™ä¸‰ä¸ªæœˆï¼Œå¤šåˆ™åŠå¹´ï¼Œç–«æƒ…å°±ä¼šè‡ªç„¶è€Œç„¶çš„è¿‡å»ï¼Œåˆ°æ—¶å€™æˆ‘ä»¬è¯¥åƒåƒè¯¥å–å–ã€‚è™½ç„¶è¿™ä¸ªåˆ¤æ–­ç¿»è½¦äº†ï¼Œä½†æ˜¯2021å¹´ä¹Ÿæ˜¯å¯¹å›½å†…ç–«æƒ…è¿˜æ˜¯æ¯”è¾ƒä¹è§‚ã€‚ä½†æ˜¯2022å¹´çš„ä¸Šæµ·å°åŸæ‰“ç ´äº†æˆ‘æ‰€æœ‰çš„å¹»æƒ³ã€‚æˆ‘ä»æ¥æ²¡æƒ³è¿‡ä¸Šæµ·å±…ç„¶ç©ç ¸äº†â€œåŠ¨æ€æ¸…ç†â€ï¼Œä»åäº­å®¾é¦†å¼€å§‹ï¼Œä¸Šæµ·çš„ç–«æƒ…æŒç»­ä¸æ–­ï¼Œæ„ŸæŸ“äººæ•°æ­»æ´»éƒ½ä¸‹ä¸å»ã€‚</p><p>3æœˆä»½æˆ‘åˆšæ¬åˆ°å—ç¿”å°±è¢«å°æ§äº†ï¼Œä½†æ˜¯æˆ‘åˆšå¼€å§‹è¿˜å¥½ï¼Œè™½ç„¶ä»€ä¹ˆåƒçš„éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯åªè¦å°æ§æ—¶é—´åˆ°äº†å°±èƒ½å‡ºå»ä¹°ç‚¹ä¸œè¥¿ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œä»4æœˆä»½å¼€å§‹ï¼Œä¸Šæµ·å¼€å§‹é™é»˜äº†ï¼Œæˆ‘è¶³è¶³å°åœ¨å®¶é‡Œå·®ä¸å¤šä¸¤ä¸ªæœˆã€‚æˆ‘æœ¬æ¥æ˜¯ä¸åå¯¹å°åŸçš„ï¼Œä½†æ˜¯ä¸Šæµ·å¸‚æ”¿åºœçœŸçš„å¾ˆè®©äººå¤±æœ›ï¼Œç–«æƒ…ä¸¤å¹´äº†ï¼Œå¸‚æ”¿åºœä¼¼ä¹æ²¡æœ‰åšå¥½ä»»ä½•ç›¸å…³å°åŸçš„é¢„æ¡ˆã€‚è€Œä¸”æ€»æ„Ÿè§‰å¯èƒ½æ¶‰åŠåˆ°äºŒåå¤§çš„é«˜å±‚å®‰æ’ï¼Œå¸‚æ”¿åºœå†³ç­–å±‚åº”è¯¥æ˜¯å­˜åœ¨åˆ†æ­§çš„ï¼Œå¹¶ä¸”å’ŒåŒ»ç–—ç³»ç»Ÿçš„äººä¹Ÿå­˜åœ¨ä¸€å®šçš„éš”é˜‚ã€‚ç”±äºä¸Šå±‚çš„é—®é¢˜ï¼ŒåŸºå±‚æœºæ„å‡ºç°å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„äº‹å„¿é‚£ä¹Ÿèƒ½ç†è§£äº†ã€‚</p><p>åœ¨ç»è¿‡äº†ç™½çº¸è¿åŠ¨ä¹‹åï¼Œæˆ‘ä»¬çš„é˜²ç–«æ”¿ç­–ä»ä¸€ä¸ªæç«¯èµ°å‘å¦å¤–ä¸€ä¸ªæç«¯ã€‚æˆ‘ä»¬å½»åº•æ”¾å¼€äº†ï¼Œè®©80%ä»¥ä¸Šçš„äººæ„ŸæŸ“äº†ä¸€éã€‚æˆ‘ä¸æ˜¯åå¯¹æ”¾å¼€ï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒåå¯¹å¦‚æ­¤æ¯«æ— å¾å…†çš„æ”¾å¼€ï¼Œæ²¡æœ‰å‡†å¤‡å¥½å„ç§çš„é€€çƒ§è¯ï¼Œæ²¡æœ‰å‡†å¤‡å¥½å£ç½©ã€‚</p><h2 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h2><p>ä»Šå¹´ç»§ç»­åšä¸€ä¸ª<code>web2.5</code>çš„é¡¹ç›®ï¼Œå°±æ˜¯<code>web2.0</code> + <code>åŒºå—é“¾</code>ï¼Œä¸èƒ½ç®—å¾—ä¸Šæ­£å®—çš„<code>web3.0</code>ã€‚å…¶æ ¸å¿ƒå°±æ˜¯å°†éƒ¨åˆ†åŸæ¥æ”¾åœ¨æ•°æ®åº“çš„æ•°æ®æ”¾åœ¨åŒºå—é“¾é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è‡ªç§°ä¸º<code>web2.5</code>ã€‚</p><p>ç›®å‰éƒ¨é—¨æƒ³å…¨åŠ›æŠ¼å®Â·web3Â·ï¼Œå¸Œæœ›èƒ½å’Œå®¡è®¡éƒ¨é—¨èƒ½å¤Ÿåšå¥½æŠ€æœ¯æœåŠ¡ï¼Œæ‰€ä»¥æœªæ¥å¯¹åŒºå—é“¾çš„ç ”ç©¶å¤§æ¦‚ç‡æ˜¯ä¼šé›†ä¸­ä¸­<code>DeFi(å»ä¸­å¿ƒåŒ–é‡‘è)</code>ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œé‡‘èæ˜¯ä¸€ä¸ªæ¯«æ— å¤´ç»ªçš„ä¸œè¥¿ï¼Œä¹‹å‰å¹¶æ²¡æœ‰æ¥è§¦è¿‡ï¼Œæ²¡æœ‰ä¸€ä¸ªè‰¯å¥½çš„ä¸šåŠ¡åœºæ™¯å¯ä»¥è®©æˆ‘ç ”ç©¶ï¼Œå¯¼è‡´å¯¹æˆ‘æ¥è¯´<code>DeFi</code>å¯èƒ½åªæ˜¯ä¸€ä¸ªæ¯”è¾ƒç©ºæ³›çš„åè¯ã€‚</p><p>è¿‡å»çš„ä¸€å¹´ï¼Œå¯¹ä»¥å¤ªåŠè¿˜æ˜¯æ¯”è¾ƒæµ…æ˜¾çš„ï¼ŒåŒæ—¶å°†ä¹Ÿåšäº†ä¸€äº›ç®€å•çš„demoã€‚æ€»çš„æ¥è¯´ï¼Œä¹Ÿç®—ç®€å•çš„å…¥é—¨å­¦äº†ç‚¹çš®æ¯›ï¼Œä½†æ˜¯å¯¹æ™ºèƒ½åˆçº¦çš„å¼€å‘è¿˜æ˜¯åŸºæœ¬ä¸Šä¸€çªä¸é€šçš„ã€‚å¸Œæœ›æ¥ä¸‹æ¥çš„ä¸€å¹´å¯ä»¥æ·±å…¥ç ”ç©¶æ™ºèƒ½åˆçº¦ï¼Œå¯ä»¥ç‹¬ç«‹å¼€å‘æ™ºèƒ½åˆçº¦å¹¶éƒ¨ç½²åˆ°ä¸€ä¸ªæµ‹è¯•ç½‘ç»œã€‚solanaä¹Ÿä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å…³æ³¨æ–¹å‘ï¼Œä½†æ˜¯è€ƒè™‘åˆ°solanaçš„ä¸œå®¶å‡ºç‚¹äº‹å„¿ï¼Œå¯èƒ½ä¸å¤ªä¼šé‡å¿ƒåœ¨è¿™ä¸ªæ–¹é¢ï¼Œä¸è¿‡rustè¯­è¨€è¿˜æ˜¯ä¼šå°½é‡æ·±æŒ–ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æŒ‘æˆ˜æ€§çš„æ–¹å‘</p><p>ä»Šå¹´åº”è¯¥å¾ˆå°‘å†™angularäº†ï¼Œæ›´å¤šå¼€å§‹å†™reactã€‚ä»æˆ‘ä¸ªäººçš„è§’åº¦æ¥è¯´ï¼Œjsxå’Œreact hookå¯¹å†™ä¸€äº›ç»„ä»¶æ¥è¯´ç¡®å®æ˜¯ä¸€æŠŠåˆ©å™¨ï¼Œä½†æ˜¯å¯¹äºå¦‚ä½•åšå¥½ä¸€ä¸ªå®Œæ•´çš„ã€å¼ºå¤§çš„å‰ç«¯webåº”ç”¨æ¥è¯´ï¼Œreactçš„ç”Ÿæ€æ˜¯ä¸è¶³çš„ï¼Œå¤ªç¢è£‚äº†ï¼Œå¯¼è‡´åœ¨æ¥æ‰‹ä¸åŒçš„é¡¹ç›®çš„æ—¶å€™æ€»æ˜¯èƒ½çœ‹åˆ°ä¸åŒçš„reactå†™æ³•å’Œå·¥ç¨‹ç»„ç»‡å½¢å¼ã€‚æœ€è¿‘åœ¨<a href="https://github.com/adcentury/react-mobile-picker">react-mobile-picker</a>åšä¸€ä¸ª<a href="https://github.com/damingerdai/react-mobile-picker">é‡æ„</a>ã€‚ä¸€ä¸ªæ–¹é¢æ˜¯æƒ³æ”¹æˆé€šç”¨çš„monorepoçš„ç»„ç»‡å½¢å¼ï¼Œå¦å¤–ä¸€ä¸ªæ–¹é¢æ˜¯éœ€è¦å‡çº§æ ¸å¿ƒä¾èµ–å¹¶ä½¿ç”¨typescripté‡å†™ã€‚ç›®å‰è¿™ä¸ªå·¥ä½œè¿˜åœ¨åŠªåŠ›ä¸­ã€‚ angularæ–¹é¢æ›´å¤šçš„ä¸“æ³¨äº<a href="https://github.com/damingerdai/ngx-dom-confetti">ngx-dom-confetti</a>, ç›®å‰ä»…ä»…æ˜¯å¯¹<a href="https://www.npmjs.com/package/dom-confetti">dom-confetti</a>çš„angularå°è£…ï¼Œå°†æ¥çš„è®¡åˆ’æ˜¯å‚è€ƒ<a href="https://github.com/angular/components/tree/main/src/material/core/ripple">ripple</a>çš„ä»£ç è®¾è®¡ï¼Œå°†æ¥å¯ä»¥å¥½å¥½çš„é‡æ„è¿™ä¸ªé¡¹ç›®ã€‚<a href="https://github.com/damingerdai/hoteler-web">hoteler-web</a>æ˜¯æˆ‘ä¸€ç›´ä¼šç»´æŠ¤çš„angularçš„é¡¹ç›®ã€‚</p><p>ä»Šå¤©åœ¨<a href="https://domains.google/">google domains</a>ä¹°äº†ä¸ªåŸŸåï¼Œç„¶åå°è¯•ä½¿ç”¨k3sçš„ingresséƒ¨ç½²äº†[<a href="https://hoteler.damingerdai.com/]%E3%80%82%E6%84%9F%E8%A7%89%E4%BD%BF%E7%94%A8k3s%E9%83%A8%E7%BD%B2%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%9A%84%E5%BA%94%E7%94%A8%E5%9F%BA%E6%9C%AC%E4%B8%8A%E9%97%AE%E9%A2%98%E4%B8%8D%E5%A4%A7%E4%BA%86%E3%80%82[hoteler](https://github.com/damingerdai/hoteler)%E5%B7%B2%E7%BB%8F%E6%98%AF%E4%B8%80%E4%B8%AA%E5%BE%88%E7%A8%B3%E5%AE%9A%E7%9A%84demo%EF%BC%8C%E5%A4%A7%E6%A6%82%E7%8E%87%E6%98%AF%E4%B8%8D%E4%BC%9A%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E9%87%8D%E6%9E%84%E4%BA%86%E3%80%82%E6%89%80%E4%BB%A5%E7%9B%AE%E5%89%8D%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E5%BE%88%E7%AE%80%E5%8D%95%E7%9A%84%E6%83%B3%E6%B3%95%E9%82%A3%E5%B0%B1%E6%98%AF%E4%BD%BF%E7%94%A8spring">https://hoteler.damingerdai.com/]ã€‚æ„Ÿè§‰ä½¿ç”¨k3séƒ¨ç½²ä¸€äº›ç®€å•çš„åº”ç”¨åŸºæœ¬ä¸Šé—®é¢˜ä¸å¤§äº†ã€‚[hoteler](https://github.com/damingerdai/hoteler)å·²ç»æ˜¯ä¸€ä¸ªå¾ˆç¨³å®šçš„demoï¼Œå¤§æ¦‚ç‡æ˜¯ä¸ä¼šè¿›è¡Œå¤§è§„æ¨¡çš„é‡æ„äº†ã€‚æ‰€ä»¥ç›®å‰åªæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„æƒ³æ³•é‚£å°±æ˜¯ä½¿ç”¨spring</a> cloudè¿›è¡Œé‡å†™ï¼Œè¿™ä¸ªæ˜¯ä¸å¤ªèƒ½è‡ªå·±éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒäº†ï¼Œæ¯•ç«ŸæœåŠ¡å™¨èµ„æºå°±é‚£ä¹ˆç‚¹ï¼Œè·‘ä¸èµ·é‚£ä¹ˆå¤šçš„èµ„æºã€‚</p><p>é’ˆå¯¹golangçš„è¯ï¼Œæˆ‘ç›®å‰ç§ä¸‹çš„åœ¨åšä¸€ä¸ªå…³äºå¥åº·çš„demoï¼Œç›®å‰è¿˜åœ¨å¼€å‘ä¸­ï¼Œå‰ç«¯ä½¿ç”¨reactï¼Œåç«¯ä½¿ç”¨golangã€‚ç›®å‰å¸Œæœ›åœ¨æŠ€æœ¯ä¸Šçš„çªç ´æ˜¯ä½¿ç”¨lokiåšæ—¥å¿—ç®¡ç†ï¼ŒJaegerç”¨äºé“¾è·¯è¿½è¸ªï¼Œè¿™æ˜¯1.0çš„è®¡åˆ’ã€‚2.0çš„è¯ï¼ˆå¦‚æœæœ‰æ—¶é—´çš„è¯ï¼‰ï¼Œå¸Œæœ›å¯ä»¥åŠ å…¥åŒºå—é“¾çš„ä¸€äº›å…ƒç´ ï¼Œè‡³å°‘èƒ½åšæˆä¸ªÂ·web2.5Â·ã€‚</p><p>ä»Šå¹´å…¶å®è¿˜æ˜¯æ¢ç´¢äº†å¾ˆå¤šçš„æŠ€æœ¯ã€‚æ¯”å¦‚<a href="https://min.io/">minio</a>, <a href="https://goharbor.io/">harbor</a>, <a href="https://www.drone.io/">drone</a>, <a href="https://gogs.io/">gogs</a>å’Œ<a href="https://gitea.io/zh-cn">gitea</a>ã€‚</p><h2 id="ä¸ªäººç”Ÿæ´»"><a href="#ä¸ªäººç”Ÿæ´»" class="headerlink" title="ä¸ªäººç”Ÿæ´»"></a>ä¸ªäººç”Ÿæ´»</h2><p>ä»Šå¤©å¯¹æˆ‘æœ€å¤§çš„äº‹å„¿å°±æ˜¯ç»“å©šäº†ï¼Œæ²¡æœ‰æ¯”ä¸¾åŠå©šç¤¼æ›´é‡è¦çš„äº‹å„¿äº†ã€‚æœ¬æ¥ç”±äºæ”¶åˆ°ä¸ŠåŠå¹´ç–«æƒ…çš„å½±å“ï¼ŒåŸæ¥ä¸æŒ‡æœ›ä»Šå¹´ç»“å©šçš„ã€‚æœ¬æ¥å®šçš„æ—¥å­æ˜¯æ˜å¹´çš„æ­£æœˆåŠé…’å¸­ï¼Œä½†æ˜¯ä¸ˆæ¯å¨˜è§‰å¾—ä»Šå¹´çš„å¤å¤©é‚£ä¹ˆçƒ­ï¼Œå†¬å¤©ä¸€å®šå¾ˆä¼šå†·ï¼Œå¸Œæœ›æˆ‘ä»¬ä»Šå¹´å°±æ˜¯æŠŠäº‹å„¿åŠäº†ã€‚æ‰€ä»¥å©šæœŸæå‰åˆ°11æœˆä»½ä¸¾è¡Œï¼Œæœ¬æ¥æ—¥å­é€‰çš„å¥½å¥½çš„ï¼Œä¹Ÿæ²¡å•¥å¥½çº ç»“çš„ï¼Œæ¯•ç«Ÿå¦¹å­æ˜¯è‡ªå·±è°ˆçš„ã€‚ä½†æ˜¯æ˜å¤©å’Œæ„å¤–ä½ æ°¸è¿œéƒ½ä¸çŸ¥é“å“ªä¸ªå…ˆæ¥ï¼Œæˆ‘è€ä¸ˆäººåœ¨å©šç¤¼çš„å‰ä¸¤å¤©å»ä¸–äº†ã€‚åœ¨å©šç¤¼å‰çš„å‡ ä¸ªç¤¼æ‹œï¼Œæˆ‘è€ä¸ˆäººç”Ÿç—…äº†ï¼Œæ˜¯ä¾¿ç§˜å¯¼è‡´çš„è‚ æ¢—é˜»ã€‚åœ¨åŒ»é™¢æ²»ç–—äº†ä¸€æ®µæ—¶é—´æœ¬æ¥å·²ç»æ²»å¥½äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯åŒ»é™¢çš„æ°´å¹³é—®é¢˜è¿˜æ˜¯æˆ‘è€ä¸ˆäººæœ¬èº«çš„é—®é¢˜ï¼Œåœ¨æ²»ç–—è¿‡ç¨‹ä¸­å¯èƒ½æ²¡æœ‰æ§åˆ¶å¥½ç³–å°¿ç—…å¯¼è‡´è‚ºéƒ¨æ„ŸæŸ“ï¼Œ åœ¨icuèººäº†å‡ å¤©ä¹‹åç»ˆç©¶å°†æŠ¢æ•‘æ— æ•ˆå»ä¸–ï¼Œå¹´ä»…50å²ã€‚åœ¨æ®¡ä»ªé¦†é‡Œï¼Œæˆ‘çœ‹åˆ°åŒæ‰¹ç«åŒ–çš„äººä¸­å°±å±æˆ‘è€ä¸ˆäººæœ€å¹´è½»ã€‚æœ‰çš„æ—¶é—´çœŸçš„æ„Ÿè§‰ä¸–äº‹æ— å¸¸ï¼Œå›½åº†èŠ‚å›å»çš„æ—¶å€™ï¼Œè€ä¸ˆäººè¿˜å¥½å¥½çš„ï¼Œç»“æœæ‰è¿‡å»ä¸€ä¸ªæœˆä¸åˆ°ï¼Œäººå°±æ²¡äº†ã€‚</p><h2 id="å±•æœ›æœªæ¥"><a href="#å±•æœ›æœªæ¥" class="headerlink" title="å±•æœ›æœªæ¥"></a>å±•æœ›æœªæ¥</h2><p>å¯¹2023å¹´è¿™ä¸ªç»æµåˆ¤æ–­æ˜¯çœŸçš„ä¸å¤ªå¥½è¯´ï¼Œè°ä¹Ÿä¸çŸ¥é“æ˜å¹´ä¼šæ€ä¹ˆæƒ³ï¼Œæˆ‘ä¹Ÿä¸æ•¢çè¯´ï¼Œæˆ‘åªèƒ½æˆ‘å¤§æ¦‚ç‡ä¼šé‡ç‚¹å…³æ³¨Â·DeFiÂ·ã€‚ç„¶åå¸Œæœ›èƒ½å¤Ÿä¿ä½å°±ä¸šï¼Œä¿ä½ç°é‡‘æµã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡è¿ç§»Apollo Server V3çš„è¿‡ç¨‹</title>
      <link href="/2021/12/15/front-end/log-migrate-apollo-server-v3/"/>
      <url>/2021/12/15/front-end/log-migrate-apollo-server-v3/</url>
      
        <content type="html"><![CDATA[<h1 id="è®°å½•ä¸€æ¬¡è¿ç§»Apollo-Server-V3çš„è¿‡ç¨‹"><a href="#è®°å½•ä¸€æ¬¡è¿ç§»Apollo-Server-V3çš„è¿‡ç¨‹" class="headerlink" title="è®°å½•ä¸€æ¬¡è¿ç§»Apollo Server V3çš„è¿‡ç¨‹"></a>è®°å½•ä¸€æ¬¡è¿ç§»Apollo Server V3çš„è¿‡ç¨‹</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="https://www.apollographql.com/docs/apollo-server/">Apollo Server V3</a>å‡ºæ¥ä¹Ÿå¿«åŠå¹´äº†ï¼Œæ˜¯æ—¶å€™æŠŠ<a href="https://github.com/damingerdai/express-postgres-ts-starter">express-postgres-ts-starter</a>çš„graphqléƒ¨åˆ†å‡çº§äº†ã€‚</p><h2 id="ä½¿ç”¨dependabotå¸®åŠ©æ›´æ–°ç‰ˆæœ¬"><a href="#ä½¿ç”¨dependabotå¸®åŠ©æ›´æ–°ç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨dependabotå¸®åŠ©æ›´æ–°ç‰ˆæœ¬"></a>ä½¿ç”¨dependabotå¸®åŠ©æ›´æ–°ç‰ˆæœ¬</h2><p><a href="https://docs.github.com/en/code-security/supply-chain-security/keeping-your-dependencies-updated-automatically/about-dependabot-version-updates">dependabot</a>æ˜¯ä¸€ä¸ªgithubçš„å·¥å…·(ä¼¼ä¹ä¹Ÿæ”¯æŒgitlab,ä½†æ˜¯æˆ‘ä¸ç¡®å®š)ï¼Œç”¨äºæ£€æµ‹repoä¾èµ–å®‰å…¨æ€§ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘å®šæœŸæ›´æ–°repoçš„ä¾èµ–ç‰ˆæœ¬ã€‚</p><p>è¿™æ˜¯æˆ‘çš„dependabotçš„é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">version: 2</span><br><span class="line">updates:</span><br><span class="line"> - package-ecosystem: npm</span><br><span class="line">   directory: &#x27;/&#x27;</span><br><span class="line">   schedule:</span><br><span class="line">    interval: weekly</span><br><span class="line">   open-pull-requests-limit: 10</span><br></pre></td></tr></table></figure><h2 id="å‡çº§Apollo-Servieræ‰€éœ€è¦ä¾èµ–"><a href="#å‡çº§Apollo-Servieræ‰€éœ€è¦ä¾èµ–" class="headerlink" title="å‡çº§Apollo Servieræ‰€éœ€è¦ä¾èµ–"></a>å‡çº§Apollo Servieræ‰€éœ€è¦ä¾èµ–</h2><h3 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h3><p><code>Apollo Servier 3</code>ä»…ä»…æ”¯æŒnodejsv12ä»¥ä¸Šç‰ˆæœ¬(<code>Apollo Servier 2</code>åˆ™åªéœ€è¦nodejsv6ä»¥ä¸Šçš„æ”¯æŒ)ã€‚ å› æ­¤éœ€è¦å‡çº§åˆ°nodejs12ï¼Œæ¨èä½¿ç”¨node14å’Œnode16ã€‚</p><blockquote><p>æˆ‘ååˆ†æ¨èä½¿ç”¨Linux&#x2F;MACç”¨æˆ·ä½¿ç”¨<a href="https://github.com/nvm-sh/nvm">nvm</a>,Windowsç”¨æˆ·ä½¿ç”¨<a href="https://github.com/coreybutler/nvm-windows">nvm-windows</a>å®‰è£…ã€å‡çº§nodeç‰ˆæœ¬ã€‚</p></blockquote><h3 id="graphql"><a href="#graphql" class="headerlink" title="graphql"></a>graphql</h3><p><code>Apollo Servier</code>æœ‰ä¸€ä¸ªå¯é€‰ä¾èµ–<a href="https://www.npmjs.com/package/graphql">graphql</a>(GraphQL JSçš„æ ¸å¿ƒå®ç°),<code>Apollo Servier 3</code>éœ€è¦<code>graphql</code> v15.3.0ä»¥ä¸Šçš„æ”¯æŒã€‚</p><h2 id="é—®é¢˜è®°å½•"><a href="#é—®é¢˜è®°å½•" class="headerlink" title="é—®é¢˜è®°å½•"></a>é—®é¢˜è®°å½•</h2><h3 id="GraphQL-Playground"><a href="#GraphQL-Playground" class="headerlink" title="GraphQL Playground"></a>GraphQL Playground</h3><p><code>Apollo Server 2</code>æ˜¯é»˜è®¤æ”¯æŒ<a href="https://github.com/graphql/graphql-playground">GraphQL Playground</a>ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ„é€ å‡½æ•°é‡Œé…ç½®å¥½<em>playground</em>è¿™ä¸ªå­—æ®µå°±å¥½äº†ï¼Œä½†æ˜¯<code>Apollo Server 3</code>åˆ é™¤äº†å¯¹GraphQL Playgrounçš„é»˜è®¤æ”¯æŒï¼Œè½¬è€Œæ¨èåœ¨éç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨<a href="https://www.apollographql.com/blog/announcement/platform/apollo-sandbox-an-open-graphql-ide-for-local-development/">Apollo Sandbox</a>ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é‡æ–°é…ç½®<code>GraphQL Playground</code>çš„ã€‚</p><p>å¦‚æœä¹‹å‰æ˜¯ä½¿ç”¨<code>new ApolloServer(&#123;playground: boolean&#125;)</code>çš„ç±»ä¼¼æ–¹å¼é…ç½®<code>GraphQL Playground</code>ï¼Œé‚£ä¹ˆå¯ä»¥</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApolloServerPluginLandingPageGraphQLPlayground</span>,</span><br><span class="line">         <span class="title class_">ApolloServerPluginLandingPageDisabled</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;apollo-server-core&#x27;</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ApolloServer</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span></span><br><span class="line">      ? <span class="title class_">ApolloServerPluginLandingPageDisabled</span>()</span><br><span class="line">      : <span class="title class_">ApolloServerPluginLandingPageGraphQLPlayground</span>(),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœä¹‹å‰æ˜¯ä½¿ç”¨<code>new ApolloServer(&#123;playground: playgroundOptions&#125;)</code>çš„ç±»ä¼¼æ–¹å¼é…ç½®<code>GraphQL Playground</code>ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApolloServerPluginLandingPageGraphQLPlayground</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;apollo-server-core&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> playgroundOptions = &#123;</span><br><span class="line">    <span class="comment">// ä»…åšå‚è€ƒ</span></span><br><span class="line">    <span class="attr">settings</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;editor.theme&#x27;</span>: <span class="string">&#x27;dark&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;editor.cursorShape&#x27;</span>: <span class="string">&#x27;line&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ApolloServer</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title class_">ApolloServerPluginLandingPageGraphQLPlayground</span>(playgroundOptions),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="tracing"><a href="#tracing" class="headerlink" title="tracing"></a>tracing</h3><p>åœ¨<code>Apollo Server 2</code>ä¸­ï¼Œæ„é€ å‡½æ•°çš„å‚æ•°æä¾›<em>tracing</em>å¸ƒå°”å­—æ®µï¼Œç”¨äºå¼€å¯åŸºäº(apollo-tracing)[<a href="https://www.npmjs.com/package/apollo-tracing]%E8%B7%9F%E8%B8%AA%E6%9C%BA%E5%88%B6%EF%BC%8C%E4%BD%86%E6%98%AF%E5%BE%88%E9%81%97%E6%86%BE%EF%BC%8C%E5%9C%A8%60Apollo">https://www.npmjs.com/package/apollo-tracing]è·Ÿè¸ªæœºåˆ¶ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œåœ¨`Apollo</a> Server 3<code>ä¸­ï¼Œ*tracing*å·²ç»è¢«åˆ é™¤äº†ï¼Œï¼Œï¼Œ</code>apollo-tracing&#96;ä¹Ÿå·²ç»è¢«åºŸå¼ƒäº†ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œå¯ä»¥ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ApolloServer</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;apollo-tracing&#x27;</span>).<span class="title function_">plugin</span>()</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥è§£å†³æ–¹æ¡ˆæ²¡æœ‰ç»è¿‡ä¸¥æ ¼æµ‹è¯•ï¼Œå¯èƒ½å­˜åœ¨bugã€‚</p></blockquote><h3 id="You-must-await-server-start-before-calling-server-applyMiddleware"><a href="#You-must-await-server-start-before-calling-server-applyMiddleware" class="headerlink" title="You must await server.start() before calling server.applyMiddleware()"></a>You must <code>await server.start()</code> before calling <code>server.applyMiddleware()</code></h3><p>åœ¨<code>Apollo Server v2.22</code>ä¸­æä¾›äº†_server.start()_çš„æ–¹æ³•ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿é›†æˆéserverlessçš„æ¡†æ¶(Expressã€Fastifyã€Hapiã€Koaã€Micro å’Œ Cloudflare)ã€‚å› æ­¤è¿™äº›æ¡†æ¶çš„ä½¿ç”¨è€…ä½¿ç”¨åœ¨åˆ›å»º<code>ApolloServer</code>å¯¹è±¡ä¹‹åç«‹åˆ»å¯åŠ¨graphqlæœåŠ¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> server = <span class="keyword">new</span> <span class="title class_">ApolloServer</span>(&#123;...&#125;);</span><br><span class="line"><span class="keyword">await</span> server.<span class="title function_">start</span>();</span><br><span class="line">server.<span class="title function_">applyMiddleware</span>(&#123; app &#125;);</span><br></pre></td></tr></table></figure><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>ç°åœ¨å¯ä»¥åœ¨æµè§ˆå™¨æ‰“å¼€<code>GraphQL Playground</code>, ä»¥<a href="https://github.com/damingerdai/express-postgres-ts-starter">express-postgres-ts-starter</a>ä¸ºä¾‹ï¼Œä½¿ç”¨<code>http://127.0.0.1:3000/graphql</code>å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nodejs </tag>
            
            <tag> apollo </tag>
            
            <tag> graphql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»springfoxè¿ç§»åˆ°springdoc</title>
      <link href="/2021/11/29/back-end/migrate-springdoc-from-springfox/"/>
      <url>/2021/11/29/back-end/migrate-springdoc-from-springfox/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹æ‰€ä»¥è€ƒè™‘ä»springfoxè¿ç§»åˆ°springdocæ˜¯å› ä¸ºæˆ‘çš„å¼€æºé¡¹ç›®<a href="https://github.com/damingerdai/hoteler">hoteler</a>åœ¨å‡çº§åˆ°spring boot 2.6ä¹‹åï¼ŒUTçš„<a href="https://github.com/damingerdai/hoteler/runs/4272646614?check_suite_focus=true">CI&#x2F;CD</a>æŒ‚äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HotelerApplicationTests &gt; contextLoads() FAILED</span><br><span class="line">    java.lang.IllegalStateException at DefaultCacheAwareContextLoaderDelegate.java:<span class="number">132</span></span><br><span class="line">        Caused by: org.springframework.context.ApplicationContextException at DefaultLifecycleProcessor.java:<span class="number">181</span></span><br><span class="line">            Caused by: java.lang.NullPointerException at WebMvcPatternsRequestConditionWrapper.java:<span class="number">56</span></span><br><span class="line"></span><br><span class="line">ErrorPropTest &gt; setErrors() FAILED</span><br><span class="line">    java.lang.IllegalStateException at DefaultCacheAwareContextLoaderDelegate.java:<span class="number">132</span></span><br><span class="line">        Caused by: org.springframework.context.ApplicationContextException at DefaultLifecycleProcessor.java:<span class="number">181</span></span><br><span class="line">            Caused by: java.lang.NullPointerException at WebMvcPatternsRequestConditionWrapper.java:<span class="number">56</span></span><br><span class="line"></span><br><span class="line">... more</span><br></pre></td></tr></table></figure><p>åœ¨ä¸€ç•ªå®šä½å’Œè°·æ­Œä¹‹åï¼Œåœ¨<a href="https://github.com/springfox/springfox/issues/3462">Spring 5.3&#x2F;Spring Boot 2.4 support</a>å’Œ<a href="https://github.com/lWoHvYe/eladmin/commit/b879685a4962cb19062adeb0433c73a91c67e978">spring bootå‡çº§2.6.0ã€‚å¯åŠ¨æŠ¥é”™ åŸå› è¯¦è§ï¼šspringfox&#x2F;springfox#3462</a>ä¸­çš„æç¤ºä¸‹ï¼ŒçŒœæµ‹æ˜¯<a href="https://github.com/springfox/springfox">springfox</a>æœªå‡çº§å¯¼è‡´çš„ä¸å…¼å®¹å¯¼è‡´çš„é—®é¢˜ã€‚æœ¬æ¥è®¡åˆ’ç­‰å¾…springfoxå®˜æ–¹è‡ªè¡Œå‡çº§ï¼Œç»“æœä¸€çœ‹githubçš„æä»·è®°å½•ï¼Œspringfoxä»2020å¹´10æœˆ14å·ä¹‹åå°±åœ¨ä¹Ÿæ²¡æœ‰æ›´æ–°ä»£ç äº†ï¼Œå› æ­¤å†³å®šï¼Œ<a href="https://github.com/damingerdai/hoteler/issues/140">ä»springfoxè¿ç§»åˆ°springdoc</a>ã€‚</p><h2 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h2><p>å¦‚æœä»ç„¶æƒ³åœ¨spring 2.6ä¹‹åä½¿ç”¨springfoxï¼Œå»ºè®®åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.mvc.pathmatch.matching-strategy=ant_path_matcher</span><br></pre></td></tr></table></figure><p>æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://github.com/lWoHvYe/eladmin/blob/main/document/springboot/SpringBoot-2.6.0.md">https://github.com/lWoHvYe/eladmin</a>ã€‚</p><h1 id="åˆ é™¤springfoxä¾èµ–å’Œç›¸å…³ä»£ç "><a href="#åˆ é™¤springfoxä¾èµ–å’Œç›¸å…³ä»£ç " class="headerlink" title="åˆ é™¤springfoxä¾èµ–å’Œç›¸å…³ä»£ç "></a>åˆ é™¤springfoxä¾èµ–å’Œç›¸å…³ä»£ç </h1><p>é¦–å…ˆåˆ é™¤springfoxçš„ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># gradle</span><br><span class="line">io.springfox:springfox-boot-starter:3.0.0`</span><br><span class="line"></span><br><span class="line"># maven</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åˆ é™¤Controllerä¸‹çš„swaggerçš„æ³¨è§£ï¼Œ</p><p>åˆ é™¤è‡ªå®šçš„swaggerçš„é…ç½®ç±»ï¼Œ</p><p>åˆ é™¤<code>@EnableOpenApi</code></p><h1 id="å¯¼å…¥springdocä¾èµ–"><a href="#å¯¼å…¥springdocä¾èµ–" class="headerlink" title="å¯¼å…¥springdocä¾èµ–"></a>å¯¼å…¥springdocä¾èµ–</h1><p>å¯¹äºgradleç”¨æˆ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation &#x27;org.springdoc:springdoc-openapi-ui:1.5.12&#x27;</span><br></pre></td></tr></table></figure><p>å¯¹äºmavenç”¨æˆ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.12&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h1 id="OpenApié…ç½®"><a href="#OpenApié…ç½®" class="headerlink" title="OpenApié…ç½®"></a>OpenApié…ç½®</h1><p>åˆ›å»ºOpenApié…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OpenApiConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰Licenseï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> License <span class="title function_">license</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">License</span>()</span><br><span class="line">              .name(<span class="string">&quot;MIT&quot;</span>)</span><br><span class="line">              .url(<span class="string">&quot;https://opensource.org/licenses/MIT&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼š è¿™é‡Œæˆ‘é‡‡ç”¨MITçš„å¼€æºåè®®ï¼Œæ›´å¤šåè®®ï¼Œè¯·è®¿é—®<a href="https://opensource.org/licenses">https://opensource.org/licenses</a>ã€‚</p></blockquote><p>å®šä¹‰Open Apiçš„åŸºæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Info <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>()</span><br><span class="line">              .title(<span class="string">&quot;Hoteler Open API&quot;</span>)</span><br><span class="line">              .description(<span class="string">&quot;å¤§æ˜äºŒä»£&quot;</span>)</span><br><span class="line">              .version(<span class="string">&quot;v0.0.1&quot;</span>)</span><br><span class="line">              .license(license());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å¤–éƒ¨æ–‡æ¡£ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ExternalDocumentation <span class="title function_">externalDocumentation</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ExternalDocumentation</span>()</span><br><span class="line">            .description(<span class="string">&quot;å¤§æ˜äºŒä»£çš„Hoteler&quot;</span>)</span><br><span class="line">            .url(<span class="string">&quot;https://github.com/damingerdai/hoteler&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰OpenAPIçš„spring beanï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public OpenAPI springShopOpenAPI() &#123;</span><br><span class="line">    return new OpenAPI()</span><br><span class="line">            .info(info())</span><br><span class="line">            .externalDocs(externalDocumentation());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰openapiçš„æ‰«æç­–ç•¥:</p><ol><li>åŸºäºæŒ‡å®šæ¥å£åŒ…æ‰«æ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">springdoc:</span><br><span class="line">  packagesToScan: org.daming.hoteler.api.web (è¿™æ˜¯æˆ‘è‡ªå·±çš„webåŒ…)</span><br></pre></td></tr></table></figure><ol start="2"><li>åŸºäºæ¥å£è·¯ç”±æ‰«æ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">springdoc:</span><br><span class="line">  pathsToMatch: /api/**, /dev/**</span><br></pre></td></tr></table></figure><p>åœ¨controleræ·»åŠ @Tagæ³¨è§£<br>åœ¨controleræ–¹æ³•ä¸Šæ·»åŠ @Operationæ³¨è§£<br>åœ¨ @Operation æ³¨è§£ä¸Šæ·»åŠ @Parameters å’Œ @Parameter è¯´æ˜ï¼Œç”¨äºspringdocè§£æcontroleræ–¹æ³•çš„å‚æ•°<br>åœ¨çš„è¯·æ±‚ä½“ç±»æ·»åŠ @Schemaæ³¨è§£</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">package org.daming.hoteler.api.web;</span><br><span class="line"></span><br><span class="line">import io.swagger.v3.oas.annotations.Operation;</span><br><span class="line">import io.swagger.v3.oas.annotations.Parameter;</span><br><span class="line">import io.swagger.v3.oas.annotations.enums.ParameterIn;</span><br><span class="line">import io.swagger.v3.oas.annotations.security.SecurityRequirement;</span><br><span class="line">import io.swagger.v3.oas.annotations.tags.Tag;</span><br><span class="line">...more</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * customer constoller</span><br><span class="line"> *</span><br><span class="line"> * @author gming001</span><br><span class="line"> * @create 2020-12-25 22:13</span><br><span class="line"> **/</span><br><span class="line">@Tag(name = &quot;å®¢æˆ·&quot;, description = &quot;å®¢æˆ· API&quot;)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;api/v1&quot;)</span><br><span class="line">public class CustomerController &#123;</span><br><span class="line"></span><br><span class="line">    private ICustomerService customerService;</span><br><span class="line"></span><br><span class="line">    private IErrorService errorService;</span><br><span class="line"></span><br><span class="line">    @Operation(</span><br><span class="line">            summary = &quot;åˆ›å»ºå®¢æˆ·ä¿¡æ¯&quot;&#125;,</span><br><span class="line">            parameters = &#123;</span><br><span class="line">                    @Parameter(name = &quot;body&quot;, description = &quot;åˆ›å»ºç”¨æˆ·ä¿¡æ¯çš„è¯·æ±‚ä½“&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">    )</span><br><span class="line">    @PostMapping(&quot;customer&quot;)</span><br><span class="line">    public CommonResponse create(@RequestBody CreateCustomerRequest request) &#123;</span><br><span class="line">        var customer = new Customer().setName(request.getName()).setGender(request.getGender()).setCardId(request.getCardId()).setPhone(request.getPhone());</span><br><span class="line">        var id =  this.customerService.create(customer);</span><br><span class="line">        return new DataResponse&lt;&gt;(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Operation(summary = &quot;æ›´æ–°å®¢æˆ·ä¿¡æ¯&quot;)</span><br><span class="line">    @PutMapping(&quot;customer&quot;)</span><br><span class="line">    public CommonResponse update(@RequestBody UpdateCustomerRequest request) &#123;</span><br><span class="line">        var customer = new Customer().setId(request.getId()).setName(request.getName()).setGender(request.getGender()).setCardId(request.getCardId()).setPhone(request.getPhone());</span><br><span class="line">        this.customerService.update(customer);</span><br><span class="line">        return new CommonResponse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Operation(summary = &quot;è·å–æ‰€æœ‰çš„å®¢æˆ·ä¿¡æ¯&quot;)</span><br><span class="line">    @GetMapping(&quot;customers&quot;)</span><br><span class="line">    public CommonResponse list() &#123;</span><br><span class="line">        var list = this.customerService.list();</span><br><span class="line">        return new ListResponse&lt;&gt;(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Operation(summary = &quot;åˆ é™¤å®¢æˆ·ä¿¡æ¯&quot;)</span><br><span class="line">    @DeleteMapping(&quot;customer/&#123;id&#125;&quot;)</span><br><span class="line">    public CommonResponse delete(@PathVariable(&quot;id&quot;) String customerId) throws HotelerException &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            var id = Long.valueOf(customerId);</span><br><span class="line">            this.customerService.delete(id);</span><br><span class="line">        &#125; catch (NumberFormatException nfe) &#123;</span><br><span class="line">            var params = new Object[] &#123; nfe.getMessage() &#125;;</span><br><span class="line">            throw errorService.createHotelerException(ErrorCodeConstants.BAD_REQUEST_ERROR_CODEE, params, nfe);</span><br><span class="line">        &#125; catch (Exception ex) &#123;</span><br><span class="line">            throw errorService.createHotelerException(ErrorCodeConstants.SYSTEM_ERROR_CODEE, ex);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return new CommonResponse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public CustomerController(</span><br><span class="line">            ICustomerService customerService,</span><br><span class="line">            IErrorService errorService) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.customerService = customerService;</span><br><span class="line">        this.errorService = errorService;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * create customer request</span><br><span class="line"> *</span><br><span class="line"> * @author gming001</span><br><span class="line"> * @create 2020-12-25 22:15</span><br><span class="line"> **/</span><br><span class="line">@Schema(name = &quot;åˆ›å»ºå®¢æˆ·è¯·æ±‚&quot;)</span><br><span class="line">public class CreateCustomerRequest implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = -7819607546063963266L;</span><br><span class="line"></span><br><span class="line">    @Schema(name = &quot;åå­—&quot;)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    private Gender gender;</span><br><span class="line"></span><br><span class="line">    private String cardId;</span><br><span class="line"></span><br><span class="line">    private long phoneï¼š</span><br><span class="line"></span><br><span class="line">    ...more</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æ·»åŠ å¯¹JWTå¯¹tokençš„æ”¯æŒ-æœ¬æ­¥éª¤å¯é€‰"><a href="#æ·»åŠ å¯¹JWTå¯¹tokençš„æ”¯æŒ-æœ¬æ­¥éª¤å¯é€‰" class="headerlink" title="æ·»åŠ å¯¹JWTå¯¹tokençš„æ”¯æŒ(æœ¬æ­¥éª¤å¯é€‰)"></a>æ·»åŠ å¯¹JWTå¯¹tokençš„æ”¯æŒ(æœ¬æ­¥éª¤å¯é€‰)</h1><p>åœ¨æ·»åŠ OpenApiConfigç±»ä¸Šæ·»åŠ Componentsä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private Components components() &#123;</span><br><span class="line">    return new Components()</span><br><span class="line">            .addSecuritySchemes(&quot;bearer-key&quot;, new SecurityScheme().type(SecurityScheme.Type.HTTP).scheme(&quot;bearer&quot;).bearerFormat(&quot;JWT&quot;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨OpenApiä¸­æ³¨å†ŒComponents:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  @Bean</span><br><span class="line">  public OpenAPI springShopOpenAPI() &#123;</span><br><span class="line">      return new OpenAPI()</span><br><span class="line">              .info(info())</span><br><span class="line">              .components(components())</span><br><span class="line">              .externalDocs(externalDocumentation());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨éœ€è¦ä½¿ç”¨Authorizationçš„æ¥å£ä¸Šæ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Operation(security = &#123; @SecurityRequirement(name = &quot;bearer-key&quot;) &#125;)</span><br></pre></td></tr></table></figure><h1 id="swagger-ui"><a href="#swagger-ui" class="headerlink" title="swagger-ui"></a>swagger-ui</h1><p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://127.0.0.1:8443/swagger-ui.html">http://127.0.0.1:8443/swagger-ui.html</a>æˆ–è€…<a href="http://localhost:8443/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config">http://localhost:8443/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config</a></p><blockquote><p>æ³¨ï¼š 8443æ˜¯æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢çš„webå¼€å‘çš„ç«¯å£å ç”¨ï¼Œä¸€èˆ¬äººä½¿ç”¨8080æ¯”è¾ƒå¤šã€‚</p></blockquote><h1 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h1><p><img src="/images/migrate-springdoc-from-springfox/swagger-ui.webp" alt="swagger-ui"></p><h1 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h1><p><a href="https://github.com/damingerdai/hoteler/pull/146">feat: ä»springfoxè¿ç§»åˆ°springdocä»¥åŠä¿®å¤AuthenticationFilterè¿‡æ»¤å¤±è´¥çš„é—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> spring boot </tag>
            
            <tag> springdoc </tag>
            
            <tag> swagger-ui </tag>
            
            <tag> oepn api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gradleé…ç½®é˜¿é‡Œé•œåƒ</title>
      <link href="/2021/10/29/back-end/gradle-ali-mirror/"/>
      <url>/2021/10/29/back-end/gradle-ali-mirror/</url>
      
        <content type="html"><![CDATA[<h1 id="Gradleé…ç½®é˜¿é‡Œé•œåƒ"><a href="#Gradleé…ç½®é˜¿é‡Œé•œåƒ" class="headerlink" title="Gradleé…ç½®é˜¿é‡Œé•œåƒ"></a>Gradleé…ç½®é˜¿é‡Œé•œåƒ</h1><p>ä¸ºäº†åŠ å¿«gradleçš„å›½å†…ä¸‹è½½çš„é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºgradleé…ç½®é˜¿é‡Œä»“åº“çš„é•œåƒ</p><p>è¯·åœ¨gradleçš„å®‰è£…ç›®å½•ä¸‹çš„<code>init.d</code>çš„æ–‡ä»¶å¤¹ä¸‹æ·»åŠ <code>init.gradle</code>:</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">gradle.projectsLoaded &#123;</span><br><span class="line">    rootProject.allprojects &#123;</span><br><span class="line">        buildscript &#123;</span><br><span class="line">            repositories &#123;</span><br><span class="line">                <span class="keyword">def</span> JCENTER_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/public&#x27;</span></span><br><span class="line">                <span class="keyword">def</span> GOOGLE_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/google&#x27;</span></span><br><span class="line">                <span class="keyword">def</span> NEXUS_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/central&#x27;</span></span><br><span class="line">                all &#123; ArtifactRepository repo -&gt;</span><br><span class="line">                    <span class="keyword">if</span> (repo <span class="keyword">instanceof</span> MavenArtifactRepository) &#123;</span><br><span class="line">                        <span class="keyword">def</span> url = repo.url.toString()</span><br><span class="line">                        <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://jcenter.bintray.com/&#x27;</span>)) &#123;</span><br><span class="line">                            project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $JCENTER_URL.&quot;</span></span><br><span class="line">                            println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $JCENTER_URL.&quot;</span>)</span><br><span class="line">                            remove repo</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://dl.google.com/dl/android/maven2/&#x27;</span>)) &#123;</span><br><span class="line">                            project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $GOOGLE_URL.&quot;</span></span><br><span class="line">                            println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $GOOGLE_URL.&quot;</span>)</span><br><span class="line">                            remove repo</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://repo1.maven.org/maven2&#x27;</span>)) &#123;</span><br><span class="line">                            project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;</span></span><br><span class="line">                            println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;</span>)</span><br><span class="line">                            remove repo</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                jcenter &#123;</span><br><span class="line">                    url JCENTER_URL</span><br><span class="line">                &#125;</span><br><span class="line">                google &#123;</span><br><span class="line">                    url GOOGLE_URL</span><br><span class="line">                &#125;</span><br><span class="line">                maven &#123;</span><br><span class="line">                    url NEXUS_URL</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        repositories &#123;</span><br><span class="line">            <span class="keyword">def</span> JCENTER_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/public&#x27;</span></span><br><span class="line">            <span class="keyword">def</span> GOOGLE_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/google&#x27;</span></span><br><span class="line">            <span class="keyword">def</span> NEXUS_URL = <span class="string">&#x27;https://maven.aliyun.com/repository/central&#x27;</span></span><br><span class="line">            all &#123; ArtifactRepository repo -&gt;</span><br><span class="line">                <span class="keyword">if</span> (repo <span class="keyword">instanceof</span> MavenArtifactRepository) &#123;</span><br><span class="line">                    <span class="keyword">def</span> url = repo.url.toString()</span><br><span class="line">                    <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://jcenter.bintray.com/&#x27;</span>)) &#123;</span><br><span class="line">                        project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $JCENTER_URL.&quot;</span></span><br><span class="line">                        println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $JCENTER_URL.&quot;</span>)</span><br><span class="line">                        remove repo</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://dl.google.com/dl/android/maven2/&#x27;</span>)) &#123;</span><br><span class="line">                        project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $GOOGLE_URL.&quot;</span></span><br><span class="line">                        println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $GOOGLE_URL.&quot;</span>)</span><br><span class="line">                        remove repo</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (url.startsWith(<span class="string">&#x27;https://repo1.maven.org/maven2&#x27;</span>)) &#123;</span><br><span class="line">                        project.logger.lifecycle <span class="string">&quot;Repository $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;</span></span><br><span class="line">                        println(<span class="string">&quot;buildscript $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;</span>)</span><br><span class="line">                        remove repo</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            jcenter &#123;</span><br><span class="line">                url JCENTER_URL</span><br><span class="line">            &#125;</span><br><span class="line">            google &#123;</span><br><span class="line">                url GOOGLE_URL</span><br><span class="line">            &#125;</span><br><span class="line">            maven &#123;</span><br><span class="line">                url NEXUS_URL</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.zhihu.com/collection/276086251">å¦‚ä½•æ„å»º Spring æºç ç¯å¢ƒï¼Ÿ</a></li><li><a href="https://developer.aliyun.com/mvn/guide">é˜¿é‡Œäº‘äº‘æ•ˆ Maven</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodejsé¡¹ç›®çš„Dockerfileæ¨¡ç‰ˆ</title>
      <link href="/2021/10/20/front-end/node-docker-template/"/>
      <url>/2021/10/20/front-end/node-docker-template/</url>
      
        <content type="html"><![CDATA[<h1 id="Nodejsé¡¹ç›®çš„Dockerfileæ¨¡ç‰ˆ"><a href="#Nodejsé¡¹ç›®çš„Dockerfileæ¨¡ç‰ˆ" class="headerlink" title="Nodejsé¡¹ç›®çš„Dockerfileæ¨¡ç‰ˆ"></a>Nodejsé¡¹ç›®çš„Dockerfileæ¨¡ç‰ˆ</h1><h2 id="åŸºäºYarn"><a href="#åŸºäºYarn" class="headerlink" title="åŸºäºYarn"></a>åŸºäºYarn</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">14.17</span>.<span class="number">6</span>-alpine3.<span class="number">14</span> as build</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–æ¶ˆå¯¹httpsçš„è¯ä¹¦é™åˆ¶</span></span><br><span class="line"><span class="comment"># ENV SELF_SIGNED_CERT_IN_CHAIN=true</span></span><br><span class="line"><span class="comment"># ENV NODE_TLS_REJECT_UNAUTHORIZED=0</span></span><br><span class="line"><span class="comment"># RUN npm config set strict-ssl false</span></span><br><span class="line"><span class="comment"># RUN yarn config set strict-ssl false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk update &amp;&amp; apk add bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json yarn.lock .npmrc /tmp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /tmp &amp;&amp; yarn install --frozen-lockfile --non-interactive</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /app &amp;&amp; <span class="built_in">cp</span> -a /tmp/node_modules /app/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn build</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> build AS ci</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn run <span class="built_in">test</span>:ci &amp;&amp; yarn install --frozen-lockfile --non-interactive --production</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">14.17</span>.<span class="number">6</span>-alpine3.<span class="number">14</span> as release</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /app &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">addgroup -S daminggroup &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">adduser -S -h /app -G daminggroup daminguser &amp;&amp; \</span></span><br><span class="line"><span class="language-bash"><span class="built_in">chown</span> -R daminguser:daminggroup /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/dist ./dist</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/node_modules ./node_modules</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/package.json .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">HEALTHCHECK</span><span class="language-bash"> --interval=30s --<span class="built_in">timeout</span>=30s CMD curl -f http://localhost:3978/ping || <span class="built_in">exit</span> 1</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">3978</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;node dist/index.js&quot;</span>]</span></span><br></pre></td></tr></table></figure><h2 id="åŸºäºNPM"><a href="#åŸºäºNPM" class="headerlink" title="åŸºäºNPM"></a>åŸºäºNPM</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">14.17</span>.<span class="number">6</span>-alpine3.<span class="number">14</span> as build</span><br><span class="line"></span><br><span class="line"><span class="comment"># pwc network limit</span></span><br><span class="line"><span class="comment"># ENV SELF_SIGNED_CERT_IN_CHAIN=true</span></span><br><span class="line"><span class="comment"># ENV NODE_TLS_REJECT_UNAUTHORIZED=0</span></span><br><span class="line"><span class="comment"># RUN npm config set strict-ssl false</span></span><br><span class="line"><span class="comment"># RUN yarn config set strict-ssl false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk update &amp;&amp; apk add bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json package-lock.json .npmrc /tmp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /tmp &amp;&amp; npm install</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /app &amp;&amp; <span class="built_in">cp</span> -a /tmp/node_modules /app/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm run build</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> build AS ci</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm run <span class="built_in">test</span>:ci &amp;&amp; npm install --production --ignore-scripts <span class="literal">true</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">14.17</span>.<span class="number">6</span>-alpine3.<span class="number">14</span> as release</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /app &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">addgroup -S daminggroup &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">adduser -S -h /app -G daminggroup daminguser &amp;&amp; \</span></span><br><span class="line"><span class="language-bash"><span class="built_in">chown</span> -R daminguser:daminggroup /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/dist ./dist</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/node_modules ./node_modules</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=ci --<span class="built_in">chown</span>=daminguser:daminggroup /app/package.json .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">HEALTHCHECK</span><span class="language-bash"> --interval=30s --<span class="built_in">timeout</span>=30s CMD curl -f http://localhost:3978/ping || <span class="built_in">exit</span> 1</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">3978</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;node dist/index.js&quot;</span>]</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Bazelç¼–è¯‘TypeScript</title>
      <link href="/2021/08/22/front-end/build-typescript-with-bazel/"/>
      <url>/2021/08/22/front-end/build-typescript-with-bazel/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Bazelç¼–è¯‘TypeScript"><a href="#ä½¿ç”¨Bazelç¼–è¯‘TypeScript" class="headerlink" title="ä½¿ç”¨Bazelç¼–è¯‘TypeScript"></a>ä½¿ç”¨Bazelç¼–è¯‘TypeScript</h1><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>è¯·äº‹å…ˆå®‰è£…<a href="https://nodejs.org/dist/v14.17.3/">Nodejs</a>,<a href="https://classic.yarnpkg.com/en/docs/install">Yarn 1.x</a>å’Œ<a href="https://docs.bazel.build/versions/4.2.0/install.html">Bazel</a></p><p>æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º:</p><ol><li>Nodejs: v14.17.3</li><li>Yarn:    1.22.5</li><li>Bzel:    4.1.0</li></ol><h2 id="åˆ›å»ºä¸€ä¸ªTypescripté¡¹ç›®"><a href="#åˆ›å»ºä¸€ä¸ªTypescripté¡¹ç›®" class="headerlink" title="åˆ›å»ºä¸€ä¸ªTypescripté¡¹ç›®"></a>åˆ›å»ºä¸€ä¸ªTypescripté¡¹ç›®</h2><p>é€‰æ‹©æŒ‡å®šç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º<code>ts-bazel</code>(å…¶ä»–åå­—ä¹Ÿå¯ä»¥)çš„æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ç»ˆç«¯è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶åæ‰§è¡Œ<code>npm init</code>ï¼Œä¸€è·¯é€‰æ‹©é»˜è®¤ã€‚</p><p>å®‰è£…Typescipt:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add typescipt -D</span><br></pre></td></tr></table></figure><p>åˆ›å»ºTypescripté…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx tsc --init</span><br></pre></td></tr></table></figure><p>åˆ›å»º<code>src</code>æ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹é‡Œæ–°å»º<code>index.ts</code>æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸€ä¸‹å†…å®¹ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`helle <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sayHello</span>(<span class="string">&#x27;daming&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="é…ç½®Bazel"><a href="#é…ç½®Bazel" class="headerlink" title="é…ç½®Bazel"></a>é…ç½®Bazel</h2><p>å®‰è£…bazelç­‰ç›¸å…³ä¾èµ–ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @bazel/bazelisk @bazel/ibazel @bazel/typescript -D </span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•é‡Œåˆ›å»º<code>WORKSPACE</code>, å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">workspace(</span><br><span class="line">    name = &quot;ts-bazel&quot;,</span><br><span class="line">    managed_directories = &#123;&quot;@npm&quot;: [&quot;node_modules&quot;]&#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">load(&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;, &quot;http_archive&quot;)</span><br><span class="line"></span><br><span class="line">http_archive(</span><br><span class="line">    name = &quot;build_bazel_rules_nodejs&quot;,</span><br><span class="line">    sha256 = &quot;275744d287af4c3a78d7c9891f2d970b7bc7eca8cfc0e9a671fe6258d09ff217&quot;,</span><br><span class="line">    urls = [&quot;https://github.com/bazelbuild/rules_nodejs/releases/download/4.0.0-rc.1/rules_nodejs-4.0.0-rc.1.tar.gz&quot;],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">load(&quot;@build_bazel_rules_nodejs//:index.bzl&quot;, &quot;check_rules_nodejs_version&quot;, &quot;node_repositories&quot;, &quot;yarn_install&quot;)</span><br><span class="line"></span><br><span class="line">check_rules_nodejs_version(minimum_version_string = &quot;2.2.0&quot;)</span><br><span class="line"></span><br><span class="line"># Setup the Node.js toolchain</span><br><span class="line">node_repositories(</span><br><span class="line">    node_version = &quot;14.17.3&quot;,</span><br><span class="line">    package_json = [&quot;//:package.json&quot;],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">yarn_install(</span><br><span class="line">    name = &quot;npm&quot;,</span><br><span class="line">    package_json = &quot;//:package.json&quot;,</span><br><span class="line">    yarn_lock = &quot;//:yarn.lock&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸­åˆ›å»º<code>BUILD.bazel</code>æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">package(default_visibility = [&quot;//visibility:public&quot;])</span><br><span class="line"></span><br><span class="line">exports_files([&quot;tsconfig.json&quot;])</span><br></pre></td></tr></table></figure><p>åœ¨<code>src</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code>BUILD.bazel</code>æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package(default_visibility = [&quot;//visibility:public&quot;])</span><br><span class="line"></span><br><span class="line">load(&quot;@npm//@bazel/typescript:index.bzl&quot;, &quot;ts_project&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ts_project(</span><br><span class="line">  name = &quot;index&quot;,</span><br><span class="line">  srcs = [&quot;index.ts&quot;],</span><br><span class="line">  tsconfig = &quot;//:tsconfig.json&quot;,</span><br><span class="line">  visibility = [&quot;//visibility:public&quot;],</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>ç°åœ¨å¯ä»¥ä½¿ç”¨<code>bazel</code>ç¼–è¯‘é¡¹ç›®äº†ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel build //src:index</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ä¸€ä¸‹ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node  bazel-bin/src/index.js</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helle daming</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bazel </tag>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Homebrewå®‰è£…ç¬”è®°</title>
      <link href="/2021/07/31/software/install/how-to-install-homebrew/"/>
      <url>/2021/07/31/software/install/how-to-install-homebrew/</url>
      
        <content type="html"><![CDATA[<h1 id="Homebrewå®‰è£…ç¬”è®°"><a href="#Homebrewå®‰è£…ç¬”è®°" class="headerlink" title="Homebrewå®‰è£…ç¬”è®°"></a>Homebrewå®‰è£…ç¬”è®°</h1><p>ç®€å•è®°å½•ä¸€ä¸‹Homebrewå®‰è£…</p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>æ–°å»ºç»ˆç«¯ï¼Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®å›½å†…é•œåƒ"><a href="#é…ç½®å›½å†…é•œåƒ" class="headerlink" title="é…ç½®å›½å†…é•œåƒ"></a>é…ç½®å›½å†…é•œåƒ</h2><p>æ›¿æ¢ brew.git</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &quot;$(brew --repo)&quot; &amp;&amp; git remote set-url origin https://mirrors.ustc.edu.cn/brew.git</span><br></pre></td></tr></table></figure><p>æ›¿æ¢ homebrew-core.git</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &quot;$(brew --repo)/Library/Taps/homebrew/homebrew-core&quot; &amp;&amp; git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git</span><br></pre></td></tr></table></figure><p>Homebrew Bottles é…ç½®é•œåƒ</p><p>ä»¥zshä¸ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles&#x27; &gt;&gt; ~/.zshrc &amp;&amp; source ~/.zshrc</span><br></pre></td></tr></table></figure><h2 id="æ¢å¤é»˜è®¤å®˜æ–¹æº"><a href="#æ¢å¤é»˜è®¤å®˜æ–¹æº" class="headerlink" title="æ¢å¤é»˜è®¤å®˜æ–¹æº"></a>æ¢å¤é»˜è®¤å®˜æ–¹æº</h2><p>é‡ç½®brew.git:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &quot;$(brew --repo)&quot; &amp;&amp; git remote set-url origin https://github.com/Homebrew/brew.git</span><br></pre></td></tr></table></figure><p>é‡ç½®homebrew-core.git:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &quot;$(brew --repo)/Library/Taps/homebrew/homebrew-core&quot; &amp;&amp; git remote set-url origin https://github.com/Homebrew/homebrew-core.git</span><br></pre></td></tr></table></figure><p>æ³¨é‡Šæ‰ zsh é…ç½®æ–‡ä»¶é‡Œçš„æœ‰å…³ Homebrew Bottles å³å¯æ¢å¤å®˜æ–¹æºã€‚ é‡å¯ zsh æˆ–è®© zsh é‡è¯»é…ç½®æ–‡ä»¶ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://zhuanlan.zhihu.com/p/137464385">æ•™ä½ ä¸€æ‹›æå®š Homebrew ä¸‹è½½åŠ é€Ÿ</a><br><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/brew/">æ›¿æ¢åŠé‡ç½® Homebrew é»˜è®¤æº</a></p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> homebew </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScriptä¸­å¯é€‰é“¾</title>
      <link href="/2021/07/03/front-end/ts-optional-chaining/"/>
      <url>/2021/07/03/front-end/ts-optional-chaining/</url>
      
        <content type="html"><![CDATA[<h1 id="TypeScriptä¸­å¯é€‰é“¾"><a href="#TypeScriptä¸­å¯é€‰é“¾" class="headerlink" title="TypeScriptä¸­å¯é€‰é“¾"></a>TypeScriptä¸­å¯é€‰é“¾</h1><h2 id="ä»€ä¹ˆæ˜¯å¯é€‰é“¾"><a href="#ä»€ä¹ˆæ˜¯å¯é€‰é“¾" class="headerlink" title="ä»€ä¹ˆæ˜¯å¯é€‰é“¾"></a>ä»€ä¹ˆæ˜¯å¯é€‰é“¾</h2><p>TypeScript 3.7ä¸­ä¸€ä¸ªæœ€å¼•äººå…³æ³¨çš„ç‰¹æ€§ä¾¿æ˜¯å¯é€‰é“¾(Optional Chaining)ã€‚</p><p>æ‰€è°“å¯é€‰é“¾ï¼Œå°±æ˜¯å½“æˆ‘ä»¬è¯•å›¾ä½¿ç”¨è®¿é—®å¯¹è±¡çš„å­—æ®µæˆ–è€…æ–¹æ³•æ—¶ï¼Œå¦‚æœå¯¹è±¡ä¸º<code>null</code>æˆ–è€…<code>undefined</code>ï¼ŒTypeScriptå°†ä¼šè‡ªåŠ¨åœæ­¢è¿è¡Œçš„ä»£ç ï¼Œä»¥é˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p><h2 id="å¯é€‰é“¾çš„ä½¿ç”¨"><a href="#å¯é€‰é“¾çš„ä½¿ç”¨" class="headerlink" title="å¯é€‰é“¾çš„ä½¿ç”¨"></a>å¯é€‰é“¾çš„ä½¿ç”¨</h2><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ A, æœ‰ä¸€ä¸ªå­—æ®µbï¼Œbå¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯null:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> A &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="built_in">string</span> | <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ªå˜é‡a:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="string">&#x27;c&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>?.</code>æ¥è®¿é—®å­—æ®µ:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a?.<span class="property">b</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœaä¸º<code>null</code>æˆ–è€…<code>undefined</code>, å°†è¾“å‡º<code>undefined</code></p><h2 id="TypeScriptåšäº†ä»€ä¹ˆ"><a href="#TypeScriptåšäº†ä»€ä¹ˆ" class="headerlink" title="TypeScriptåšäº†ä»€ä¹ˆ"></a>TypeScriptåšäº†ä»€ä¹ˆ</h2><p>å¯é€‰é“¾å¹¶ä¸æ˜¯tsçš„ä¸“åˆ©ï¼Œåœ¨jså°±å·²ç»å­˜åœ¨äº†ï¼Œé™¤äº†ie,å…¶ä»–ç°ä»£æµè§ˆå™¨æœ€æ–°ç‰ˆæœ¬éƒ½æ˜¯æ”¯æŒäº†ï¼Œä½†æ˜¯ä¸€äº›è€ç‰ˆæœ¬å°±ä¸æ”¯æŒï¼Œå› æ­¤tsæ²¡æœ‰ä½¿ç”¨jsçš„è¯­æ³•ï¼Œè€Œæ˜¯é€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼<code>? :</code>è½¬è¯‘ã€‚å› æ­¤ä¸Šé¢çš„ä»£ç å°†ä¼šè½¬è¯‘æˆ:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a === <span class="literal">null</span> || a === <span class="keyword">void</span> <span class="number">0</span> ? <span class="keyword">void</span> <span class="number">0</span> : a.<span class="property">b</span>);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯tsæ²¡æœ‰åˆ¤æ–­aæ˜¯å¦æ˜¯<code>undefined</code>, è€Œæ˜¯å› ä¸ºåœ¨jsä¸­ï¼Œ <code>undefined</code>ä¸ä»…æ˜¯å€¼ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ã€‚ç›´åˆ°es5ä¹‹å‰ï¼Œ<code>undefined</code>æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥ä¿®æ”¹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="literal">undefined</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">undefined</span>) <span class="comment">// 1</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://jkchao.github.io/typescript-book-chinese/new/typescript-3.7.html#%E5%8F%AF%E9%80%89%E9%93%BE%EF%BC%88optional-chaining%EF%BC%89">æ·±å…¥ç†è§£ TypeScript(å¯é€‰é“¾ï¼ˆOptional Chainingï¼‰)</a></li><li><a href="https://fodor.org/blog/js-undefined-null-void/">JS: The difference between â€œundefinedâ€, â€œnullâ€ and â€œvoid 0â€</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Optional_chaining">å¯é€‰é“¾æ“ä½œç¬¦</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®(ä¸Š)</title>
      <link href="/2021/05/17/front-end/build-angular-on-windows-02/"/>
      <url>/2021/05/17/front-end/build-angular-on-windows-02/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®-ä¸‹"><a href="#åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®-ä¸‹" class="headerlink" title="åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›® (ä¸‹)"></a>åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›® (ä¸‹)</h1><p>å½“å®Œæˆbazelçš„å®‰è£…ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…nodejså°±å¯ä»¥å¼€å§‹ç¼–è¯‘angularäº†ã€‚</p><h2 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h2><p>ç›®å‰angularä»…æ”¯æŒnodejs12å’Œnodejs14è¿™ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ¨èä½¿ç”¨node14è¿™ä¸ªç‰ˆæœ¬ã€‚</p><p>å¯¹äºwindowså¹³å°è€Œè¨€ï¼Œnodejså¯ä»¥ç›´æ¥ä»<a href="https://nodejs.org/en/">å®˜ç½‘</a>é€‰æ‹©windowså¹³å°çš„äºŒè¿›åˆ¶åŒ…ä¸‹è½½ï¼Œç„¶åè¿›è¡Œç‚¹å‡»å®‰è£…å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æˆ‘ä¸ªäººæ›´æ¨èä½¿ç”¨<a href="https://github.com/coreybutler/nvm-windows">nvm-windows</a>ã€‚</p><h3 id="nvm-windows"><a href="#nvm-windows" class="headerlink" title="nvm-windows"></a>nvm-windows</h3><p>nvm-windowsæ˜¯windowså¹³å°ä¸Šå¸¸ç”¨çš„nodeç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬é’ˆå¯¹ä¸åŒé¡¹ç›®çš„è¦æ±‚åˆ‡æ¢ä¸åŒçš„nodeç‰ˆæœ¬ã€‚ç‚¹å‡»<a href="https://github.com/coreybutler/nvm/releases">è¯¥é“¾æ¥</a>ï¼Œä¸‹è½½æœ€æ–°å®‰è£…åŒ…ï¼Œç„¶åç‚¹å‡»å®‰è£…ã€‚</p><h4 id="ä½¿ç”¨å›½å†…é•œåƒ"><a href="#ä½¿ç”¨å›½å†…é•œåƒ" class="headerlink" title="ä½¿ç”¨å›½å†…é•œåƒ"></a>ä½¿ç”¨å›½å†…é•œåƒ</h4><p>ç”±äºå›½å®¶ç‰¹æ®Šçš„ç½‘ç»œæ”¿ç­–ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ·˜å®é•œåƒ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm node_mirror http://npm.taobao.org/mirrors/node/ // æ³¨æ„ç»“å°¾æœ‰æ–œæ </span><br><span class="line">nvm npm_mirror https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…nodejs14"><a href="#å®‰è£…nodejs14" class="headerlink" title="å®‰è£…nodejs14"></a>å®‰è£…nodejs14</h4><p>ç›®å‰node14çš„æœ€æ–°ç‰ˆæ˜¯14.17.0ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨nvmæ¥è¿›è¡Œå®‰è£…:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm install v14.17.0</span><br><span class="line">nvm use v14.17.0</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹nodeæ˜¯å¦æ­£ç¡®å®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br><span class="line"></span><br><span class="line">// ç»“æœ</span><br><span class="line">v14.17.0</span><br></pre></td></tr></table></figure><h2 id="Yarn"><a href="#Yarn" class="headerlink" title="Yarn"></a>Yarn</h2><p><a href="https://classic.yarnpkg.com/lang/en/">Yarn</a>æ˜¯Facebookå¼€å‘çš„nodejsåŒ…ç®¡ç†å·¥å…·ï¼Œä¸æ—©æœŸnpmç›¸æ¯”ï¼Œå…·æœ‰ä¸‹è½½é€Ÿåº¦å¿«ï¼Œå‘½ä»¤æ›´åŠ å‹å¥½ï¼Œæä¾›æœ¬ç‰ˆæœ¬é”ç­‰ä¼˜åŠ¿ã€‚å½“ç„¶ï¼Œè™½ç„¶npmä¸æ–­çš„æ›´æ–°è¿­ä»£ï¼Œyarnçš„ä¼˜åŠ¿ä¹Ÿä¸å†æ˜æ˜¾ï¼Œä½†æ˜¯angularå¼€å‘å›¢é˜Ÿæ›´åŠ æ¨èä½¿ç”¨yarnã€‚</p><p>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<a href="https://classic.yarnpkg.com/lang/en/">Yarn1.x</a>å’Œ<a href="https://yarnpkg.com/">Yarn2.x</a>æ˜¯ä¸¤ä¸ªä¸å…¼å®¹çš„ç‰ˆæœ¬ï¼Œè€Œangularåªæ”¯æŒyarnv1.22.4ä»¥ä¸Šä¸”ä¸åŒ…æ‹¬2çš„ç‰ˆæœ¬(å³&gt;&#x3D;1.22.4 &lt;2)ã€‚å› æ­¤åœ¨ä¸‹è½½çš„æ—¶å€™è¯·é€‰æ‹©æ­£ç¡®çš„ç‰ˆæœ¬ã€‚</p><h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><p>å½“bazelã€nodejsã€yarnéƒ½å®‰è£…å®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥åœ¨æœ¬åœ°å¼€å§‹ç¼–è¯‘angularäº†ã€‚</p><h3 id="ä¸‹è½½angularä»“åº“"><a href="#ä¸‹è½½angularä»“åº“" class="headerlink" title="ä¸‹è½½angularä»“åº“"></a>ä¸‹è½½angularä»“åº“</h3><p>åœ¨ç»ˆç«¯æ‰§è¡Œcloneå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone --depth=16 https://github.com/angular/angular.git</span><br></pre></td></tr></table></figure><blockquote><p><code>--depth=16</code>è¡¨ç¤ºä»…ä»…gitåªä¼šæ‹‰å»æœ€æ–°16ä¸ªcommitã€‚</p></blockquote><h3 id="å®‰è£…angularä¾èµ–"><a href="#å®‰è£…angularä¾èµ–" class="headerlink" title="å®‰è£…angularä¾èµ–"></a>å®‰è£…angularä¾èµ–</h3><p>åœ¨å®‰è£…ä¾èµ–ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ é™¤<code>sauce-connect</code>ä¾èµ–ï¼Œå› ä¸ºè¯¥ä¾èµ–ä¸æ”¯æŒwindowsï¼Œä¸”ä¹Ÿä¸å½±å“æˆ‘ä»¬çš„ç¼–è¯‘ã€‚</p><p>åœ¨ç»ˆç«¯æ‰§è¡Œyarnå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘angular"><a href="#ç¼–è¯‘angular" class="headerlink" title="ç¼–è¯‘angular"></a>ç¼–è¯‘angular</h3><p>åœ¨ç»ˆç«¯æ‰§è¡Œç¼–è¯‘è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node scripts/build/build-packages-dist.js</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤å°†ä¼šå…ˆåç¼–è¯‘angular,angular-in-memory-web-apiå’Œzone.jsä¸‰å¤§æ¨¡å—ã€‚</p><blockquote><p>å¦‚æœç¼–è¯‘è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥åœ¨é‡æ–°æ‰§è¡Œç¼–è¯‘è„šæœ¬ä¹‹å‰ï¼Œæ‰§è¡Œcleanå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel clean</span><br></pre></td></tr></table></figure></blockquote><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>å½“ä¸Šé¢çš„å‘½ä»¤æ­£ç¡®æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ£€æŸ¥ä¸€ä¸‹distç›®å½•ä¸‹çš„ç¼–è¯‘åçš„angularä»£ç äº†ï¼š</p><ol><li><code>dist\angular-in-memory-web-api-dist\angular-in-memory-web-api</code>ç›®å½•ä¸‹æ˜¯<a href="https://www.npmjs.com/package/angular-in-memory-web-api">angular-in-memory-web-api</a>ï¼›</li><li><code>dist\packages-dist</code>ç›®å½•ä¸‹ä¾¿æ˜¯angularå„ä¸ªæ¨¡å—çš„ä»£ç äº†ï¼›</li><li><code>dist\zone.js-dist</code>ç›®å½•ä¸‹çš„æ˜¯<a href="https://www.npmjs.com/package/zone.js">zone.js</a>ã€‚</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆ°æ­¤ï¼Œwindowsä¸Šç¼–è¯‘angularå°±ç®—æ˜¯å®Œæˆäº†ã€‚angularä½¿ç”¨bazelä½œä¸ºç¼–è¯‘å·¥å…·ï¼Œç¡®å®å¯¼è‡´ç¼–è¯‘çš„æˆæœ¬é«˜äº†å¾ˆå¤šï¼Œå°¤å…¶æ˜¯åœ¨windowså¹³å°ï¼Œä½†æ˜¯ä¸åœæ¢ç´¢çš„è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªä¸æ–­å­¦ä¹ çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œä¸æŒ£é’±ï¼Œå°±æ˜¯äº¤ä¸ªæœ‹å‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bazel </tag>
            
            <tag> angular </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®(ä¸Š)</title>
      <link href="/2021/05/13/front-end/build-angular-on-windows-01/"/>
      <url>/2021/05/13/front-end/build-angular-on-windows-01/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®-ä¸Š"><a href="#åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›®-ä¸Š" class="headerlink" title="åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›® (ä¸Š)"></a>åœ¨windowsä¸Šæ„å»ºangularé¡¹ç›® (ä¸Š)</h1><p>å‰ç«¯ä¸‰å¤§æ¡†æ¶( <a href="https://angular.io/">angular</a>, <a href="https://reactjs.org/">reac</a>, <a href="https://vuejs.org/">vue</a> )ä¸­ï¼Œangularä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªå¾ˆç‹¬ç‰¹çš„å­˜åœ¨ã€‚é¦–å…ˆï¼Œangularçš„æ¦‚å¿µå¾ˆå¤šï¼ŒæœåŠ¡ã€ä¾èµ–æ³¨å…¥ã€æ¨¡å—ï¼ŒæŒ‡ä»¤ç­‰ï¼Œéƒ½æ˜¯åœ¨å‰ç«¯åœˆä¸æ˜¯å¾ˆå¸¸ç”¨çš„ï¼Œæ­¤å¤–ï¼Œangularä½¿ç”¨äº†<a href="https://www.bazel.build/">bazel</a>ä½œä¸ºæ„å»ºå·¥å…·ï¼Œè€Œreactå’Œvueéƒ½æ˜¯ä½¿ç”¨äº†<a href="https://rollupjs.org/guide/en/">rollup</a>ï¼Œå› æ­¤åœ¨æœ¬åœ°ç¼–è¯‘æ„å»ºangularå°†ä¼šè¿œè¿œè¶…è¿‡reactå’Œvueï¼Œå¦‚æœä½ æ˜¯ç”¨çš„windowså¹³å°ï¼Œé‚£ä¹ˆä¸€ä¸ªä¸ªå‘éœ€è¦è‡ªå·±æ…¢æ…¢æ¥å¡«ã€‚ã€‚ã€‚</p><h1 id="Bazelæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Bazelæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Bazelæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Bazelæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>æ ¹æ®å®˜ç½‘çš„å®šä¹‰ï¼ŒBazelæ˜¯ç±»ä¼¼äºMakeï¼ŒMavenå’ŒGradleçš„å¼€æºæ„å»ºå’Œæµ‹è¯•å·¥å…·ã€‚å®ƒä½¿ç”¨äººç±»å¯è¯»çš„é«˜çº§æ„å»ºè¯­è¨€<a href="https://github.com/bazelbuild/starlark">Starlark</a>(ä¸€ç§åŸºäºpythonçš„æ–¹è¨€)ã€‚ Bazelæ”¯æŒå¤šç§è¯­è¨€çš„é¡¹ç›®ï¼Œå¹¶ä¸ºå¤šç§å¹³å°æ„å»ºè¾“å‡ºã€‚ </p><p>ä»æˆ‘ä¸ªäººè§’åº¦æ¥çœ‹ï¼Œbazelæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”å¤æ‚çš„æ„å»ºç³»ç»Ÿï¼Œé€šè¿‡<code>build rule</code>çš„æ¦‚å¿µï¼Œæ”¯æŒå¤šç§è¯­è¨€ã€ä¸åŒå¹³å°ï¼Œæ”¯æŒæ„å»ºC&#x2F;C++,Java,Android,IOS,Golang,Nodejs,Dockeré¡¹ç›®</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>Bazelå®˜æ–¹æ”¯æŒWindowsï¼ŒmacOS, Ubuntu Linuxä¸‰å¤§å¹³å°ï¼Œè¿™ä¹Ÿæ˜¯å¼€å‘äººå‘˜æ¯”è¾ƒå¸¸ç”¨çš„æœ¬åœ°å¼€å‘å¹³å°ã€‚</p><p>åœ¨ç¤¾åŒºçš„æ”¯æŒä¸‹ï¼Œbazelè¿˜æ”¯æŒå…¶ä»–å¹³å°ï¼Œå…·ä½“ä¿¡æ¯å¯ä»¥çœ‹ä¸€ä¸‹<a href="https://docs.bazel.build/versions/4.0.0/install.html">å®˜ç½‘</a>ã€‚è¿™é‡Œæˆ‘ä»…ä»…ä»‹ç»å¦‚ä½•åœ¨windowsä¸Šå®‰è£…ã€‚</p><h3 id="å®‰è£…è¦æ±‚"><a href="#å®‰è£…è¦æ±‚" class="headerlink" title="å®‰è£…è¦æ±‚"></a>å®‰è£…è¦æ±‚</h3><p>åœ¨å®‰è£…å‰ï¼Œè¯·ç¡®ä¿ä½ windowsç³»ç»Ÿç¬¦åˆè¦æ±‚ï¼š</p><ol><li>æ¨èä½¿ç”¨64ä½çš„windows10ï¼Œç‰ˆæœ¬å·ä¸èƒ½ä½äº1703</li><li>64ä½çš„Windows 7ä»¥ä¸Š</li><li>64ä½çš„Windows Server 2008 R2ä»¥ä¸Š</li></ol><p>æ­¤å¤–ï¼Œè¯·äº‹å…ˆå®‰è£…<a href="https://www.microsoft.com/en-us/download/details.aspx?id=48145">Visual C++ Redistributable for Visual Studio 2015</a></p><h3 id="ä¸‹è½½å®‰è£…Bazel"><a href="#ä¸‹è½½å®‰è£…Bazel" class="headerlink" title="ä¸‹è½½å®‰è£…Bazel"></a>ä¸‹è½½å®‰è£…Bazel</h3><p>æˆ‘ä»¬éœ€è¦åœ¨<a href="https://github.com/bazelbuild/bazel/releases">github</a>é€‰æ‹©ä¸‹è½½<code>bazel-&lt;version&gt;-windows-x86_64.exe</code>ï¼Œç„¶åå°†è¯¥æ–‡ä»¶è·¯å¾„æ”¾åœ¨pathç¯å¢ƒå˜é‡ä¸­ã€‚</p><p>åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bazel version</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºç±»ä¼¼æ•ˆæœå°±æ˜¯å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Build label: 4.0.0</span><br><span class="line">Build target: bazel-out/x64_windows-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar</span><br><span class="line">Build time: Thu Jan 21 07:39:16 2021 (1611214756)</span><br><span class="line">Build timestamp: 1611214756</span><br><span class="line">Build timestamp as int: 1611214756</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…ç¼–è¯‘å’Œè¯­è¨€è¿è¡Œæ—¶"><a href="#å®‰è£…ç¼–è¯‘å’Œè¯­è¨€è¿è¡Œæ—¶" class="headerlink" title="å®‰è£…ç¼–è¯‘å’Œè¯­è¨€è¿è¡Œæ—¶"></a>å®‰è£…ç¼–è¯‘å’Œè¯­è¨€è¿è¡Œæ—¶</h2><p>æ ¹æ®ä¸åŒè¯­è¨€çš„ç¼–è¯‘éœ€è¦ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä»¥ä¸‹çš„å·¥å…·ï¼š</p><ol><li><a href="https://www.msys2.org/">MSYS2 x86_64</a></li><li><a href="https://aka.ms/buildtools">Build Tools for Visual Studio 2019</a></li><li><a href="https://www.oracle.com/java/technologies/javase-jdk11-downloads.html">Java SE Development Kit 11 (JDK) for Windows x64</a></li><li><a href="https://www.python.org/downloads/windows/">Python 3.6 for Windows x86-64</a></li></ol><p>å¦‚æœä½ æƒ³åœ¨windowå¹³å°ç¼–è¯‘æ„å»ºangularï¼Œåä¸‰è€…å¿…é¡»çš„ï¼ŒJDK16å’ŒPython 3.9.5ä¹Ÿèƒ½æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å½“å®Œæˆä»¥ä¸Šæ­¥éª¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå°±å¯ä»¥å¼€å§‹å°è¯•åœ¨windowsæœ¬åœ°è¿›è¡Œç¼–è¯‘angularã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bazel </tag>
            
            <tag> angular </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Angularå’ŒReactæ„å»ºä½“ç§¯ç®€å•å¯¹æ¯”</title>
      <link href="/2021/02/03/front-end/simple-comparison-of-angular-and-react-build-size/"/>
      <url>/2021/02/03/front-end/simple-comparison-of-angular-and-react-build-size/</url>
      
        <content type="html"><![CDATA[<h1 id="Angularå’ŒReactæ„å»ºä½“ç§¯ç®€å•å¯¹æ¯”"><a href="#Angularå’ŒReactæ„å»ºä½“ç§¯ç®€å•å¯¹æ¯”" class="headerlink" title="Angularå’ŒReactæ„å»ºä½“ç§¯ç®€å•å¯¹æ¯”"></a>Angularå’ŒReactæ„å»ºä½“ç§¯ç®€å•å¯¹æ¯”</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="https://angular.io/">Angular</a>æ˜¯æˆ‘ä¸»è¦ä½¿ç”¨çš„å‰ç«¯æ¡†æ¶ï¼Œ å’Œ<a href="https://reactjs.org/">React</a>æ˜¯æˆ‘æœ€è¿‘æ­£åœ¨å­¦ä¹ çš„å‰ç«¯æ¡†æ¶ã€‚ä»Šå¤©æˆ‘æƒ³å¯¹æ¯”ä¸€ä¸‹åœ¨å„è‡ªé»˜è®¤çš„æƒ…å†µä¸‹ï¼Œä¸¤è€…æ‰“åŒ…ä½“ç§¯çš„å¯¹æ¯”ã€‚</p><h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>æˆ‘ä»¬ä½¿ç”¨<a href="https://www.npmjs.com/package/@angular/cli/v/11.1.2">Angular CLI: 11.1.2</a>ç®€å•åˆ›å»ºä¸€ä¸ªangularé¡¹ç›®:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ng new daming-angular-app</span><br><span class="line"></span><br><span class="line"># ? Do you want to enforce stricter type checking and stricter bundle budgets in the workspace? Y</span><br><span class="line"># ? Would you like to add Angular routing? Y</span><br><span class="line"># ? Which stylesheet format would you like to use? CSS</span><br></pre></td></tr></table></figure><p>ç„¶åç»ˆç«¯ä¼šæç¤ºæˆ‘ä»¬è¾“å…¥ä¸€äº›å¿…è¦çš„å‚æ•°ã€‚å¯¹äºYæˆ–Nçš„é€‰æ‹©ï¼Œæˆ‘ä»¬ç»Ÿä¸€é€‰æ‹©Yï¼Œå¯¹æ‹¥æœ‰å¤šä¸ªé€‰æ‹©é¡¹çš„ï¼Œæˆ‘ä»¬ç»Ÿä¸€é€‰æ‹©ç¬¬ä¸€ä¸ªå€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ? Do you want to enforce stricter type checking and stricter bundle budgets in the workspace? Y</span><br><span class="line"># ? Would you like to add Angular routing? Y</span><br><span class="line"># ? Which stylesheet format would you like to use? CSS</span><br></pre></td></tr></table></figure><p>è¿™æ ·å­æˆ‘ä»¬å°±åˆ›å»ºå¥½äº†ä¸€ä¸ªangularé¡¹ç›®ã€‚</p><h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>åœ¨angular.jsonæ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬å¯¹<em>outputHashing</em>å€¼ä»<code>all</code>æ”¹æˆ<code>none</code>ï¼Œç›®çš„åœ¨æ‰“åŒ…çš„æ—¶å€™ç”Ÿæˆjså’Œcssæ–‡ä»¶ä¸æ˜¯åŠ ä¸Šhashå€¼ï¼Œæ–¹ä¾¿ç»Ÿè®¡ã€‚</p><p>åœ¨ç»ˆç«¯æ‰§è¡Œæ„å»ºè„šæœ¬:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng build --prod</span><br></pre></td></tr></table></figure><h3 id="ç»Ÿè®¡"><a href="#ç»Ÿè®¡" class="headerlink" title="ç»Ÿè®¡"></a>ç»Ÿè®¡</h3><p>ç»ˆç«¯è¾“å‡ºæ‰“åŒ…ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Initial Chunk Files | Names         |      Size</span><br><span class="line">main.js             | main          | 212.27 kB</span><br><span class="line">polyfills.js        | polyfills     |  35.73 kB</span><br><span class="line">runtime.js          | runtime       |   1.45 kB</span><br><span class="line">styles.css          | styles        |   0 bytes</span><br><span class="line"></span><br><span class="line">                    | Initial Total | 249.45 kB</span><br></pre></td></tr></table></figure><p>é€šè¿‡FinderæŸ¥çœ‹jså’Œcssæ–‡ä»¶çš„å¤§å°å‘ç°:</p><ol><li>main.jså¤§å°ä¸º217kB;</li><li>polyfills.jså¤§å°ä¸º37kB;</li><li>runtime.jsä¸º1kB;</li><li>styles.cssä¸º0bã€‚</li></ol><p>å› æ­¤ä»finderè§’åº¦æ¥è¯´ï¼Œæ‰“åŒ…çš„æ€»ä½“ç§¯ä¸º255kBã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨<a href="https://www.npmjs.com/package/gzip-size-cli">gzip-size-cli</a>è·å–gzipçš„å¤§å°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npx gzip-size-cli main.js       // è¾“å‡º 64.0kB</span><br><span class="line">npx gzip-size-cli polyfills.js  // è¾“å‡º 12.4kB</span><br><span class="line">npx gzip-size-cli runtime.js    // è¾“å‡º 719B</span><br><span class="line">npx gzip-size-cli styles.css    // è¾“å‡º 20B</span><br></pre></td></tr></table></figure><p>é€šè¿‡gzipå‹ç¼©ä¹‹åï¼Œæ‰“åŒ…çš„æ€»ä½“ç§¯ä¸º77.14kB.</p><h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h3 id="åˆ›å»º-1"><a href="#åˆ›å»º-1" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>æˆ‘ä»¬ä½¿ç”¨<a href="https://create-react-app.dev/">Create React App</a>åˆ›å»ºä¸€ä¸ªreacté¡¹ç›®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app daming-react-app</span><br></pre></td></tr></table></figure><p>ä¸angularä¸åŒï¼Œåˆ›å»ºreacté¡¹ç›®çš„æ—¶å€™ç»ˆç«¯ä¸ä¼šæç¤ºæˆ‘ä»¬è¾“å…¥å¿…è¦çš„å‚æ•°ã€‚</p><h3 id="æ‰“åŒ…-1"><a href="#æ‰“åŒ…-1" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>åœ¨ç»ˆç«¯æ‰§è¡Œæ„å»ºè„šæœ¬:</p><p>å¦‚æœä½ ä½¿ç”¨npm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build </span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨yarn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build </span><br></pre></td></tr></table></figure><h3 id="ç»Ÿè®¡-1"><a href="#ç»Ÿè®¡-1" class="headerlink" title="ç»Ÿè®¡"></a>ç»Ÿè®¡</h3><p>ç»ˆç«¯è¾“å‡ºæ‰“åŒ…ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">File sizes after gzip:</span><br><span class="line"></span><br><span class="line">  41.21 KB  build/static/js/2.6a046b6b.chunk.js</span><br><span class="line">  1.4 KB    build/static/js/3.743bc3fe.chunk.js</span><br><span class="line">  1.17 KB   build/static/js/runtime-main.073f5272.js</span><br><span class="line">  597 B     build/static/js/main.2c9755c1.chunk.js</span><br><span class="line">  531 B     build/static/css/main.8c8b27cf.chunk.css</span><br></pre></td></tr></table></figure><p>ç»è¿‡ç»Ÿè®¡ï¼Œ gzipæ€»ä½“ç§¯ä¸º44.91kBã€‚</p><p>é€šè¿‡FinderæŸ¥çœ‹jså’Œcssæ–‡ä»¶çš„å¤§å°å‘ç°:</p><ol><li>main.2c9755c1.chunk.jså¤§å°ä¸º1kB;</li><li>runtime-main.073f5272.jså¤§å°ä¸º2kB;</li><li>2.6a046b6b.chunk.jså¤§å°ä¸º131kB;</li><li>3.743bc3fe.chunk.jså¤§å°ä¸º4kB;</li><li>main.8c8b27cf.chunkå¤§å°ä¸º804Bã€‚</li></ol><p>ç”±æ­¤å¯çŸ¥ï¼Œä»finderè§’åº¦æ¥è¯´ï¼Œæ‰“åŒ…çš„æ€»ä½“ç§¯ä¸º138.80kBã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ä¸Šé¢ç®€å•çš„å¯¹æ¯”ï¼Œåœ¨å„è‡ªé»˜è®¤çš„åˆ›å»ºã€æ„å»ºæ–¹å¼ä¸‹ï¼Œreactåœ¨æ‰“åŒ…ä½“ç§¯å¤§å°æ–¹é¢æ¯”angularæ›´å…·ä¼˜åŠ¿ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨å¤§é‡çš„ç¬¬ä¸‰æ–¹çš„ä¾èµ–ï¼Œå®é™…é¡¹ç›®çš„æ‰“åŒ…ä½“ç§¯å¤§å°è¿˜æ˜¯éœ€è¦å› äººè€Œå¼‚çš„ã€‚</p><p>æºä»£ç å·²ç»ä¸Šä¼ åˆ°<a href="https://github.com/damingerdai/imple-comparison-of-angular-and-react-build-size-code">github</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> angular </tag>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°</title>
      <link href="/2021/01/14/software/k8s/how-to-install-docker-desktop-k8s/"/>
      <url>/2021/01/14/software/k8s/how-to-install-docker-desktop-k8s/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°"><a href="#Docker-Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°" class="headerlink" title="Docker Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°"></a>Docker Desktopè‡ªå¸¦k8så®‰è£…ç¬”è®°</h1><p>å®‰è£…ä¸€ä¸ªk8sè¿˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œä½†æ˜¯Docker Desktopå·²ç»è‡ªå¸¦äº†ä¸€ä¸ªç®€æ˜“ç‰ˆçš„k8sï¼Œå¯ä»¥åŸºæœ¬æ»¡è¶³æ­£å¸¸çš„å­¦ä¹ ä½¿ç”¨</p><h2 id="å®‰è£…Docker"><a href="#å®‰è£…Docker" class="headerlink" title="å®‰è£…Docker"></a>å®‰è£…Docker</h2><p>å¯¹äºMacç”¨æˆ·ï¼Œè¯·ç‚¹å‡»<a href="https://desktop.docker.com/mac/stable/Docker.dmg">Docker Desktop</a><br>å¯¹äºWindows10ç”¨æˆ·ï¼Œè¯·ç‚¹å‡»<a href="https://desktop.docker.com/win/stable/Docker%20Desktop%20Installer.exe">Docker Desktop</a></p><h3 id="é…ç½®dockerçš„å›½å†…é•œåƒ"><a href="#é…ç½®dockerçš„å›½å†…é•œåƒ" class="headerlink" title="é…ç½®dockerçš„å›½å†…é•œåƒ"></a>é…ç½®dockerçš„å›½å†…é•œåƒ</h3><p>å›½å†…çš„ç½‘ç»œä¸‹è½½å¯èƒ½æ¯”è¾ƒæ…¢ï¼Œå»ºè®®ä½¿ç”¨ä¸‹é¢çš„é•œåƒ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;https://dockerproxy.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://dockerhub.azk8s.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://registry.docker-cn.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://hub-mirror.c.163.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://uyah70su.mirror.aliyuncs.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://dockerhub.mirrors.nwafu.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://7bafc985f90c43b887a96c2b846cf984.mirror.swr.myhuaweicloud.com&quot;</span></span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;insecure-registries&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;debug&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;experimental&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="å®‰è£…k8sæ‰€éœ€çš„é•œåƒ"><a href="#å®‰è£…k8sæ‰€éœ€çš„é•œåƒ" class="headerlink" title="å®‰è£…k8sæ‰€éœ€çš„é•œåƒ"></a>å®‰è£…k8sæ‰€éœ€çš„é•œåƒ</h2><p>ä¸ºäº†æ›´å¿«çš„å®Œæˆä¸€äº›å®‰è£…ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªé˜¿é‡Œäº‘çš„æ‰¹å¤„ç†ï¼Œæå‰æŠŠKuberneteséœ€è¦çš„Imagesæ‹‰å–ä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/AliyunContainerService/k8s-for-docker-desktop.git</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> k8s-for-docker-desktop</span><br><span class="line"></span><br><span class="line">.\load_images.ps1 or load_images.sh</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨Kubernetes"><a href="#å¯åŠ¨Kubernetes" class="headerlink" title="å¯åŠ¨Kubernetes"></a>å¯åŠ¨Kubernetes</h2><p>åœ¨Dockerä»ªè¡¨ç›˜ä¸Šåœ¨Settingsåˆ‡åˆ°Kubernetesä¸Šå¯åŠ¨Enabled Kubernetes</p><h2 id="å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰"><a href="#å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰" class="headerlink" title="å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰"></a>å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰</h2><p>ä½¿ç”¨<a href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml">recommended.yaml</a>è¿›è¡Œå®‰è£…</p><blockquote><p>å¦‚æœä¸èƒ½è®¿é—®<em>recommended.yaml</em>ï¼Œ å¯ä»¥ä½¿ç”¨<a href="#%E9%99%84%E5%BD%95">é™„å½•</a>çš„å‰¯æœ¬</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f recommended.yaml </span><br><span class="line">namespace/kubernetes-dashboard created</span><br><span class="line">serviceaccount/kubernetes-dashboard created</span><br><span class="line">service/kubernetes-dashboard created</span><br><span class="line">secret/kubernetes-dashboard-certs created</span><br><span class="line">secret/kubernetes-dashboard-csrf created</span><br><span class="line">secret/kubernetes-dashboard-key-holder created</span><br><span class="line">configmap/kubernetes-dashboard-settings created</span><br><span class="line">role.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">deployment.apps/kubernetes-dashboard created</span><br><span class="line">service/dashboard-metrics-scraper created</span><br><span class="line">deployment.apps/dashboard-metrics-scraper created</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>å‰å°å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl proxy</span><br></pre></td></tr></table></figure><p>åå°å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup kubectl proxy &gt;/dev/null &amp;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥è®¿é—®ï¼š <a href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/">http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</a></p><h3 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h3><p>ç™»å½•éœ€è¦è·å–token</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kube-system describe secret default| awk &#x27;$1==&quot;token:&quot;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘çš„è¿”å›ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Imk0TWpNeGM3SWVrMHllMVphM0FPVFZIZ2RIaXZIbll2UzZObkJSZTZ5MUEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkZWZhdWx0LXRva2VuLXR2bWJ0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJiZDI3YzljZS0wZWY2LTQ0YTAtYThmNC0xYTg2ZWMxN2JmNTQiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06ZGVmYXVsdCJ9.UjlNOPi95jsxtbGXVu6t3LK-1kOjlcLk7_qVPhDEmYD9so5BLnosS6Z_nBfpO2aU5xxMZMMvkTIydMKVTgftzeFpUZ7_ANsqjZ17Z2EnzUxhzkBU9USU3294APU4Gxep1yb4uyetRtIozdsd39-TlMwoCkHb4aGbluZiT64AkbDS6v7PhONaaCIKTT6hxvo4PEiyau_fEKCfI6rsWdcoOWlKLeXOwqGW1tHgIZEPR7Eln8NA52fAOvHyPp5DSKgD3L2qGDAlQNXCFCrB2bc7-xBEEBjeDXOhTIl1sUX6gmhEzp0XFH20JZaSJysvW1ZQGsv_AXj-4PX8Egv1kq1txA</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://github.com/kubernetes/dashboard#getting-started">Kubernetes Dashboard</a></li><li><a href="https://gist.github.com/qwfys/aec4d2ab79281aeafebdb40b22d0b748">å¸¸ç”¨é•œåƒä»“åº“</a></li></ul><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>recommended.yamlçš„å‰¯æœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"># Copyright 2017 The Kubernetes Authors.</span><br><span class="line">#</span><br><span class="line"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line"># you may not use this file except in compliance with the License.</span><br><span class="line"># You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#     http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Namespace</span><br><span class="line">metadata:</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 443</span><br><span class="line">      targetPort: 8443</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-certs</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-csrf</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line">data:</span><br><span class="line">  csrf: &quot;&quot;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-key-holder</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: ConfigMap</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-settings</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Role</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">rules:</span><br><span class="line">  # Allow Dashboard to get, update and delete Dashboard exclusive secrets.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;secrets&quot;]</span><br><span class="line">    resourceNames: [&quot;kubernetes-dashboard-key-holder&quot;, &quot;kubernetes-dashboard-certs&quot;, &quot;kubernetes-dashboard-csrf&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;update&quot;, &quot;delete&quot;]</span><br><span class="line">    # Allow Dashboard to get and update &#x27;kubernetes-dashboard-settings&#x27; config map.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;configmaps&quot;]</span><br><span class="line">    resourceNames: [&quot;kubernetes-dashboard-settings&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;update&quot;]</span><br><span class="line">    # Allow Dashboard to get metrics.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;services&quot;]</span><br><span class="line">    resourceNames: [&quot;heapster&quot;, &quot;dashboard-metrics-scraper&quot;]</span><br><span class="line">    verbs: [&quot;proxy&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;services/proxy&quot;]</span><br><span class="line">    resourceNames: [&quot;heapster&quot;, &quot;http:heapster:&quot;, &quot;https:heapster:&quot;, &quot;dashboard-metrics-scraper&quot;, &quot;http:dashboard-metrics-scraper&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;]</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: ClusterRole</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">rules:</span><br><span class="line">  # Allow Metrics Scraper to get metrics from the Metrics server</span><br><span class="line">  - apiGroups: [&quot;metrics.k8s.io&quot;]</span><br><span class="line">    resources: [&quot;pods&quot;, &quot;nodes&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: RoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: Role</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: kubernetes-dashboard</span><br><span class="line">    namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: kubernetes-dashboard</span><br><span class="line">    namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: kubernetes-dashboard</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: kubernetes-dashboard</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: kubernetes-dashboard</span><br><span class="line">          image: kubernetesui/dashboard:v2.0.3</span><br><span class="line">          imagePullPolicy: Always</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8443</span><br><span class="line">              protocol: TCP</span><br><span class="line">          args:</span><br><span class="line">            - --auto-generate-certificates</span><br><span class="line">            - --namespace=kubernetes-dashboard</span><br><span class="line">            # Uncomment the following line to manually specify Kubernetes API server Host</span><br><span class="line">            # If not specified, Dashboard will attempt to auto discover the API server and connect</span><br><span class="line">            # to it. Uncomment only if the default does not work.</span><br><span class="line">            # - --apiserver-host=http://my-address:port</span><br><span class="line">          volumeMounts:</span><br><span class="line">            - name: kubernetes-dashboard-certs</span><br><span class="line">              mountPath: /certs</span><br><span class="line">              # Create on-disk volume to store exec logs</span><br><span class="line">            - mountPath: /tmp</span><br><span class="line">              name: tmp-volume</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTPS</span><br><span class="line">              path: /</span><br><span class="line">              port: 8443</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">      volumes:</span><br><span class="line">        - name: kubernetes-dashboard-certs</span><br><span class="line">          secret:</span><br><span class="line">            secretName: kubernetes-dashboard-certs</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      nodeSelector:</span><br><span class="line">        &quot;kubernetes.io/os&quot;: linux</span><br><span class="line">      # Comment the following tolerations if Dashboard must not be deployed on master</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io/master</span><br><span class="line">          effect: NoSchedule</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 8000</span><br><span class="line">      targetPort: 8000</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: dashboard-metrics-scraper</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: dashboard-metrics-scraper</span><br><span class="line">      annotations:</span><br><span class="line">        seccomp.security.alpha.kubernetes.io/pod: &#x27;runtime/default&#x27;</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: dashboard-metrics-scraper</span><br><span class="line">          image: kubernetesui/metrics-scraper:v1.0.4</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8000</span><br><span class="line">              protocol: TCP</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTP</span><br><span class="line">              path: /</span><br><span class="line">              port: 8000</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          volumeMounts:</span><br><span class="line">          - mountPath: /tmp</span><br><span class="line">            name: tmp-volume</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      nodeSelector:</span><br><span class="line">        &quot;kubernetes.io/os&quot;: linux</span><br><span class="line">      # Comment the following tolerations if Dashboard must not be deployed on master</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io/master</span><br><span class="line">          effect: NoSchedule</span><br><span class="line">      volumes:</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> docker </tag>
            
            <tag> Docker Desktop </tag>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Studioå®‰è£…ç¬”è®°</title>
      <link href="/2021/01/01/software/install/how-to-install-android-studio/"/>
      <url>/2021/01/01/software/install/how-to-install-android-studio/</url>
      
        <content type="html"><![CDATA[<h1 id="Android-Studioå®‰è£…ç¬”è®°"><a href="#Android-Studioå®‰è£…ç¬”è®°" class="headerlink" title="Android Studioå®‰è£…ç¬”è®°"></a>Android Studioå®‰è£…ç¬”è®°</h1><p>ç®€å•è®°å½•ä¸€ä¸‹Android Studioå®‰è£…</p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>ä»<a href="https://developer.android.google.cn/studio">å®˜ç½‘</a>å®‰è£…Android Studio,</p><p>ç„¶åç‚¹å‡»å®‰è£…ã€‚</p><h3 id="Android-SDK"><a href="#Android-SDK" class="headerlink" title="Android SDK"></a>Android SDK</h3><p>ä½¿ç”¨<a href="http://ping.chinaz.com/">http://ping.chinaz.com</a>è·å–<em>dl.google.com</em>çš„å¤§é™†å“åº”æ—¶é—´æœ€çŸ­çš„IPåœ°å€ã€‚</p><p>ä»¥æˆ‘ä¸ºä¾‹ï¼š180.163.151.161</p><p>å°†å…¶å†™å…¥hostsæ–‡ä»¶(C:\WINDOWS\System32\drivers\etc\hosts)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">180.163.151.161 dl.google.com</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.cnblogs.com/senior-engineer/p/11130757.html">åœ¨Android Studioä¸­ä¸‹è½½Android SDKçš„ä¸¤ç§æ–¹å¼ï¼ˆAndroid Studio3.0ã€windows</a></p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android Studio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨Ubuntu 18.04.5 LTSä¸Šå®‰è£…minkube</title>
      <link href="/2021/01/01/software/k8s/how-to-install-minkube/"/>
      <url>/2021/01/01/software/k8s/how-to-install-minkube/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨Ubuntu-18-04-5-LTSä¸Šå®‰è£…minkube"><a href="#åœ¨Ubuntu-18-04-5-LTSä¸Šå®‰è£…minkube" class="headerlink" title="åœ¨Ubuntu 18.04.5 LTSä¸Šå®‰è£…minkube"></a>åœ¨Ubuntu 18.04.5 LTSä¸Šå®‰è£…minkube</h2><h3 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h3><ol><li>2 CPUs or more</li><li>2GBå†…å­˜</li><li>20Gç©ºé—´</li><li>æ— çº¿ç½‘ç»œè¿æ¥</li><li>å®¹å™¨æˆ–è€…è™šæ‹Ÿæœºï¼Œ æ¯”å¦‚: Docker, Hyperkit, Hyper-V, KVM, Parallels, Podman, VirtualBox, or VMWare</li></ol><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo minikube start --registry-mirror=https://registry.docker-cn.com --vm-driver=none --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers</span><br></pre></td></tr></table></figure><h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><h4 id="none-driver-integration-tests-k8s-1-18-needs-conntrack-installed"><a href="#none-driver-integration-tests-k8s-1-18-needs-conntrack-installed" class="headerlink" title="none driver integration tests: k8s 1.18 needs conntrack installed"></a>none driver integration tests: k8s 1.18 needs conntrack installed</h4><p>è§£å†³æ–¹æ¡ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install conntrack</span><br><span class="line">## https://github.com/kubernetes/minikube/issues/7179</span><br></pre></td></tr></table></figure><h2 id="åœ¨Windowsä¸Šå®‰è£…k8s"><a href="#åœ¨Windowsä¸Šå®‰è£…k8s" class="headerlink" title="åœ¨Windowsä¸Šå®‰è£…k8s"></a>åœ¨Windowsä¸Šå®‰è£…k8s</h2><h3 id="å®‰è£…Docker"><a href="#å®‰è£…Docker" class="headerlink" title="å®‰è£…Docker"></a>å®‰è£…Docker</h3><p>å®‰è£…<a href="https://desktop.docker.com/win/stable/Docker%20Desktop%20Installer.exe">Docker Desktop</a></p><h3 id="é…ç½®dockerçš„å›½å†…é•œåƒ"><a href="#é…ç½®dockerçš„å›½å†…é•œåƒ" class="headerlink" title="é…ç½®dockerçš„å›½å†…é•œåƒ"></a>é…ç½®dockerçš„å›½å†…é•œåƒ</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;https://dockerhub.azk8s.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://registry.docker-cn.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://hub-mirror.c.163.com&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;insecure-registries&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;debug&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;experimental&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒ"><a href="#ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒ" class="headerlink" title="ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒ"></a>ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒ</h3><p>ä¸ºäº†æ›´å¿«çš„å®Œæˆä¸€äº›å®‰è£…ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªé˜¿é‡Œäº‘çš„æ‰¹å¤„ç†ï¼Œæå‰æŠŠKuberneteséœ€è¦çš„Imagesæ‹‰å–ä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/AliyunContainerService/k8s-for-docker-desktop.git</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> k8s-for-docker-desktop</span><br><span class="line"></span><br><span class="line">.\load_images.ps1</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨Kubernetes"><a href="#å¯åŠ¨Kubernetes" class="headerlink" title="å¯åŠ¨Kubernetes"></a>å¯åŠ¨Kubernetes</h3><p>åœ¨Dockerä»ªè¡¨ç›˜ä¸Šåœ¨Settingsåˆ‡åˆ°Kubernetesä¸Šå¯åŠ¨Enabled Kubernetes</p><h3 id="å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰"><a href="#å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰" class="headerlink" title="å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰"></a>å®‰è£…Dashboardï¼ˆå¯é€‰ï¼‰</h3><p>ä½¿ç”¨<a href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml">recommended.yaml</a>è¿›è¡Œå®‰è£…</p><blockquote><p>å¦‚æœä¸èƒ½è®¿é—®<em>recommended.yaml</em>ï¼Œ å¯ä»¥ä½¿ç”¨<a href="#%E9%99%84%E5%BD%95">é™„å½•</a>çš„å‰¯æœ¬</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f recommended.yaml </span><br><span class="line">namespace/kubernetes-dashboard created</span><br><span class="line">serviceaccount/kubernetes-dashboard created</span><br><span class="line">service/kubernetes-dashboard created</span><br><span class="line">secret/kubernetes-dashboard-certs created</span><br><span class="line">secret/kubernetes-dashboard-csrf created</span><br><span class="line">secret/kubernetes-dashboard-key-holder created</span><br><span class="line">configmap/kubernetes-dashboard-settings created</span><br><span class="line">role.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created</span><br><span class="line">deployment.apps/kubernetes-dashboard created</span><br><span class="line">service/dashboard-metrics-scraper created</span><br><span class="line">deployment.apps/dashboard-metrics-scraper created</span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨-1"><a href="#å¯åŠ¨-1" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h4><p>å‰å°å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl proxy</span><br></pre></td></tr></table></figure><p>åå°å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup kubectl proxy &gt;/dev/null &amp;</span><br></pre></td></tr></table></figure><h4 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h4><p>ç™»å½•éœ€è¦è·å–token</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kube-system describe secret default| awk &#x27;$1==&quot;token:&quot;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘çš„è¿”å›ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Imk0TWpNeGM3SWVrMHllMVphM0FPVFZIZ2RIaXZIbll2UzZObkJSZTZ5MUEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkZWZhdWx0LXRva2VuLXR2bWJ0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJiZDI3YzljZS0wZWY2LTQ0YTAtYThmNC0xYTg2ZWMxN2JmNTQiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06ZGVmYXVsdCJ9.UjlNOPi95jsxtbGXVu6t3LK-1kOjlcLk7_qVPhDEmYD9so5BLnosS6Z_nBfpO2aU5xxMZMMvkTIydMKVTgftzeFpUZ7_ANsqjZ17Z2EnzUxhzkBU9USU3294APU4Gxep1yb4uyetRtIozdsd39-TlMwoCkHb4aGbluZiT64AkbDS6v7PhONaaCIKTT6hxvo4PEiyau_fEKCfI6rsWdcoOWlKLeXOwqGW1tHgIZEPR7Eln8NA52fAOvHyPp5DSKgD3L2qGDAlQNXCFCrB2bc7-xBEEBjeDXOhTIl1sUX6gmhEzp0XFH20JZaSJysvW1ZQGsv_AXj-4PX8Egv1kq1txA</span><br></pre></td></tr></table></figure><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><p>recommended.yamlçš„å‰¯æœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"># Copyright 2017 The Kubernetes Authors.</span><br><span class="line">#</span><br><span class="line"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line"># you may not use this file except in compliance with the License.</span><br><span class="line"># You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#     http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Namespace</span><br><span class="line">metadata:</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 443</span><br><span class="line">      targetPort: 8443</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-certs</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-csrf</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line">data:</span><br><span class="line">  csrf: &quot;&quot;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-key-holder</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">type: Opaque</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: ConfigMap</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard-settings</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Role</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">rules:</span><br><span class="line">  # Allow Dashboard to get, update and delete Dashboard exclusive secrets.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;secrets&quot;]</span><br><span class="line">    resourceNames: [&quot;kubernetes-dashboard-key-holder&quot;, &quot;kubernetes-dashboard-certs&quot;, &quot;kubernetes-dashboard-csrf&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;update&quot;, &quot;delete&quot;]</span><br><span class="line">    # Allow Dashboard to get and update &#x27;kubernetes-dashboard-settings&#x27; config map.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;configmaps&quot;]</span><br><span class="line">    resourceNames: [&quot;kubernetes-dashboard-settings&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;update&quot;]</span><br><span class="line">    # Allow Dashboard to get metrics.</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;services&quot;]</span><br><span class="line">    resourceNames: [&quot;heapster&quot;, &quot;dashboard-metrics-scraper&quot;]</span><br><span class="line">    verbs: [&quot;proxy&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;services/proxy&quot;]</span><br><span class="line">    resourceNames: [&quot;heapster&quot;, &quot;http:heapster:&quot;, &quot;https:heapster:&quot;, &quot;dashboard-metrics-scraper&quot;, &quot;http:dashboard-metrics-scraper&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;]</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: ClusterRole</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">rules:</span><br><span class="line">  # Allow Metrics Scraper to get metrics from the Metrics server</span><br><span class="line">  - apiGroups: [&quot;metrics.k8s.io&quot;]</span><br><span class="line">    resources: [&quot;pods&quot;, &quot;nodes&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: RoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: Role</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: kubernetes-dashboard</span><br><span class="line">    namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: kubernetes-dashboard</span><br><span class="line">    namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: kubernetes-dashboard</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: kubernetes-dashboard</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: kubernetes-dashboard</span><br><span class="line">          image: kubernetesui/dashboard:v2.0.3</span><br><span class="line">          imagePullPolicy: Always</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8443</span><br><span class="line">              protocol: TCP</span><br><span class="line">          args:</span><br><span class="line">            - --auto-generate-certificates</span><br><span class="line">            - --namespace=kubernetes-dashboard</span><br><span class="line">            # Uncomment the following line to manually specify Kubernetes API server Host</span><br><span class="line">            # If not specified, Dashboard will attempt to auto discover the API server and connect</span><br><span class="line">            # to it. Uncomment only if the default does not work.</span><br><span class="line">            # - --apiserver-host=http://my-address:port</span><br><span class="line">          volumeMounts:</span><br><span class="line">            - name: kubernetes-dashboard-certs</span><br><span class="line">              mountPath: /certs</span><br><span class="line">              # Create on-disk volume to store exec logs</span><br><span class="line">            - mountPath: /tmp</span><br><span class="line">              name: tmp-volume</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTPS</span><br><span class="line">              path: /</span><br><span class="line">              port: 8443</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">      volumes:</span><br><span class="line">        - name: kubernetes-dashboard-certs</span><br><span class="line">          secret:</span><br><span class="line">            secretName: kubernetes-dashboard-certs</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      nodeSelector:</span><br><span class="line">        &quot;kubernetes.io/os&quot;: linux</span><br><span class="line">      # Comment the following tolerations if Dashboard must not be deployed on master</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io/master</span><br><span class="line">          effect: NoSchedule</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 8000</span><br><span class="line">      targetPort: 8000</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: dashboard-metrics-scraper</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: dashboard-metrics-scraper</span><br><span class="line">      annotations:</span><br><span class="line">        seccomp.security.alpha.kubernetes.io/pod: &#x27;runtime/default&#x27;</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: dashboard-metrics-scraper</span><br><span class="line">          image: kubernetesui/metrics-scraper:v1.0.4</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8000</span><br><span class="line">              protocol: TCP</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTP</span><br><span class="line">              path: /</span><br><span class="line">              port: 8000</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          volumeMounts:</span><br><span class="line">          - mountPath: /tmp</span><br><span class="line">            name: tmp-volume</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      nodeSelector:</span><br><span class="line">        &quot;kubernetes.io/os&quot;: linux</span><br><span class="line">      # Comment the following tolerations if Dashboard must not be deployed on master</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io/master</span><br><span class="line">          effect: NoSchedule</span><br><span class="line">      volumes:</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> minikube </tag>
            
            <tag> kubernetes </tag>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
